; -------------------------------------------------------------------------------
;    更新日期    2016-09-29      Black Princess Tohka
; -------------------------------------------------------------------------------

[Data]
  ;体力ゲ`ジの初期
life = 1000
power = 5000
  ;攻牧Γà长煲陨悉嗽O定するとくなる）
attack = 100
  ;防御力（これ以上にO定するとくなる）
defence = 100
  ;コンボをくらっているrにあがる防御力
fall.defence_up = 50
  ;倒れてから起上がるまでのフレ`ム数
liedown.time = 12; 11
  ;空中でどれだけコンボががるか（高くするとo限コンボになるので注意）
airjuggle = 255
  ;hitdefでO定していないrの基本ヒットスパ`クナンバ`
sparkno = 2;2
  ;O定してないrのガ`ドナンバ`
guard.sparkno = 40
  ;KOしたrに声にエコ`をかけるか（１でＯＮ）
KO.echo = 0
 volume = 5
  IntPersistIndex = 58
FloatPersistIndex = 40

[Size]
xscale = 0.5           ;水平方向のs尺（通常１）
yscale = 0.5          ;垂直方向のs尺（通常１）
ground.back = 20  ;キャラの幅(後方,地上)
ground.front = 20   ;キャラの幅(前方,地上)
air.back = 19       ;キャラの幅(後方,空中)
air.front = 19      ;キャラの幅(前方,空中)
height = 103          ;キャラの高さ
attack.dist = 160    ;攻膜颏筏r相手がガ`ド体制に入る最低距x
proj.attack.dist = 80;攻膜颏筏r相手がガ`ド体制に入る最低距x（wび道具）
proj.doscale = 0;0     ;上でO定したs尺をwび道具にもm用するか（１でＯＮ）
head.pos = 3, -98  ;^の大体の座
mid.pos = 1, -68    ;体の中心の大体の座
shadowoffset = 0     ;影の垂直方向のオフセット
draw.offset = 0,0    ;使用しない

[Velocity]
walk.fwd  = 1.1      ;前Mの速度
walk.back = -0.9     ;後退の速度
run.fwd  = 7.5,0                         ;6.9, 0
run.back = -7.5,-3.6                       ;-6.5,-2.2
jump.neu = 0,-9.6    ;垂直ジャンプの速度
jump.back = -3,1   ;後ジャンプの速度
jump.fwd = 3,1       ;前ジャンプの速度

runjump.back = -2.55,-10.1  ;後ダッシュしながらのジャンプ速度(オプション)
runjump.fwd = 4,-10.1      ;前ダッシュしながらのジャンプ速度(オプション)

airjump.neu = 0,-9.1      ;２段ジャンプ以降の垂直ジャンプの速度(オプション)
airjump.back = -3.1      ;２段ジャンプ以降の後ジャンプの速度(オプション)
airjump.fwd = 3.1         ;２段ジャンプ以降の前ジャンプの速度

[Movement]
airjump.num = 0      ;空中でジャンプする回数
airjump.height = 35  ;空中でジャンプする最低限の高さ
yaccel = .60  ;60         ;重力
stand.friction = .85  ;立ち状Bの摩擦S数
crouch.friction = .82 ;屈み状Bの摩擦S数

;---------------------------------------------------------------------------
; 拖时间 输掉时 的失败动作
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 00]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; 伽盲幼
[Statedef 180]
type = S

[State 00]
type = VarRandom
trigger1 = Time = 0
v = 2
range = 0,1                 ;胜利动作范围

[State 01]
type = ChangeState
trigger1 = var(2) = 0
value = 181 ;181

[State 01]
type = ChangeState
trigger1 = var(2) = 1
value = 182 ;182


;---------------------------------------------------------------------------
; 伽盲幼
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0
sprpriority = 0-9*(roundstate>2)

[State 600, 1];            象声词    卖萌1
type = PlaySnd
trigger1 = animelem = 6
value = 9181,11

[State 600, 1];            象声词    卖萌1
type = PlaySnd
trigger1 = animelem = 8
value = 9181,12


[State 600, 1];            象声词    卖萌1
type = PlaySnd
trigger1 = animelem = 10
value = 9181,13

[State 600, 1];            象声词    卖萌1
type = PlaySnd
trigger1 = animelem = 12
value = 9181,14


[State 600, 1];            闪耀
type = PlaySnd
trigger1 =   animelem = 6  ; ||animelem = 10  ||animelem = 12
value = 9181,1

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 6
anim = 8233       ;
pos = -1,-55
scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem =6
anim = 8233       ;
pos = -1,-55
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 6
anim = 8230        ;
pos = -1,10
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8230            ;
bindtime = 8;-1
sprpriority = -4
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 6
anim = 8231         ;
pos = -1,10
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8231            ;
bindtime = 8;-1
sprpriority = -3
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 8
anim = 8233       ;
pos = -12,-70
scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 8
anim = 8233       ;
pos = -12,-70
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 8
anim = 8230        ;
pos = -12,-5
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8230            ;
bindtime = 8;-1
sprpriority = -4
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 8
anim = 8231         ;
pos = -12,-5
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8231            ;
bindtime = 8;-1
sprpriority = -3
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0



;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 10
anim = 8233       ;
pos = -5,-40
scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 10
anim = 8233       ;
pos = -5,-40
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 10
anim = 8230        ;
pos = -5,25
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8230            ;
bindtime = 8;-1
sprpriority = -4
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 10
anim = 8231         ;
pos = -5,25
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8231            ;
bindtime = 8;-1
sprpriority = -3
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0




;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 12
anim = 8233       ;
pos = 0,-70
scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 12
anim = 8233       ;
pos = 0,-70
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 12
anim = 8230        ;
pos = 0,-5
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8230            ;
bindtime = 8;-1
sprpriority = -4
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 12
anim = 8231         ;
pos = 0,-5
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8231            ;
bindtime = 8;-1
sprpriority = -3
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0



[State 181, 4]
type = AssertSpecial
trigger1 = time = [0,360]
flag = roundnotover

;---------------------------------------------------------------------------
; 伽盲幼
[Statedef 182]
type = S
ctrl = 0
anim = 182
velset = 0,0
sprpriority = 0-9*(roundstate>2)


[State 600, 1];            闪耀
type = PlaySnd
trigger1 = animelem = 5;  ||   animelem = 8   ||animelem = 10  ||animelem = 12
value = 9181,1



;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 4
anim = 8233       ;
pos = 0,-70
scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 6
anim = 8233       ;
pos = 0,-70
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 4
anim = 8230        ;
pos = 0,-5
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8230            ;
bindtime = 8;-1
sprpriority = -2
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 4
anim = 8231         ;
pos = 0,-5
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8231            ;
bindtime = 8;-1
sprpriority = 3
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0


[State 600, 1];            夜刀神十香
type = PlaySnd
trigger1 = animelem = 6
value = 9000,3


[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 181, 4]
type = AssertSpecial
trigger1 = time = [0,120]
flag = roundnotover


;---------------------------------------------------------------------------
; 通常登                   1
[Statedef 190]
type = S
ctrl = 0
anim = 190
velset = 0,0


[State 00]
type = VarRandom
trigger1 = Time = 1
v = 2
range = 0,1

[State 01]
type = ChangeState
trigger1 = var(2) = 1
value = 191       ;1


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 51
anim = 8233       ;
pos = 0,-60
;scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


[State 191, 3];
type = PlaySnd
trigger1 = animelem = 13
value = 9195,0;+(random%2)


[State 200, 5]
type = PlaySnd
trigger1 = animelem = 51
value = 8000,5


[State a] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[State a] 
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; 通常登              2
[Statedef 191]
type = S
ctrl = 0
anim = 191
velset = 0,0






[State 200, 5]
type = PlaySnd
trigger1 = animelem = 21
value = 8000,5


[State 200, 5]
type = PlaySnd
trigger1 = animelem = 23      ;电流
value = 8000,12

;-----------------------ADD        闪电
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 23
anim = 8191       ;
pos = 20,0
scale = 0.6,0.6
postype = P1
ownpal = 1
id = 8191          ;
bindtime = 8
sprpriority = 5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 23
anim = 8233       ;
pos = 0,-60
;scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


[State a] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[State a] 
type = ChangeState
trigger1 = AnimTime = 0
value = 0



;---------------------------------------------------------------------------
; 挑kの幼
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 1



[State 191, 3];
type = PlaySnd
trigger1 = animelem = 8
value = 9195,0;+(random%2)
channel = 0
;voulme = 511
lowpriority = 1


[State 195, 2]
type = ChangeState
triggerall = Time >= 60
trigger1 = Time >= 600
trigger2 = command = "holdfwd"
trigger3 = command = "holdback"
trigger4 = command = "holdup"
trigger5 = command = "holddown"
value = 196
ctrl = 0

;---------------------------------------------------------------------------
; 挑kの幼     后续     step2
[Statedef 196]
type = S
ctrl = 0
anim = 196
velset = 0,0
movetype = I
physics = S
sprpriority = 1



[State a]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
IgnoreHitPause = 1

;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

;---------------------------------------------------------------------------
; 站立 轻 攻击
[Statedef 200]
type    = S                      
movetype= A                      
physics = S                      
juggle  = 1
;Commonly-used controllers:
;velset = 0,0                     ;
ctrl = 0                         ;
anim = 200           + 2*(var(59)>0)                   ;    ai控制时，防止对方把受击框 画小
poweradd = 0



;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 1400]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = fvar(19)> 0       ; 连段
triggerall = statetype != A
triggerall = prevstateno != 400
triggerall = (EnemyNear(var(55)),pos x - pos x)*facing  > 5
triggerall = power >= 2000
triggerall = random < 900   ; 给予变化  防止套路
triggerall = random < 111  || helper(32000),var(26)=0
triggerall = numhelper(2650)= 0   ;&&  numhelper(2350)= 0 && numhelper(2150)= 0  &&
triggerall =  Time = 0

trigger1 = random < (200+30*fvar(22)+50*(life < 0.85*lifemax)+50* (life < 0.55*lifemax)+50*(life<0.35*lifemax)+ 50*(power>3500))*(0.1+0.5*(EnemyNear,GetHitVar(hitcount)<10)+0.4*(EnemyNear,GetHitVar(hitcount)<20))

trigger2 = random < 222*(inguarddist    || (helper(32000), inguarddist)    || (helper(33000), inguarddist))

value = 2600    ;2300   +  300*(    ( (EnemyNear(var(55)),pos x - pos x)*facing  = [-35,50] )  && random % 2 =0   )
ignorehitpause = 1



                  ;

[State 810, ];某些射程很近的技能  AttackDist 修正
type = AttackDist
trigger1 = 1
value = 100

 [State 0, Turn]
type = Turn
trigger1 = var(59) > 0
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0



;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 1
x = 1
;--------------------速度
[state a]
type = velmul
trigger1 = vel x != [-0.5,0.5]
x = 0.9




[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 3
value = 200,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = 1
trigger1 = animelem = 4
attr = S, NA                     ;立ち状Bで、通常の攻(ｓは立ち、ｎは通常、aは攻膜虮恧)
damage = 20*(1+0.1*fvar(22))                   ;ダメ`ジ量（左が当たったr、右はガ`ドしたr）
getpower = 30+3*fvar(22),10
animtype = Light                 ;当てたrの相手のポ`ズ（light/midium/hard/back）からxk
guardflag = MA                   ;ガ`ドできる状B（ｍaは全ての状Bでガ`ド可能）
hitflag = MAF                    ;当てる事のできる条件
priority = 3, Hit                ;攻膜先兀0弱い　4通常　7い
pausetime = 10, 9 + ceil(0.5*fvar(22))                ;攻膜当たったrの硬直rg（左が自分、右が相手）
sparkno = s-1;s7020                      ;ヒットエフェクトのスプライトステ`ト（oければ0）
sparkxy = -5, -79               ;ヒットエフェクトを表示する鏊（相手の座摔牵
hitsound = s400, 0                 ;ヒットしたrの音（ｓ*,*にすると自分の音を使う）
guardsound = s120, 0                ;ガ`ドしたrの音（同上）
guard.sparkno = s7010
ground.type = high               ;相手のくらった鏊（High：^、体, Low：足, Trip：足Bい）
ground.slidetime = 13           -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  =  13            -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -3.2
airguard.velocity = -1.9,-2
air.type = high
air.velocity = -1.1,-2.4 -1*(enemynear,Pos Y > -25) -1*(enemynear,Pos Y > -50)  +0.7*(var(47)<-600) +0.7*(var(47)<-900) +0.7*(var(47)<-1200)
air.hittime = 12
ID = 200
air.fall = 1
fall.recovertime = 40
yaccel = 0.45

[State 200, 1];
type = PlaySnd
trigger1 = animelem = 3    ;风声
value = 300, 0



[State 0, Explod]
type = Explod
trigger1 =0
trigger1 = movehit
anim = 7000
ID = 7000
pos = -5 +(random%10), -79+(random%10)
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
;removetime = -2
supermovetime =  999
pausemovetime =  999
scale = 0.5,0.5
sprpriority = 3
ontop = 1
ownpal = 1
persistent = 0
ignorehitpause = 1



;---------------------[轻拳火花]
[state a];
type = Helper
trigger1 = movehit
id = 7000
;name = "hit"
pos = floor(p2dist x/2 +5) +(random % 10) , floor(p2dist y/2 -65) -(random % 20)
postype = p1
stateno = 7000
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0 ; 0      ;120
ctrl = 1





  ;---------------------------------------------------------------------------
; 站立 轻 攻击         FOR AI
[Statedef 201]
type    = S
movetype= A
physics = S
juggle  = 1
;Commonly-used controllers:
;velset = 0,0                     ;
ctrl = 0                         ;
anim = 200                       ;
poweradd = 0                    ;

[State 810, ];某些射程很近的技能  AttackDist 修正
type = AttackDist
trigger1 = 1
value = 80


 [State 0, Turn]
type = Turn
trigger1 = var(59) > 0
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0


;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 1
x = 1
;--------------------速度
[state a]
type = velmul
trigger1 = vel x != [-0.5,0.5]
x = 0.9




[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 3
value = 200,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = 1
trigger1 = animelem = 4
attr = S, NA                     ;立ち状Bで、通常の攻(ｓは立ち、ｎは通常、aは攻膜虮恧)
damage = 20*(1+0.1*fvar(22))                   ;ダメ`ジ量（左が当たったr、右はガ`ドしたr）
getpower = 30+3*fvar(22),10
animtype = Light                 ;当てたrの相手のポ`ズ（light/midium/hard/back）からxk
guardflag = MA                   ;ガ`ドできる状B（ｍaは全ての状Bでガ`ド可能）
hitflag = MAF                    ;当てる事のできる条件
priority = 3, Hit                ;攻膜先兀0弱い　4通常　7い
pausetime = 10, 9  +fvar(22)    ;  + ceil(0.5*fvar(22))            ;攻膜当たったrの硬直rg（左が自分、右が相手）
sparkno = s-1;s7020                      ;ヒットエフェクトのスプライトステ`ト（oければ0）
sparkxy = -5, -79               ;ヒットエフェクトを表示する鏊（相手の座摔牵
hitsound = s400, 0                 ;ヒットしたrの音（ｓ*,*にすると自分の音を使う）
guardsound = s120, 0                ;ガ`ドしたrの音（同上）
guard.sparkno = s7010
ground.type = high               ;相手のくらった鏊（High：^、体, Low：足, Trip：足Bい）
ground.slidetime = 13           -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  =  13            -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -3.2           +1.5    ;(与200不同)
airguard.velocity = -1.9,-2
air.type = high
air.velocity = -1.1,-2.4   -0.5*(enemynear,Pos Y > -25)   +0.6*(var(47)<-600) +0.6*(var(47)<-900) +0.6*(var(47)<-1200)
air.hittime = 12
ID = 200
air.fall = 1
fall.recovertime = 40
yaccel = 0.45

[State 200, 1];
type = PlaySnd
trigger1 = animelem = 3    ;风声
value = 300, 0



[State 0, Explod]
type = Explod
trigger1 =0
trigger1 = movehit
anim = 7000
ID = 7000
pos = -5 +(random%10), -79+(random%10)
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
;removetime = -2
supermovetime =  999
pausemovetime =  999
scale = 0.5,0.5
sprpriority = 3
ontop = 1
ownpal = 1
persistent = 0
ignorehitpause = 1



;---------------------[轻拳火花]
[state a];
type = Helper
trigger1 = movehit
id = 7000
;name = "hit"
pos = floor(p2dist x/2 +5) +(random % 10) , floor(p2dist y/2 -65) -(random % 20)
postype = p1
stateno = 7000
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0 ; 0      ;120
ctrl = 1



;---------------------------------------------------------------------------
;  蹲伏 骗招  （短
[Statedef 204]
type    = C
movetype= A
physics = C
juggle  = 1
poweradd= 0
ctrl = 0
anim = 204    - 1*(random % 2 = 0)
sprpriority = 1


[State 0, Turn]         ;自动转身
type = Turn
trigger1 = var(59) > 0
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0


[state a]
type = playerpush
trigger1 = fvar(22)>=5
value = 0

;------------------------------------------------- f 1700


[State -2]                      ;盾防    防御性能
type = HitOverride
triggerall = 1                           ; on/off
Triggerall = fvar(22)>=5
triggerall = var(59) > 0
triggerall =  !ishelper && alive && RoundState = 2
;triggerall = !Enemy,HitDefAttr = SCA,AT
;triggerall = helper(32000),var(39)=0  ||     helper(32000),var(38)=0   ;cooldown
;triggerall =  time > 2
Trigger1 = 1

attr = SCA,AA,AP;,AT
stateno = 1701
time = 1
IgnoreHitPause = 1
persistent = 1


[State 810, ];某些射程很近的技能  AttackDist 修正
type = AttackDist
trigger1 = 1
value = 160

;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = velset
trigger1 =  animelem = 1
x = 0.5


[State 400, 2]
type = HitDef
trigger1 = 1
trigger1 = animelem = 2
attr = S, NA
damage    = 20*(1+0.1*fvar(22))
priority = 3, Hit
animtype  = Light
hitflag = MAF
guardflag = LA
getpower = 30+3*fvar(22),10
pausetime = 10, 9
sparkno = s-1;s7020
sparkxy = -10,-53
hitsound   = s410,0
guard.sparkno = s7010
guardsound = s120,0
ground.type = low
ground.slidetime = 13     -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 13    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -5
air.velocity = -1.4,-3.8        +1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200)
airguard.velocity = -1.2,-2.8
fall.recover = 0
ID = 204
yaccel = 0.45



[State 230, Projectile]
type = Projectile
triggerall = 1                          ;骗检测        关系到记录号  【 on/ off 】
trigger1 = var(59) >0                  ;ai
trigger1 = fvar(22) >= 5               ;狂中
trigger1 = time = 5
attr = A, NP
damage = (15+5*(life<0.85*lifemax && fvar(22)>=3))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 50+5*fvar(22),30
pausetime = 2,10
sparkno = s-1
sparkxy = 20+random%20 ,-50-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19 -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -4
air.velocity = -2,-3.9          +0.5*(var(47)<-600) +0.5*(var(47)<-900) +0.5*(var(47)<-1200)
air.fall = 1
fall.recovertime = 80
ID = 6233
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -5
yaccel = .45
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 6233
projanim = 233
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 2  ;12
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = -22,999
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261


[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
trigger2 = time >=6
value = 0
ctrl = 1



;---------------------------------------------------------------------------
;  后退  骗招  （长
[Statedef 23]
type    = S
movetype= I
physics = N
juggle  = 1
poweradd= 0
ctrl = 0
anim = 0;205 ;21
sprpriority = 1

[State 0, Turn]         ;自动转身
type = Turn
trigger1 = var(59) > 0
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0



[State 0, PosSet]          ;防止 站在空中
type = PosSet
trigger1 = pos Y != 0
y = 0


[State 21, 2a]
type = VelSet
trigger1 =   time = 0; (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
x = ifelse((((EnemyNear(var(55)),pos x - pos x)*facing  )    > 200    &&   random % 3=0),const(velocity.walk.fwd.x),const(velocity.walk.back.x))
ignorehitpause = 1
persistent = 0




[State 21, 3]
type = ChangeAnim
triggerall = vel x > 0
trigger1 = Anim != 20
value = 20

[State 21, 4]
type = ChangeAnim
triggerall = vel x < 0
trigger1 = Anim != 21
value = 21

;-------------------------------------------------
[State -2]                      ;盾防    防御性能
type = HitOverride
triggerall = 1                           ; on/off
;Triggerall = fvar(22)>=5
triggerall = var(59) > 0
triggerall =  !ishelper && alive && RoundState = 2
;triggerall = !Enemy,HitDefAttr = SCA,AT
;triggerall = helper(32000),var(39)=0  ||     helper(32000),var(38)=0   ;cooldown
;triggerall =  time > 2
Trigger1 = 1
attr = SCA,AA,AP;,AT
stateno = 1701
time = 1
IgnoreHitPause = 1
persistent = 1



[State 400, 4]
type = ChangeState
triggerall = fvar(22) >= 3
trigger1 = time > 60

trigger2 = time > 12
trigger2 = enemynear,stateno !=[5100,5299]

trigger3 = time > 1
trigger3 = var(48) > 0 ; 判断为敌人投系

trigger4 = time > 9
trigger4 = enemynear,movetype = A

trigger5 = time > 9
trigger5 = enemy,numproj

value = 0  ; + 39*(var(48) > 0)
ctrl = 1



[State 400, 4]
type = ChangeState
triggerall = fvar(22) < 3

trigger1 = time >= 2

value = 120 ;0   + 39*(var(48) > 0)
ctrl = 1



;---------------------------------------------------------------------------
;立B            【横斩】
[Statedef 210]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= 20  +5*(fvar(22))
ctrl = 0
;velset = 0,0
anim = 210



;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 1400]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = fvar(19)> 0       ; 连段
triggerall = statetype != A
triggerall = prevstateno != 400
triggerall = prevstateno != 200
triggerall = numhelper(2350)= 0 && numhelper(2150)= 0  ;没有折纸时
triggerall = backedgedist > 25         ;自身板边使用时  容易失误
triggerall = (EnemyNear(var(55)),pos x - pos x)*facing  > 25
triggerall = power >= 2000
triggerall = random < 900   ; 给予变化  防止套路
triggerall = random < 111  || helper(32000),var(26)=0
triggerall = random < (200+30*fvar(22)+50*(life < 0.85*lifemax)+50* (life < 0.55*lifemax)+50*(life<0.35*lifemax)+ 50*(power>3500))*(0.1+0.5*(EnemyNear,GetHitVar(hitcount)<10)+0.4*(EnemyNear,GetHitVar(hitcount)<20))
triggerall = numhelper(2650)= 0   ;&&  numhelper(2350)= 0 && numhelper(2150)= 0  &&
trigger1 =  Time = 0

value = 2600  - 1    ;2300   +  300*(    ( (EnemyNear(var(55)),pos x - pos x)*facing  = [-35,50] )  && random % 2 =0   )
ignorehitpause = 1



[State 0, Turn]
type = Turn
trigger1 = 0
trigger1 =  Time = 0
;ignorehitpause =
;persistent =


;-----------------------ADD            刀光
[State 2001]
type = Explod
trigger1 = animelemtime(3) = 0;7
anim = 8210           ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8210                ;
bindtime = -1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0



[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 2
value = 210,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 3
edge = 30,20

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 4
edge = 40,20

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 7
edge = 20,20



;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 2
x = 1

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 4
x = 2

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 6
x = 6

;--------------------速度
[state a]
type = velmul
;trigger1 = 0
trigger1 = vel x != [-1.5,1.5]
x = 0.9


[State 200, 1];
type = PlaySnd
trigger1 = animelem = 3
value = 500, 0


[State 210, 2]
type = HitDef
;trigger1 = fvar(22) >= 5
trigger1 = animelem = 5
attr = S, NA
animtype  = medium
damage    =(30*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 4, Hit
getpower = 30+3*fvar(22),10
guardflag = MA
pausetime = 11,10   ;  11,12
sparkno = s-1
sparkxy = -10,-70
hitsound   = s510,0
guardsound = s121,0
guard.sparkno = s7010
ground.type = high
ground.slidetime = 19  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19   -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 5.5
air.velocity = -2.5,-4.1   -0.5*(enemynear,Pos Y > -25) -0.5*(enemynear,Pos Y > -50)  +1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200)
guard.velocity = - 6.5
airguard.velocity = -2.2,-2.4
;forcestand = 1
ID = 210
air.fall = 1
fall.recovertime = 90
Ground.CornerPush.VelOff   = -5
Air.CornerPush.VelOff      = -5
Down.CornerPush.VelOff     = -5
Guard.CornerPush.VelOff    = -5
yaccel = 0.45


[State 20] ;qbg
type = targetState
trigger1 = enemynear,statetype = A
trigger1 = movehit && NumTarget(210)
;value = 3221
value = 3221  +4*(var(47) <- 900) +1*(var(47) < - 1200)           ;重力保护修复
ctrl = 0
IgnoreHitPause = 1
Persistent     = 0



;---------------------[轻拳火花]
[state a];
type = Helper
trigger1 = movehit
id = 7001
;name = "hit"
pos = floor(p2dist x/2 +15) +(random % 10) , floor(p2dist y/2 -75) -(random % 20)
postype = p1
stateno = 7001
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;立 后B            【回身斩】
[Statedef 220]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= 30
ctrl = 0
;velset = 0,0
anim = 220   +2*(fvar(22)= 1)      ;缩小范围


[State 0, Turn]
type = Turn
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0


[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai  ------特例执行
triggerall = fvar(22) >=5
triggerall = fvar(19) = 0 ;立回
triggerall = time = 1 ;AnimElem = 1
Triggerall = EnemyNear(var(55)), vel x = 0   && EnemyNear(var(55)), movetype = I
Trigger1 = fvar(16) >0     ;物理攻击特例
anim     = -1
time     = 5       ;6
movetime = 5       ;6
darken   = 0
ignorehitpause =  1
persistent = 0


[State 810, ];        特例修正
type = AttackDist
trigger1 = animelem = 1
value = 150 - 149*(prevstateno= 1201)


;-----------------------ADD       刀光
[State 2001]
type = Explod
trigger1 = animelemtime(6) = 0;7
anim = 8220           ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8220                ;
bindtime = -1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 5
edge = 40,20


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 7
edge = 50,20

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 11
edge = 20,20

;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 2
x = 3


;--------------------速度
[state a]
type = velset
trigger1 = animelem = 5
x = 18

;--------------------速度
[state a]
type = velmul
trigger1 = vel x != [-0.75,0.75]
x = 0.95-0.15*((enemynear,pos x - pos x)*facing < 35 && backedgedist >35)-0.05* ((enemynear,pos x - pos x)*facing < 45)  -0.05* ((enemynear,pos x - pos x)*facing < 55)

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 8
x = 0


[State 200, 1];
type = PlaySnd
trigger1 = animelem = 3
value = 500, 1

[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 2
value = 210,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1






[State 210, 2]
type = HitDef
trigger1 = fvar(22) < 3
trigger1 = animelem = 9
attr = S, NA
animtype  = hard
damage    =(40*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 4, Hit
getpower = 30+3*fvar(22),10
hitflag = MAF
guardflag = MA
pausetime = 13,14    ;  13,12
sparkno = s-1
sparkxy = -10,-70
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 22  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 22  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 6       -2.5*((EnemyNear(var(55)),pos x - pos x)*facing  < -25 )
air.velocity = -1.2,-4.5     +0.5*(var(47)<-600) +1*(var(47)<-900) +1.5*(var(47)<-1200)   -1*(enemynear,pos Y > -50) -0.5*(enemynear,pos Y > -75)
guard.velocity = - 7.5
airguard.velocity = -4,-3.5
ID = 220
air.fall = 1
fall.recovertime = 80
yaccel = 0.45


[State 210, 2]
type = HitDef
trigger1 = fvar(22) >= 3
trigger1 = animelem = 9
attr = S, NA
animtype  = hard
damage    =(40*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 4, Hit
getpower = 60+5*fvar(22),30
hitflag = MAF
guardflag = H
pausetime = 13,14    ;  13,12
sparkno = s-1
sparkxy = -10,-70
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 22  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 22  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 6
air.velocity = -1.2,-4.5     +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)
guard.velocity = - 7.5
airguard.velocity = -4,-3.5
ID = 220
air.fall = 1
fall.recovertime = 80
yaccel = 0.45



;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 +15) +(random % 10) , floor(p2dist y/2 -65) -(random % 20)
postype = p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;立C            【散花】         飞行道具
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= 50
ctrl = 0
;velset = 0,0
anim = 230   ;



;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 1400]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = statetype != A
triggerall = EnemyNear(var(55)),statetype != A
triggerall =   (EnemyNear(var(55)),pos x - pos x)*facing  - 8*(EnemyNear(var(55)),vel x) > 0      ;12
;triggerall = ( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) - 5*(EnemyNear(var(55)),vel x)  < 50
;triggerall = random < (111 +333*(life > 0.85*lifemax)+ 55*(palno <4)  + 55*(palno <7)  + 444*(EnemyNear(var(55)),statetype = A ) )*((life > 0.85*lifemax)*0.2 +(life > 0.55*lifemax)*0.2  +(life > 0.35*lifemax)*0.4 +0.2  )
triggerall = power > 2000
triggerall = random < 55*fvar(22)+111* (life < 0.85*lifemax)+222* (life < 0.35*lifemax)
triggerall = fvar(19)= 0
triggerall = numhelper(2650)= 0 &&  numhelper(2350)= 0 && numhelper(2150)= 0
trigger1 =  Time = 0

value = 2300   +  300*( ((EnemyNear(var(55)),pos x - pos x)*facing  = [-5,65] ) || random % (2+1*(life > 0.85*lifemax))=0 )
ignorehitpause = 1





[State 1100, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 11    ;11之后为 movetype= I  ， 方便对方反击
statetype = S
movetype= I
physics = S



[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 4
edge = 40,20

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 6
edge = 20,20



[State 5210, 1] ;Blink white
type = PalFX
trigger1 = 0
trigger1 = animelem = 11
time = 5
add = 122,122,122 ;256,256,256



[State 200, 5]
type = PlaySnd
trigger1 = animelem = 5     ;电流
value = 8000,12
IgnoreHitPause = 1
persistent = 0


[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  animelemtime(2) = 0
value = 9000,0 +(Random%4)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0


;-----------------------ADD        闪电
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 5
anim = 8191       ;
pos = 10,0
scale = 0.6,0.6
postype = P1
ownpal = 1
id = 8191          ;
bindtime = 1
sprpriority = 5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0




;---------------------[火花]
[state a];
type = Helper
;Trigger1 = ProjHit8669 = 1
Trigger1 = 1
Trigger1 = animelemtime(4)> 0    &&    animelemtime(6)< 0
Trigger1 = enemynear,movetype = H
Trigger1 = p2dist x =[-70,70]
id = 7005
;name = "hit"
pos = -10+random%20,-55-random%20 - 0.5*(p2dist Y)
postype = p2
stateno = 7005
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 99999
supermovetime = 99999
persistent = 0
ignorehitpause = 1
keyctrl = 0


;---------------------[火花]
[state a];
type = Helper
;Trigger1 = ProjHit8669 = 1
Trigger1 = 1
Trigger1 = animelemtime(6)> 0    &&    animelemtime(8)< 0
Trigger1 = enemynear,movetype = H
Trigger1 = p2dist x =[-70,70]
id = 7005
;name = "hit"
pos = -10+random%20,-55-random%20 - 0.5*(p2dist Y)
postype = p2
stateno = 7005
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 99999
supermovetime = 99999
persistent = 0
ignorehitpause = 1
keyctrl = 0



;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 4
anim = 8233       ;
pos = 0,-60
scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 6
anim = 8233       ;
pos = 0,-60
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0




;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 4
anim = 8230        ;
pos = 0,5
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8230            ;
bindtime = 8;-1
sprpriority = -2
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        散花
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 4
anim = 8231         ;
pos = 0,5
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8231            ;
bindtime = 8;-1
sprpriority = 3
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 9999999
supermovetime = 9999999
IgnoreHitPause = 1
persistent = 0



;-----------------------ADD      风衣 碎片
[State 2001]
type = Explod
trigger1 = animelem = 4
anim = 234            ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 234               ;
bindtime = -1
sprpriority = 3
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
;IgnoreHitPause = 1
;persistent = 0





[State 200, 1];
type = PlaySnd
trigger1 = animelem = 2
value = 40, 1


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = 1;animelem = 1
edge = 25,20

;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 2
x =   ifelse( (8  + 0.04* ((enemynear,pos x - pos x)*facing) ) >12   , 12  , 8 + 0.04* ((enemynear,pos x - pos x)*facing)  )


;--------------------速度
[state a]
type = velset
trigger1 = animelem =6
x = 0


[State 230, Projectile]               ;
type = Projectile
trigger1 = animelem = 4
attr = A, NP
damage = (40+30*(life<0.85*lifemax && fvar(22)>=5))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 50+5*fvar(22),30
pausetime = 2,10
sparkno = s-1
sparkxy = 20+random%20 ,-50-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 -1*(var(47)<-600) -2*(var(47)<-900) -4*(var(47)<-1200)
ground.hittime  = 19 -1*(var(47)<-600) -2*(var(47)<-900) -4*(var(47)<-1200)
ground.velocity = -3.8
air.velocity = -2,-4.1          +0.5*(var(47)<-600) +0.5*(var(47)<-900) +0.5*(var(47)<-1200)
air.fall = 1
fall.recovertime = 80
ID = 233
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -5
yaccel = .4
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 233
projanim = 233
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 12;-1
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 10,20
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261


[State 230, Projectile]               ;
type = Projectile
trigger1 =  animelem = 6     ;7
attr = A, NP
damage = (40+30*(life<0.85*lifemax && fvar(22)>=5))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 50+5*fvar(22),30
pausetime = 2,10   -1*(var(47)<-600) -2*(var(47)<-900) -4*(var(47)<-1200)
sparkno = s-1
sparkxy = 30+random%20 ,-60-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 20 -2*(var(47)<-600) -4*(var(47)<-900) -8*(var(47)<-1200)
ground.hittime  = 20 -2*(var(47)<-600) -4*(var(47)<-900) -8*(var(47)<-1200)
ground.velocity = -3.8
air.velocity = -2,-3.5          +0.5*(var(47)<-600) +0.5*(var(47)<-900) +0.5*(var(47)<-1200)
air.fall = 1
fall.recovertime = 80
ID = 234
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -5
yaccel = .4
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 233
projanim = 233
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 12;-1
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 0,5
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261


[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
;普通浮空的带入       (琴里升龙)
[Statedef 3221]
type    = A
movetype= H
physics = N
;velset = -3,10.5
velset = -0.05,-0.05        ; no use
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1


[State 0, 消除帮助物体];  首先 如果是HELPER 打中了  则直接消除  以防分身   ------778899
type = DestroySelf
trigger1 = 0
trigger1 = (IsHelper)
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0     ;    0----无碰撞


;[State 0, PosSet]          ;防止 卡在空中
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5
;ignorehitpause = 1


[State 1];
type = NotHitBy
triggerall = 0
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.01*lifemax - 0.01*lifemax*(enemynear,palno>=4) - 0.005*lifemax*(enemynear,palno>=7)
absolute = 1
Ignorehitpause = 1
persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 = EnemyNear,facing = facing      ;带入的敌人，不要加变量
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1


;[State 210, Width];画面端の押しし判定
;type = Width
;trigger1 = 1;animelem = 1
;edge = 20,20



[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3221
Ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 11
value = 1
Ignorehitpause = 1

[state a]
type = velset
trigger1 = Time = 11  ;animelem = 3
x = -2.5   -0.5*(p2bodydist x =[-30,30]) -0.5*(p2bodydist x =[-60,60])
y = -5.2 + 0.7*(pos Y < -25)  + 0.7*(pos Y < -50)  ;+ 0.5*(pos Y < -75)
Ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = Time > 11    ;animelemtime(3) > 0
y = 0.4   +0.1*(time > 20)   +0.1*(time > 30)  +0.1*(time > 40)
Ignorehitpause = 1

[State 821, 3]
type = SelfState
triggerall = time > 11
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
;Ignorehitpause = 1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


;---------------------------------------
;普通浮空的带入   02       (折纸突进)
[Statedef 3222]
type    = A
movetype= H
physics = N
;velset = -3,10.5
velset = -0.05,-0.05        ; no use
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1


[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1     ;    1---- 碰撞

;[State 0, PosSet]          ;防止 卡在空中
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5
;ignorehitpause = 1

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = 1;animelem = 1
edge = 20,20

[State 1];
type = NotHitBy
triggerall = 0
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.01*lifemax - 0.01*lifemax*(enemynear,palno>=4) - 0.005*lifemax*(enemynear,palno>=7)
absolute = 1
Ignorehitpause = 1
persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 =  EnemyNear,facing = facing      ;带入的敌人，不要加变量
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3221
Ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 11
value = 1
Ignorehitpause = 1

[state a]
type = velset
trigger1 = Time = 11  ;animelem = 3
x = 6 * (0.4+0.2*(p2dist x !=[-100,100]) +0.2*(p2dist x !=[-150,150])   +0.2*(p2dist x !=[-200,200]) )      ;控制飞行距离
y = -6.5 + 0.5*(pos Y < -35)  + 0.5*(pos Y < -70)+ 0.5*(pos Y < -100)  ;+ 0.5*(pos Y < -75)
Ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = Time > 11    ;animelemtime(3) > 0
y = 0.4  +0.1*(time > 20)   +0.1*(time > 30)  +0.1*(time > 40)
Ignorehitpause = 1

[state a]
type = velmul
trigger1 = Time > 11  ;animelem = 3
trigger1 = gametime % 4=0
trigger1 = vel x !=[-3,3]
x = 0.95

[State 821, 3]
type = SelfState
triggerall = time > 11
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
;Ignorehitpause = 1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1




;---------------------------------------------------------------------------
;普通浮空的带入       (跳 砍)   随时间 保护启动  第1档
[Statedef 3223]
type    = A
movetype= H
physics = N
;velset = -3,10.5
velset = -0.05,-0.05        ; no use
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1     ;    0----无碰撞      1-----有碰撞


;[State 0, PosSet]          ;防止 卡在空中
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5
;ignorehitpause = 1


[State 1];
type = NotHitBy
triggerall = 0
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.01*lifemax    ;- 0.01*lifemax*(enemynear,palno>=4) - 0.01*lifemax*(enemynear,palno>=7)
kill = 0
absolute = 1
Ignorehitpause = 1
persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 =  EnemyNear,facing = facing      ;带入的敌人，不要加变量
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = 1;animelem = 1
edge = 11,11         ;变瘦 不要卡到身后



[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3221
Ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 11
value = 1
Ignorehitpause = 1

[state a]
type = velset
trigger1 = Time = 11              ;animelem = 3
x = -1.5                 ; -0.5*(p2bodydist x =[-30,30]) -0.5*(p2bodydist x =[-60,60])
y = -5.5     +0        ;+ 0.5*(pos Y < -25)  + 0.5*(pos Y < -50)  ;+ 0.5*(pos Y < -75)
Ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = Time > 11    ;animelemtime(3) > 0
y = 0.4   +0.1*(time > 10) + 0.1*(time > 20)   +0.1*(time > 30)  +0.1*(time > 40)
Ignorehitpause = 1

[State 821, 3]
type = SelfState
triggerall = time > 11
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
;Ignorehitpause = 1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


;---------------------------------------------------------------------------
;普通浮空的带入       (跳 砍)   随时间 保护启动  第2档
[Statedef 3224]
type    = A
movetype= H
physics = N
;velset = -3,10.5
velset = -0.05,-0.05        ; no use
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1     ;    0----无碰撞      1-----有碰撞


;[State 0, PosSet]          ;防止 卡在空中
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5
;ignorehitpause = 1


[State 1];
type = NotHitBy
triggerall = 0
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.01*lifemax    ;- 0.01*lifemax*(enemynear,palno>=4) - 0.01*lifemax*(enemynear,palno>=7)
kill = 0
absolute = 1
Ignorehitpause = 1
persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 =  EnemyNear,facing = facing      ;带入的敌人，不要加变量
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = 1;animelem = 1
edge = 11,11         ;变瘦 不要卡到身后



[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3221
Ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 11
value = 1
Ignorehitpause = 1

[state a]
type = velset
trigger1 = Time = 11              ;animelem = 3
x = -1.5                 ; -0.5*(p2bodydist x =[-30,30]) -0.5*(p2bodydist x =[-60,60])
y = -5.5    +1.5         ;+ 0.5*(pos Y < -25)  + 0.5*(pos Y < -50)  ;+ 0.5*(pos Y < -75)
Ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = Time > 11    ;animelemtime(3) > 0
y = 0.4   +0.1*(time > 10) + 0.1*(time > 20)   +0.1*(time > 30)  +0.1*(time > 40)
Ignorehitpause = 1

[State 821, 3]
type = SelfState
triggerall = time > 11
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
;Ignorehitpause = 1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


;---------------------------------------------------------------------------
;普通浮空的带入       (跳 砍)   随时间 保护启动  第3档
[Statedef 3225]
type    = A
movetype= H
physics = N
;velset = -3,10.5
velset = -0.05,-0.05        ; no use
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1     ;    0----无碰撞      1-----有碰撞


;[State 0, PosSet]          ;防止 卡在空中
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5
;ignorehitpause = 1


[State 1];
type = NotHitBy
triggerall = 0
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.01*lifemax    ;- 0.01*lifemax*(enemynear,palno>=4) - 0.01*lifemax*(enemynear,palno>=7)
kill = 0
absolute = 1
Ignorehitpause = 1
persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 =  EnemyNear,facing = facing      ;带入的敌人，不要加变量
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = 1;animelem = 1
edge = 11,11         ;变瘦 不要卡到身后



[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3221
Ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 11
value = 1
Ignorehitpause = 1

[state a]
type = velset
trigger1 = Time = 11              ;animelem = 3
x = -1.5                 ; -0.5*(p2bodydist x =[-30,30]) -0.5*(p2bodydist x =[-60,60])
y = -5.5     + 3        ;+ 0.5*(pos Y < -25)  + 0.5*(pos Y < -50)  ;+ 0.5*(pos Y < -75)
Ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = Time > 11    ;animelemtime(3) > 0
y = 0.4   +0.1*(time > 10) + 0.1*(time > 20)   +0.1*(time > 30)  +0.1*(time > 40)
Ignorehitpause = 1

[State 821, 3]
type = SelfState
triggerall = time > 11
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
;Ignorehitpause = 1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


;---------------------------------------------------------------------------
;普通浮空的带入       (跳 砍)   随时间 保护启动  第4档
[Statedef 3226]
type    = A
movetype= H
physics = N
;velset = -3,10.5
velset = -0.05,-0.05        ; no use
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1     ;    0----无碰撞      1-----有碰撞


;[State 0, PosSet]          ;防止 卡在空中
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5
;ignorehitpause = 1


[State 1];
type = NotHitBy
triggerall = 0
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.01*lifemax    ;- 0.01*lifemax*(enemynear,palno>=4) - 0.01*lifemax*(enemynear,palno>=7)
kill = 0
absolute = 1
Ignorehitpause = 1
persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 =  EnemyNear,facing = facing      ;带入的敌人，不要加变量
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = 1;animelem = 1
edge = 11,11         ;变瘦 不要卡到身后



[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3221
Ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 11
value = 1
Ignorehitpause = 1

[state a]
type = velset
trigger1 = Time = 11              ;animelem = 3
x = -1.5                 ; -0.5*(p2bodydist x =[-30,30]) -0.5*(p2bodydist x =[-60,60])
y = -5.5    +4.5          ;+ 0.5*(pos Y < -25)  + 0.5*(pos Y < -50)  ;+ 0.5*(pos Y < -75)
Ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = Time > 11    ;animelemtime(3) > 0
y = 0.4   +0.1*(time > 10) + 0.1*(time > 20)   +0.1*(time > 30)  +0.1*(time > 40)
Ignorehitpause = 1

[State 821, 3]
type = SelfState
triggerall = time > 11
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
;Ignorehitpause = 1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


;------------------------------------------
;普通浮空的带入       (上挑)
[Statedef 3229]
type    = A
movetype= H
physics = N
;velset = -3,10.5
velset = -0.05,-0.05        ; no use
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0     ;    0----无碰撞


;[State 0, PosSet]          ;防止 卡在空中
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5
;ignorehitpause = 1


[State 1];
type = NotHitBy
triggerall = 0
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.01*lifemax - 0.01*lifemax*(enemynear,palno>=4) - 0.01*lifemax*(enemynear,palno>=7)
absolute = 1
Ignorehitpause = 1
persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 =  EnemyNear,facing = facing      ;带入的敌人，不要加变量
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1


;[State 210, Width];画面端の押しし判定
;type = Width
;trigger1 = 1;animelem = 1
;edge = 20,20



[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3221
Ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 11
value = 1
Ignorehitpause = 1

[state a]
type = velset
trigger1 = Time = 11  ;animelem = 3
x = -0.8   +0.2*(p2bodydist x !=[-30, 30] ) +0.2*(p2bodydist x !=[-55, 55]  )
y = -9.5 + 0.5*(pos Y < -25)  + 0.5*(pos Y < -50) + 0.5*(pos Y < -75) ;+ 0.5*(pos Y < -75)
Ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = Time > 11    ;animelemtime(3) > 0
y = 0.4   +0.1*(time > 20)   +0.1*(time > 30)  +0.1*(time > 40)
Ignorehitpause = 1

[State 821, 3]
type = SelfState
triggerall = time > 11
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
;Ignorehitpause = 1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


;==============================当身效果 【敌人】被带入状态 ==============
[Statedef 3211]                       ;选择
movetype= H
;anim = 3211
ctrl = 0

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1




[State 1];
type = NotHitBy
trigger1 = 1
value = SCA
time = 2
Ignorehitpause = 1


[State 3606,anim]
type = ChangeAnim;2
Trigger1 = Time >= 0
Trigger1 = anim != 5030
value = 5030
Ignorehitpause = 1


[State 210, 5]
type = ChangeState
trigger1 = Time >= 0
trigger1 = pos y > -10
value = 3212
ctrl = 0
ignorehitpause = 1



[State 210, 5]
type = ChangeState
trigger1 = Time >= 0
value = 3213
ctrl = 0
ignorehitpause = 1

[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1
;======================================

;==============================当身效果 【敌人】被带入状态 ==============  陆地
[Statedef 3212]
type    = S
movetype= H
physics = S
;anim = 5050
velset = 0,0

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.09*lifemax
absolute = 1
kill = 0
Ignorehitpause = 1
persistent = 0

[State 1];
type = NotHitBy
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1



[State 3606,anim]
type = ChangeAnim2
Trigger1 = Time = 0
value = 5007
Ignorehitpause = 1

[State 0, Turn]
type = Turn
trigger1 =   (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = [0,1]

;[State 700, 2];被抓取的对象 进入无敌 ，以防被队友打中 从而化解投技
;type = NotHitBy
;trigger1 = 1
;value = SCA

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 1830]
;type = ChangeAnim2
;Trigger1 = Time = 0
;value = 5007


[State 820, 1]
type = SelfState
trigger1 = time >= 25
trigger1 = Alive
value = 0
ctrl = 1
;ignorehitpause=1

[State 820, 1]
type = SelfState
trigger1 = time >= 20
trigger1 = !Alive
value = 5050
;ignorehitpause=1

[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1

;==============================当身效果 【敌人】被带入状态 ============== 浮空

[Statedef 3213]
type    = A
movetype= H
physics = N
;velset = -3,10.5
;anim = 5050
velset = -0.05,-0.05      ; no use  没用  但是可以防止卡住
sprpriority = 1


[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1


[state a]
type = lifeadd
triggerall     = 1          ; normal   -------  [turn on]   -------
trigger1= time = 0
value = -0.09*lifemax
kill = 0
absolute = 1
Ignorehitpause = 1
persistent = 0


[State 1];
type = NotHitBy
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1


[State 52, 2]
type = PosSet
trigger1 = pos Y > -8
trigger1 = Time = 0
y = -8
ignorehitpause = 1

[state a]
type = turn
trigger1 =   (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
ignorehitpause = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 5050
ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 15
value = 1
ignorehitpause = 1

[state a]
type = velset
trigger1 = time = 15
x = -0.8
y = -7.8 ;-1.1*(pos Y > -5)
ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = time >= 15
y = .5
ignorehitpause = 1

[State 821, 3]
type = SelfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
ignorehitpause=1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1



;==============================当身效果 【敌人】被带入状态 ============== 浮空     测试用 即死

[Statedef 13213]
type    = A
movetype= H
physics = N
;velset = -3,10.5
;anim = 5050
velset = -0.05,-0.05     ; no use
sprpriority = 1


[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1


[state a]
type = lifeadd
triggerall     = 1         ; FOR  TEST  -------  [it must be  off]   -------
trigger1= time = 0
value = -1.17*lifemax
kill = 1
absolute = 1
Ignorehitpause = 1
persistent = 0



[State 1];
type = NotHitBy
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1



[State 52, 2]
type = PosSet
trigger1 = pos Y > -8
trigger1 = Time = 0
y = -8
ignorehitpause = 1

[state a]
type = turn
trigger1 =   (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
ignorehitpause = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 5050
ignorehitpause = 1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 15
value = 1
ignorehitpause = 1

[state a]
type = velset
trigger1 = time = 15
x = -0.8
y = -7.8 ;-1.1*(pos Y > -5)
ignorehitpause = 1

[State 821, 1] ;dt[0.4
type = VelAdd
Trigger1 = time >= 15
y = .5
ignorehitpause = 1

[State 821, 3]
type = SelfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100
ignorehitpause=1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;==============================常用 【敌人】被带入状态 ==============
;倒地 可追加扫地             极速下落
[Statedef 3261]
type    = A
movetype= H
physics = N
velset = -0.05,-0.05        ; no use
;velset = 0,0
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.03*lifemax      ;0.04
absolute = 1
Ignorehitpause = 1
persistent = 0

[State 700, 2];无敌
type = NotHitBy
trigger1 = 1
;trigger1 = time > 2
value = SCA
ignorehitpause=1

;[State 0, PosAdd]
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5


;[state a]
;type = lifeadd
;trigger1= time = 0
;value = -0.03*lifemax
;absolute = 1

;[state a]                                ;暂停 4帧
;type = pause
;trigger1 = time = 0
;time = 4
;IgnoreHitPause = 1
;persistent = 0

[state a]
type = turn
trigger1 = 0
trigger1 =  (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
ignorehitpause=1

;[State 1003, CA-1]
;type = ChangeAnim
;trigger1 = Time = 0
;trigger1 = SelfAnimExist(5052) = 1
;value = 5052

[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != 5030
value = 5030
ignorehitpause=1


[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 15
value = 1
ignorehitpause=1

[state a]
type = velset
trigger1 = time = 15
x = -2.5
y = 22
IgnoreHitPause = 1
persistent = 0

[state a]
type = veladd
trigger1 = time > 15
;x = 0.1
y = 3
ignorehitpause=1

;[State 2100, ]
;type = Velmul
;Trigger1 = time != 0
;x = 0.9
;y = 0.9

[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1



[State 820, 1]
type = Changestate
trigger1 = Pos Y > 5
trigger1 = Vel Y > 0
value = 3262
;ignorehitpause=1




;---------------------------------------------------------------------------
;倒地 可追加扫地           弹起
[Statedef 3262]
type    = A
movetype= H
physics = N
velset = -1.5,-5
sprpriority = 1


[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[State 1];
type = NotHitBy
trigger1 = time < 2
value = SCA
time =1
Ignorehitpause = 1

[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != 5100
value = 5100
ignorehitpause=1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 6
value = 1
ignorehitpause=1


[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 6
trigger1 = Anim != 5050
value = 5050
ignorehitpause=1

;[State 820, 1]
;type = ChangeAnim2
;Trigger1 = Time = 0
;value = 252

[state a]
type = envshake
trigger1 = Time = 0
time = 10
freq = 60
ampl = -4
ignorehitpause=1

[State 2100, ]
type = Veladd
trigger1 = Time > 6
y = 0.35 ;4
ignorehitpause=1

;---------------------[GtFNg] ---------add
;[State 1300, GtFNg\]
;type = Explod
;trigger1 = animelem = 1
;anim = F61
;pos = 0, -10
;postype = p1
;sprpriority = 2
;bindtime = 1
;ownpal = 1
;removeongethit = 1
;supermovetime = 12

[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1

[State 820, 1]
type = Changestate
trigger1 = Pos Y > 5
trigger1 = Vel Y > 0
value = 3263
;ignorehitpause=1



;---------------------------------------------------------------------------
;倒地
[Statedef 3263]
type    = L
movetype= H
physics = S
velset = 0,0
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1


[state a]
type = posset
;trigger1 = time >= 0
trigger1 = time = 0
y = 0
ignorehitpause = 1


[State 700, 2];无敌
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause=1


[State 210, Width]; 挤出空间 为了逆向
type = Width
trigger1 = 1
edge = (-1)*const(size.ground.back)-3,const(size.ground.front)+3
ignorehitpause=1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3263
ignorehitpause=1


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


[State 820, 1]
type = SelfState
trigger1 = Animtime = 0
trigger1 = Alive
value = 5120
;ignorehitpause=1


[State 820, 1]
type = SelfState
trigger1 = Animtime = 0
trigger1 = !Alive
value = 5150
;ignorehitpause=1
 


 ;==============================常用 【敌人】被带入状态 ==============
;倒地 可追加扫地            冲拳后  远距离飞行
[Statedef 3264]
type    = A
movetype= H
physics = N
velset = -0.05,-0.05        ; no use
;velset = 0,0
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[state a]
type = lifeadd
trigger1=0
trigger1= time = 0
value = -0.02*lifemax
;kill = 0
absolute = 1
Ignorehitpause = 1
persistent = 0


[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
;ignorehitpause =
;persistent =


[State 700, 2];无敌
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause=1

;[State 0, PosAdd]
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5


;[state a]
;type = lifeadd
;trigger1= time = 0
;value = -0.03*lifemax
;absolute = 1

;[state a]                                ;暂停 4帧
;type = pause
;trigger1 = time = 0
;time = 4
;IgnoreHitPause = 1
;persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 = EnemyNear,facing = facing
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1

;[State 1003, CA-1]
;type = ChangeAnim
;trigger1 = Time = 0
;trigger1 = SelfAnimExist(5052) = 1
;value = 5052

[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != 5007
value = 5007
ignorehitpause=1


[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 15
value = 1
ignorehitpause=1

[state a]
type = velset
trigger1 = time = 15
x = -22
y = -2
IgnoreHitPause = 1
persistent = 0

[state a]
type = veladd
trigger1 = time > 15
x = 0.5
y = 0.5
ignorehitpause=1

;[State 2100, ]
;type = Velmul
;Trigger1 = time != 0
;x = 0.9
;y = 0.9

[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1

[State 820, 1]
type = Changestate
trigger1 = Pos Y > 5
trigger1 = Vel Y > 0
value = 3265
;ignorehitpause=1



;---------------------------------------------------------------------------
;倒地 可追加扫地           弹起
[Statedef 3265]
type    = A
movetype= H
physics = N
velset = -2.5,-3
sprpriority = 1


[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1


[State 700, 2];无敌
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause=1

[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != 5100
value = 5100
ignorehitpause=1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 6
value = 1
ignorehitpause=1


[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 6
trigger1 = Anim != 5050
value = 5050
ignorehitpause=1

;[State 820, 1]
;type = ChangeAnim2
;Trigger1 = Time = 0
;value = 252

[state a]
type = envshake
trigger1 = Time = 0
time = 10
freq = 60
ampl = -4
ignorehitpause=1

[State 2100, ]
type = Veladd
trigger1 = Time > 6
y = .4
ignorehitpause=1

;---------------------[GtFNg] ---------add
;[State 1300, GtFNg\]
;type = Explod
;trigger1 = animelem = 1
;anim = F61
;pos = 0, -10
;postype = p1
;sprpriority = 2
;bindtime = 1
;ownpal = 1
;removeongethit = 1
;supermovetime = 12

[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


[State 820, 1]
type = Changestate
trigger1 = Pos Y > 5
trigger1 = Vel Y > 0
value = 3263
;ignorehitpause=1





;==============================常用 【敌人】被带入状态 ==============
;倒地              2000后 极速下落
[Statedef 3266]
type    = A
movetype= H
physics = N
velset = -0.05,0.05        ; no use
;velset = 0,0
sprpriority = 1

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[state a]
type = lifeadd
trigger1= time = 0
value = -0.11*lifemax
;kill = 0
absolute = 1
Ignorehitpause = 1
persistent = 0


[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
;ignorehitpause =
;persistent =


[State 700, 2];无敌
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause=1

;[State 0, PosAdd]
;type = PosSet
;trigger1 = time = 0
;trigger1 = pos Y > -5
;y = -5


;[state a]
;type = lifeadd
;trigger1= time = 0
;value = -0.03*lifemax
;absolute = 1

;[state a]                                ;暂停 4帧
;type = pause
;trigger1 = time = 0
;time = 4
;IgnoreHitPause = 1
;persistent = 0

[state a]
type = turn
trigger1 = 1
trigger1 =  EnemyNear,facing = facing      ;带入的敌人，不要加变量
;trigger1 = (EnemyNear,pos x - pos x)*facing  < 0
trigger1 = time = 0
Ignorehitpause = 1

;[State 1003, CA-1]
;type = ChangeAnim
;trigger1 = Time = 0
;trigger1 = SelfAnimExist(5052) = 1
;value = 5052

[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != 5007
value = 5007
ignorehitpause=1


[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 5
value = 1
ignorehitpause=1

[state a]
type = velset
trigger1 = time = 5
x = -3
y = 21
IgnoreHitPause = 1
persistent = 0

[state a]
type = veladd
trigger1 = time > 5
y = 0.5
ignorehitpause=1

;[State 2100, ]
;type = Velmul
;Trigger1 = time != 0
;x = 0.9
;y = 0.9

[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1

[State 820, 1]
type = Changestate
trigger1 = Pos Y > 5
trigger1 = Vel Y > 0
value = 3267
;ignorehitpause=1



;---------------------------------------------------------------------------
;倒地 可追加扫地           弹起         2000后 极速下落
[Statedef 3267]
type    = A
movetype= H
physics = N
velset = -2.5,-4
sprpriority = 1


[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1


[State 700, 2];无敌
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause=1

[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != 5100
value = 5100
ignorehitpause=1

[State 820, 1]
type = PosFreeze
trigger1 = Time >= 0
trigger1 = Time < 6
value = 1
ignorehitpause=1


[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time = 6
trigger1 = Anim != 5050
value = 5050
ignorehitpause=1

;[State 820, 1]
;type = ChangeAnim2
;Trigger1 = Time = 0
;value = 252

[state a]
type = envshake
trigger1 = Time = 0
time = 10
freq = 60
ampl = -4
ignorehitpause=1

[State 2100, ]
type = Veladd
trigger1 = Time > 6
y = .4
ignorehitpause=1

;---------------------[GtFNg] ---------add
;[State 1300, GtFNg\]
;type = Explod
;trigger1 = animelem = 1
;anim = F61
;pos = 0, -10
;postype = p1
;sprpriority = 2
;bindtime = 1
;ownpal = 1
;removeongethit = 1
;supermovetime = 12


[State 820, 1]            ;防止卡住
type = Selfstate
trigger1 = time > 180
value = 5210
ignorehitpause=1


[State 820, 1]
type = Changestate
trigger1 = Pos Y > 5
trigger1 = Vel Y > 0
value = 3263
;ignorehitpause=1




;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
; 防御中爆气攻击
[Statedef 290]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= -1000
ctrl = 0
velset = 0,0
;anim = 290
sprpriority = 1
facep2 = 1





[State 1000, 5]          ;爆豆闪光 前景
type = Explod
trigger1 = time = 0
trigger1 = prevstateno = [150,153]
anim = 6000
id = 6000
sprpriority = 4
postype = p1
pos = 0,-70
scale = 0.5,0.5
bindtime = 1
pausemovetime = 99999
supermovetime = 99999
removeongethit = 1
under = 0
ownpal = 1
IgnoreHitPause = 1
persistent = 0


[State 0, Pause]
type = superPause
trigger1 = prevstateno = [150,153]
trigger1 = time = 0
time = 11
movetime = 0
anim = -1
sound = s8290,0
darken = 120
;ignorehitpause =
persistent = 0

[State 1003, CA-2]
type = ChangeAnim
trigger1 = Time >= 1  -  1*(prevstateno != [150,153])
trigger1 = Anim != 220
value = 220


;--------------------        普通级  属性
[State 1];o长巫B
type = NotHitBy
trigger1 =  animelemtime(7) <2
value = SCA
time = 1

;--------------------        狂中  属性
[State 1];o长巫B
type = NotHitBy
trigger1 = fvar(22) >= 5
trigger1 = enemynear,Movetype = H
value = SCA
time = 1




[State 3040, 7];画面フラッシュ
type = EnvColor
trigger1 = movehit
persistent = 0
ignorehitpause = 1
time = 5
value = 255,255,255
under = 1

;===============================




;--------------------速度
[state a]
type = velset
trigger1 = animelem = 3
x = 21; 14
;--------------------速度
[state a]
type = velmul
trigger1 = vel x != 0
x = 0.96
;--------------------速度
[state a]
type = velset
trigger1 = animelem = 6
x = 0


[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 3
value = 200,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1


[State 200, 1];
type = PlaySnd
trigger1 = animelem = 4
value = 500, 1



[State 240, 2]
type = HitDef
trigger1 = Time = animelem = 4
attr = S, NA
animtype  = high
damage    = 50*(0.1*fvar(22)+1)
priority = 6, Hit
getpower = 200,100
guardflag = -1 ;MA
pausetime = 11,12
sparkno = s-1
sparkxy = -15,-95
hitsound   = s490,0
guard.sparkno = s7010
guardsound = s121,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 17
ground.velocity = -5,-6.5
air.velocity = -5,-6.8
yaccel = 0.45
fall = 1
fall.recover = 0
ID = 290



[State 20] ;qbg
type = targetState
trigger1 = movehit && NumTarget(290)
value = 3261;2625
ctrl = 0
IgnoreHitPause = 1
Persistent     = 0





[State 210, 5]
type = ChangeState
trigger1 = Anim = 290
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;下 轻脚
[Statedef 400]
type    = C
movetype= A
physics = C
juggle  = 1
poweradd= 0
ctrl = 0
anim = 400        + 2*(var(59)>0 && fvar(19)>0)
sprpriority = 1


[State 0, Turn]         ;自动转身
type = Turn
trigger1 = var(59) > 0
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0



[State 0, NotHitBy]             ;高P带有短暂无敌  (非投技)
type = NotHitBy
trigger1 = fvar(22)>=5
trigger1 = time = 0
value = ,AA,AP
time = 2                    ;第六帧 出攻击




[State 810, ];某些射程很近的技能  AttackDist 修正
type = AttackDist
trigger1 = 1
value = 100


;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = velset
trigger1 = time = 1
x = 0.5


[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 3
value = 200,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1


[State 400, 2]
type = HitDef
trigger1 = 1
trigger1 = animelem = 4
attr = C, NA
damage    = 20*(1+0.1*fvar(22))
priority = 3, Hit
animtype  = Light
hitflag = MAF
guardflag = LA
getpower = 30+3*fvar(22),10
pausetime = 10, 9
sparkno = s-1;s7020
sparkxy = -10,-53
hitsound   = s410,0
guard.sparkno = s7010
guardsound = s120,0
ground.type = low
ground.slidetime = 13     -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 13    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -5
air.velocity = -1.4,-3.8        +1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200)
airguard.velocity = -1.2,-2.8
fall.recover = 0
ID = 400
yaccel = 0.45

[State 200, 1];                   风声
type = PlaySnd
trigger1 = animelem = 2
value = 310, 0


;---------------------[轻拳火花]
[state a];
type = Helper
trigger1 = movehit
id = 7000
;name = "hit"
pos = floor(p2dist x/2 +25) +(random % 10) , floor(p2dist y/2 -5) -(random % 10)
postype = p1
stateno = 7000
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0


[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11;11
ctrl = 1






;---------------------------------------------------------------------------
;屈B            【斩脚】
[Statedef 410]
type    = C
movetype= A
physics = C
juggle  = 1
poweradd= 30
ctrl = 0
;velset = 0,0
anim = 410


[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22) >= 5
trigger1 = movehit               ;命中敌人后 进入无敌
trigger1 = animelemtime(7)< 2
value = SCA
time = 2
ignorehitpause = 1




;-----------------------ADD        刀光
[State 2001]
type = Explod
trigger1 = animelemtime(2) = 1;7
anim = 8410           ;
pos = 3,-1
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8410                ;
bindtime = -1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 9999999
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0



[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 2
value = 210,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1




;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0




[State 200, 1];
type = PlaySnd
trigger1 = animelem = 3
value = 500,0



[State 230, Projectile]               ;
type = Projectile
;trigger1 = fvar(19) = 0
trigger1 = fvar(22) >= 5            ;破除简单挡身
trigger1 = animelem = 3  ;|| animelem = 4    ;|| animelem = 5 || animelem = 6 ;|| animelem = 7
attr = C, NP
damage    =(10*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),1
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = L
getpower = 30+3*fvar(22),10
pausetime = 2,10
sparkno = s-1
sparkxy = 20+random%20 ,-50-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = low
ground.slidetime = 19   -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 2.5 ;,-5.5    +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)      -2
guard.velocity = -5
air.velocity = -1.8,-4.4 -1.1*(enemynear,pos Y > -25)    +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)
air.fall = 1
fall = 0
fall.recovertime = 90
ID = 433
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -5
yaccel = .45
numhits = 0
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 433
projanim = 233
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 11; 12
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 2;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 50,30; 50,25
postype = p1
projshadow = 0,0,0
supermovetime = 9999
pausemovetime = 9999




[State 1];        命中后   图片#7之后   无敌
type = NotHitBy
trigger1 =  var(59)>0  &&  Roundstate = 2  && alive && (!ishelper)                ;AI连招用
trigger1 =  animelemtime(6)> 3  && animelemtime(8)< 1   ;为7准备
trigger1 =  fvar(19)>0                                  ; 命中后
value = SCA
time = 1


[State 230, Projectile]               ;
type = Projectile
trigger1 = var(59)>0  &&  Roundstate = 2  && alive && (!ishelper)                  ;AI连招 带入用
;trigger1 = numhelper(2150)= 0  && numhelper(2350)= 0 ;&&  numhelper(2650)= 0      ;AI连招 带入用 无NPC
trigger1 = fvar(19) > 0              ; 命中后
trigger1 = fvar(22) >= 5            ;破除简单挡身
trigger1 =  animelem = 7  ; || animelem = 6
attr = C, NP
damage    =(10*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),1
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = L
getpower = 30+3*fvar(22),10
pausetime = 2,10
sparkno = s-1
sparkxy = 20+random%20 ,-50-random%20
hitsound   = s510,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = low
ground.slidetime = 19   -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 2.5 ;,-5.5    +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)      -2
guard.velocity = -5
air.velocity = -1.8,-4.4 -1.1*(enemynear,pos Y > -25)    +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)
air.fall = 1
fall = 0
fall.recovertime = 90
ID = 435
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -5
yaccel = .45
;numhits = 1
hitonce = 1
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 435
projanim = 233
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 2; 11
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1;   only  1    for   AI连招用
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 50,30; 50,25
postype = p1
projshadow = 0,0,0
supermovetime = 9999
pausemovetime = 9999
p1stateno = 230 + (2300 -230)*(power >= 1000 && numhelper(2150)= 0  && numhelper(2350)= 0  && (random % (2+1*(power>2000)) !=0)    )






;-----------------------物理攻击;--------------------
[State 210, 2]
type = HitDef
;trigger1 = ( fvar(19) > 0 && animelemtime(6)>0 )   ||  fvar(22) < 5   ; 对方挨打，或者低P，防止挡身
trigger1 = animelem = 5
trigger1 = fvar(22) < 5  ||  !var(59)           ;human

trigger2 = animelem = 6  &&   var(59) > 0  && 0       ;Ai
trigger2 = fvar(22) >= 5 &&  fvar(19) > 0

attr = C, NA
animtype  = medium
damage    =(30*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 4, Hit
getpower = 60+5*fvar(22),30
guardflag = LA
pausetime = 12,11    ;  11,12
sparkno = s-1
sparkxy = -10,-70
hitsound   = s510,0
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 19   -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 4.5 ;,-5.5    +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)      -2
air.velocity = -1.8,-4.4    +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)
guard.velocity = - 7
airguard.velocity = -2.5,-4
ID = 410
fall = 0
air.fall = 1
fall.recovertime = 90
Ground.CornerPush.VelOff   = -11
Air.CornerPush.VelOff      = -11
Down.CornerPush.VelOff     = -11
Guard.CornerPush.VelOff    = -11
yaccel = 0.45


;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7001
;name = "hit"
pos = floor(p2dist x/2 +15) +(random % 10) , floor(p2dist y/2 -45) -(random % 20)
postype = p1
stateno = 7001
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0


[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1




;---------------------------------------------------------------------------
;屈C           【弧形斩】
[Statedef 420]
type    = C
movetype= A
physics = C
juggle  = 1
poweradd= 30
ctrl = 0
;velset = 0,0
anim = 420


;-----------------------ADD       高度标尺
[State 2001]
type = Explod
triggerall = 0            ; 测试用   应关闭
trigger1 = time = 1
anim =    9997       ;
pos = -20,0
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 9997            ;
bindtime = 1
sprpriority = 2
;ontop = 1
;removeongethit = 1
IgnoreHitPause = 1
persistent = 0

;-----------------------ADD       高度标尺
[State 2001]
type = Explod
triggerall = 0            ; 测试用   应关闭
trigger1 = time = 1
anim =    9997       ;
pos = -20,-50
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 9997            ;
bindtime = 1
sprpriority = 2
;ontop = 1
;removeongethit = 1
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD       高度标尺
[State 2001]
type = Explod
triggerall = 0            ; 测试用   应关闭
trigger1 = time = 1
anim =    9997       ;
pos = -20,-100
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 9997            ;
bindtime = 1
sprpriority = 2
;ontop = 1
;removeongethit = 1
IgnoreHitPause = 1
persistent = 0




[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  animelemtime(2) = 0
value = 9000,0 +(Random%4)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0




;-----------------------ADD  刀 光
[State 2001]
type = Explod
trigger1 = animelemtime(3) = 0;7
anim = 8420           ;
pos = 0,8
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8420                ;
bindtime = -1
sprpriority = 5
;ontop = 1
;vel = -0.5,0
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 9999999
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0






[State 0, StateTypeSet]
type = StateTypeSet
trigger1 =  animelem = 3
statetype = S
physics = S
ignorehitpause = 1






;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度    前摇 起步
;--------------------速度
[state a]
type = velset
trigger1 = animelem = 2
x = 6

;--------------------速度
[state a]
type = velmul
trigger1 = vel x != [-0.5,0.5]
x = 0.95  -0.1* ((enemynear,pos x - pos x)*facing   < 35)-0.05* ((enemynear,pos x - pos x)*facing   < 55)  -0.05* ((enemynear,pos x - pos x)*facing   < 75)

;--------------------速度     后摇 惯性
[state a]
type = velset
trigger1 = animelem = 5
x = 5


[State 200, 1];
type = PlaySnd
trigger1 = animelem = 3
value = 500, 2



[State 210, 2]
type = HitDef
trigger1 = fvar(22) < 3   ;凶
trigger1 = animelem = 5
attr = C, NA
animtype  = Up
ground.type = head
damage    =(40*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 4, Hit
getpower = 30+3*fvar(22),10
hitflag = MAF
guardflag = MA
pausetime = 14,13    ;  11,12
sparkno = s-1
sparkxy = -10,-70
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.slidetime = 19    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 2.2,-5.6      +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)    -1.5*(enemynear,pos Y > -35)
air.velocity = -2.2,-4.1         +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)    -1.5*(enemynear,pos Y > -35)
guard.velocity = - 4.8
airguard.velocity = -2.4,-4
ID = 420
fall = 1
air.fall = 1
fall.recovertime = 90
Ground.CornerPush.VelOff   = -11
Air.CornerPush.VelOff      = -11
Down.CornerPush.VelOff     = -11
Guard.CornerPush.VelOff    = -11
yaccel = 0.45
;---------------------------
;envshake.time = 12
;envshake.ampl = 5
;envshake.freq = 30


[State 210, 2]
type = HitDef
trigger1 = fvar(22) >= 3
trigger1 = animelem = 5
attr = C, NA
animtype  = Up
ground.type = head
damage    =(40*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 4, Hit
getpower = 30+3*fvar(22),10
hitflag = MAF
guardflag = M             ;狂
pausetime = 14,13    ;  11,12
sparkno = s-1
sparkxy = -10,-70
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.slidetime = 19    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 2.2,-5.6      +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)    -1.5*(enemynear,pos Y > -35)
air.velocity = -2.2,-4.1         +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)    -1.5*(enemynear,pos Y > -35)
guard.velocity = - 4.8
airguard.velocity = -2.4,-4
ID = 420
fall = 1
air.fall = 1
fall.recovertime = 90
Ground.CornerPush.VelOff   = -11
Air.CornerPush.VelOff      = -11
Down.CornerPush.VelOff     = -11
Guard.CornerPush.VelOff    = -11
yaccel = 0.45
;---------------------------
;envshake.time = 12
;envshake.ampl = 5
;envshake.freq = 30



;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 +15) +(random % 10) , floor(p2dist y/2 -85) -(random % 20)
postype = p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;---------------------------------------------------------------------------


;---------------------------------------------------------------------------
;空中 A
[Statedef 600]
type    = A
movetype= A
physics = A
juggle  = 1
poweradd= 0
ctrl = 0
anim = 600
sprpriority = 2

;--------------------速度
[state a]
type = velmul
triggerall = var(59) > 0
triggerall = Roundstate = 2  && alive && (!ishelper)

trigger1 = fvar(19)>0                ;对方挨打且 前板边距离小时， 防止失误
trigger1 = frontedgedist <45
x = 0.8


[State 0, NotHitBy]             ;高P     条件无敌 骗全屏凹
type = NotHitBy
trigger1 = fvar(22)>=5
trigger1 = animelemtime(6)< 0
trigger1 = (EnemyNear(var(55)),pos x - pos x)*facing  > 125   &&  prevstateno = 106   ;条件无敌 骗全屏凹
value = SCA
time = 1
ignorehitpause =  1

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 1
edge = 29,19


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 6
edge = 19,19



;--------------------速度
;[state a]
type = velmul
trigger1 = 1;animelemtime(1) > 0
x = 0.7
y = 0.9

;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 3
y = -1.5

;--------------------速度
[state a]
type = veladd
trigger1 = animelemtime(9) > 2
y = 0.8



;-------------------- 狂级 加速 下落
[state a]
type = veladd
trigger1 = var(59)>0               ;-----------------for ai  -----
trigger1 = fvar(22) >=3
trigger1 = prevstateno = 106
trigger1 = animelemtime(2) > 0
;trigger1 = ( enemynear,vel x != [-0.5,0.5]  )  || (  (enemynear,pos x - pos x)*facing >200 )  || (  (enemynear,pos x - pos x)*facing  <0 )
;trigger1 = enemynear,stateno >= 200  && enemynear, ctrl = 0
;trigger1 = ((time >  enemynear,time  ||  time > var(19) )&& enemynear,movetype =A)  || enemynear,time -  var(19) > 20  || (  (enemynear,pos x - pos x)*facing  <0 )
y = 0.7 + 0.2*(fvar(22) >=5)      ;0.8 合适


[State 600, 2]
type = HitDef
;trigger1 = fvar(22) < 3
trigger1 = animelem = 4;7
attr = A, NA
animtype = light
damage    =(20*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 3, Hit
getpower = 30+3*fvar(22),10
hitflag = MAF
guardflag = HA
pausetime = 7,9               -2*(var(47)<-900) -4*(var(47)<-1200) ;修复重力保护
sparkno = s-1
sparkxy = -10,-54+0.5*(p2dist y)
guard.sparkno = s7010
hitsound   = s410,0
guardsound = s120,0
ground.type = high
ground.slidetime = 16  -2*(var(47)<-900) -4*(var(47)<-1200); -3*(var(47)<-1200)
ground.hittime  = 16  -2*(var(47)<-900) -4*(var(47)<-1200) ;-3*(var(47)<-1200)
ground.velocity = -3 ;4
air.velocity = -1.1,-2.1    -0.5*(enemynear,pos Y > -25)    +0.6*(var(47)<-600) +0.6*(var(47)<-900) +0.6*(var(47)<-1200)    ;2.4
yaccel = 0.45
ID = 600
air.fall = 1
fall.recovertime = 60



;---------------------[轻拳火花]
[state a];
type = Helper
trigger1 = movehit
id = 7000
;name = "hit"
pos = floor(p2dist x/2 +25) +(random % 10) , floor(p2dist y/2 -25) -(random % 20)
postype = p1
stateno = 7000
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0




[State 200, 5]
type = PlaySnd
trigger1 = AnimElem = 3
value = 310,0

[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 3
value = 200,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1




;-------------------------------------------------------------------------
[State 230, Projectile]               ;骗检测
type = Projectile
trigger1 = var(59) >0                  ;ai
trigger1 = fvar(22) >= 5               ;狂中
trigger1 = time = 0
attr = A, NP
damage = (30+10*(life<0.85*lifemax && fvar(22)>=5))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 50+5*fvar(22),30
pausetime = 2,10
sparkno = s-1
sparkxy = 20+random%20 ,-50-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19 -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -4
air.velocity = -2,-3.9          +0.5*(var(47)<-600) +0.5*(var(47)<-900) +0.5*(var(47)<-1200)
air.fall = 1
fall.recovertime = 80
ID = 6233
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -5
yaccel = .45
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 6233
projanim = 233
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 2  ;12
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = -22,999
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261



[State 0, CtrlSet]
type = CtrlSet
trigger1 =  animelemtime(9) > 1
value = 1
;ignorehitpause =
;persistent =

;--------------------------------------


;---------------------------------------------------------------------------
;空中 A
[Statedef 610]
type    = A
movetype= A
physics = A
juggle  = 1
poweradd= 0
;velset = 0,0
ctrl = 0
anim = 610
sprpriority = 2


;--------------------速度
[state a]
type = velmul
triggerall = var(59) > 0
triggerall = Roundstate = 2  && alive && (!ishelper)

trigger1 = fvar(19)>0                ;对方挨打且 前板边距离小时， 防止失误
trigger1 = frontedgedist <45
x = 0.8


[State 0, NotHitBy]             ;高P带有短暂无敌
type = NotHitBy
trigger1 = fvar(22)>=5
trigger1 = animelemtime(5)= 0
value = SCA
time = 4
ignorehitpause =  1
persistent = 0



[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 1
edge = 29,19


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 7
edge = 19,19


;-----------------------ADD        刀光
[State 2001]
type = Explod
trigger1 = animelemtime(4) = 0;7
anim = 8610           ;
pos = 0,15
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8610                ;
bindtime = -1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 9999999
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0




[State 610, 2]
type = HitDef
trigger1 = animelem = 4
attr = A, NA
animtype = medium
damage    =(30*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 3, Hit
getpower = 30+3*fvar(22),10
hitflag = MAF
guardflag = HA
pausetime = 12,13
sparkno = s-1
sparkxy = -20,-64+0.5*(p2dist y)
hitsound   = s510,0
guard.sparkno = s7010
guardsound = s120,0
ground.type = low
ground.slidetime = 20   -2*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 20    -2*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -3;+8*(vel x < 0)  ;,-2.9
air.velocity = -2,-5.5         +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)  -0.5*(p2dist Y > 25)  -0.5*(p2dist Y > 50)
ID = 610
fall = 0
air.fall = 1
fall.recover = 0
yaccel = 0.45
Ground.CornerPush.VelOff   = -5
Air.CornerPush.VelOff      = -5
Down.CornerPush.VelOff     = -5
Guard.CornerPush.VelOff    = -5


[State 20] ;qbg
type = targetState
trigger1 = fvar(19)>0
trigger1 = enemynear,statetype = A
trigger1 = movehit && NumTarget(610)      ;f 610
;value = 3223
value = 3223 +1*(var(47) < - 600)  +1*(var(47) <- 900) +1*(var(47) < - 1200)
ctrl = 0
IgnoreHitPause = 1
Persistent     = 0


;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7001
;name = "hit"
pos = floor(p2dist x/2 +10) +(random % 10) , floor(p2dist y/2 -55) -(random % 20)
postype = p1
stateno = 7001
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 200, 5]
type = PlaySnd
trigger1 = AnimElem = 3
value = 500,0

[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 3
value = 200,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1



[State 110, VelAdd]
type = VelAdd
trigger1 = time = 0
y = -0.5


[State 110, VelMul]
type = VelMul
trigger1 = vel x != [-5.5,5.5]
x = 0.9



;---------------------------------------------------------------------------
;空中 A
[Statedef 1610]
type    = A
movetype= A
physics = A
juggle  = 1
poweradd= 0
;velset = 0,0
ctrl = 0
anim = 1610
sprpriority = 2

;[State 0, PlayerPush]
;type = PlayerPush
;trigger1 = time > 2
;trigger1 = animelemtime(9) <0
;value = 0


;[State 0, PlayerPush]
;type = PlayerPush
;trigger1 = animelemtime(9) >=0
;value = 1


[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
;ignorehitpause =
;persistent =


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = movecontact
trigger1 =   (  (enemynear,pos x - pos x)*facing  )     > 0

edge = 6,6

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 9
edge = 12,12


;-----------------------ADD        刀光
[State 2001]
type = Explod
trigger1 = animelemtime(4) = 0;7
anim = 8610           ;
pos = 0,15
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8610                ;
bindtime = -1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0




[State 610, 2]
type = HitDef
trigger1 = animelem = 4
attr = A, NA
animtype = medium
damage    =(30*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 3, Hit
getpower = 80+5*fvar(22),40
hitflag = MAF
guardflag = HA
pausetime = 12,13
sparkno = s-1
sparkxy = -20,-64+0.5*(p2dist y)
hitsound   = s510,0
guard.sparkno = s7010
guardsound = s120,0
ground.type = low
ground.slidetime = 20   -2*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 20    -2*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)

ground.velocity = -0.1,-6.5
guard.velocity = -5
air.velocity = -0.1,-6.5+0.5*(enemynear,pos Y < -35)+0.5*(enemynear,pos Y < -55)+1*(enemynear,pos Y < -75) +1*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)
airguard.velocity = -4,-5

ID = 1610
fall = 1
air.fall = 1
fall.recover = 0
yaccel = 0.4
Ground.CornerPush.VelOff   = -5
Air.CornerPush.VelOff      = -5
Down.CornerPush.VelOff     = -5
Guard.CornerPush.VelOff    = -5



;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7001
;name = "hit"
pos = floor(p2dist x/2 +10) +(random % 10) , floor(p2dist y/2 -55) -(random % 20)
postype = p1
stateno = 7001
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 200, 5]
type = PlaySnd
trigger1 = AnimElem = 3
value = 500,0

[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 3
value = 200,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1



[State 110, VelAdd]
type = VelAdd
trigger1 = time = 0
y = -0.5


[State 110, VelAdd]
type = VelAdd
trigger1 = time > 2
y = 0.1


[State 110, VelMul]
type = VelMul
trigger1 = vel x != [-0.5,0.5]
x = 0.95




;---------------------------------------------------------------------------
;空中 A
[Statedef 620]
type    = A
movetype= A
physics = A
juggle  = 1
poweradd= 0
;velset = 0,0
ctrl = 0
anim = 620
sprpriority = 2


;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 1400]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = fvar(22) >= 5   ||  random < 11*fvar(22)  ; 高强度时  使用
triggerall = statetype = A

trigger1 = helper(32000),var(38)=0  ;cooldown
trigger1 = prevstateno = 110
trigger1 = frontedgedist < 50
trigger1 = pos Y < -40
trigger1 =  EnemyNear(var(55)), statetype = L
trigger1 = Time = 0
trigger1 = random <  255 - 55*(life > lifemax * 0.95) - 55*(life > lifemax * 0.85)+ 111*var(20)


value = 711
ignorehitpause = 1
;---------------------------------------------------------------------------



[State 0, NotHitBy]             ;高P带有短暂无敌
type = NotHitBy
trigger1 = fvar(22) = [3,4]
trigger1 = animelemtime(5)= 0
value = SCA
time = 3   +5*(var(48)>0)           ;如果对方是投技  则延迟，本来空中应该不吃投技，不过放宽要求
ignorehitpause =  1
persistent = 0


[State 0, NotHitBy]             ;高P带有短暂无敌
type = NotHitBy
trigger1 = fvar(22)>=5
trigger1 = animelemtime(3)= 0
value = SCA
time = 3   +5*(var(48)>0)  +5         ;如果对方是投技  则延迟，本来空中应该不吃投技，不过放宽要求
ignorehitpause =  1
persistent = 0



[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = movecontact
trigger1 =   (  (enemynear,pos x - pos x)*facing  )     > 0

edge = 45,19

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 8
edge = 19,19



;-----------------------ADD       刀光
[State 2001]
type = Explod
trigger1 = animelemtime(3) = 0;7
anim = 8620           ;
pos = 0,1
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8620                ;
bindtime = -1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 9999999
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0




[State 620, 2]
type = HitDef
trigger1 = animelem = 6
attr = A, NA
animtype = hard
damage    =(40*(1+0.1*fvar(22)))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5
priority = 3, Hit
getpower = 30+3*fvar(22),10
hitflag = MAF
guardflag = HA
pausetime = 12,14
sparkno = s-1
sparkxy = -25,-54 +0.5*(p2dist y)
hitsound   = s510,1
guard.sparkno = s7010
guardsound = s120,0
ground.type = high
ground.slidetime = 20   -2*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  =  20   -2*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -8.2+12.2*(vel x < 0)  ;,-2.9
air.velocity = -4,-5.5       +1.5*(var(47)<-600) +1.5*(var(47)<-900) +1.5*(var(47)<-1200)
ID = 620
fall = 0
air.fall = 1
fall.recover = 0
yaccel = 0.45
Ground.CornerPush.VelOff   = -5
Air.CornerPush.VelOff      = -5
Down.CornerPush.VelOff     = -5
Guard.CornerPush.VelOff    = -5



[State 20] ;qbg
type = targetState
trigger1 = fvar(19)>0
trigger1 = enemynear,statetype = A
trigger1 = movehit && NumTarget(620)      ;f 620
;value = 3223
value = 3223 +1*(var(47) < - 600)  +1*(var(47) <- 900) +1*(var(47) < - 1200)
ctrl = 0
IgnoreHitPause = 1
Persistent     = 0




;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 +15) +(random % 10) , floor(p2dist y/2 -45) -(random % 20)
postype = p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
supermovetime = 9999
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0


[State 200, 5]
type = PlaySnd
trigger1 = AnimElem = 3
value = 500,1

[State 200, 5]          ;voice
type = PlaySnd
trigger1 = animelem = 3
value = 210,0+(Random%4)      ;有一个为空
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1

[State 110, VelAdd]
type = VelAdd
trigger1 = time = 0
y = -1

[State 110, VelAdd]
type = VelAdd
trigger1 = movecontact
y = 0.1  +1.5*(frontedgedist < 25)


[State 110, VelMul]
type = VelMul
trigger1 = vel x != [-5.5,5.5]
x = 0.9


 [State 110, VelMul]
type = VelMul
triggerall =   (  (enemynear,pos x - pos x)*facing  )     <  0
trigger1 = movecontact
trigger2 =   (  (enemynear,pos x - pos x)*facing  )     <  -10
x = 0.97  -0.03* (movecontact)


;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
;空中  飞行道具
[Statedef 650]
type    = A
movetype= A
physics = A
juggle  = 1
poweradd= 50+10*fvar(22)
ctrl = 0
anim = 650   ; + 1*(fvar(22)>=3)
sprpriority = 1
;facep2 = 1





[State 200, 5];------------voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  1
trigger1 =  time = 1
value = 9100,5 +(Random%3)
;channel = 0
voulme = 511
channel = 9;10
;loop = 1
;lowpriority = 1
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = Varset
trigger1 = var(31) =0
trigger1 = time = 1
v = 31
value = 100  ;120f
ignorehitpause = 1
;persistent =

[State 0, Turn]
type = Turn
trigger1 = var(59) > 0     ;----------for ai
trigger1 = prevstateno = 50 ||  prevstateno = 110  ||  prevstateno = 115 ||  prevstateno = 105  ||  prevstateno = 1105
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0



[State -2]                      ;高P数强化防御性能
type = HitOverride
triggerall = 0                           ; 关闭【off】
Triggerall = fvar(22)>=5
triggerall = var(59) > 0 && RoundState = 2
triggerall =  !ishelper && alive
triggerall = helper(32000),var(39)=0  ||     helper(32000),var(38)=0   ;cooldown
triggerall =  time > 2

Trigger1 = 0              ;--------------------太过分 而削弱--------------关闭
Trigger1 = animelemtime(5)>= 0   &&   animelemtime(5)< 4
Trigger2 = animelemtime(11)>= 0   &&   animelemtime(11)< 4
Trigger3 = fvar(11) = 1                  ;飞行道具 命中

attr = SCA,AA,AP,AT                      ;飞行道具 命中 后  可以借全部类型攻击 向前闪现
stateno = ifelse( helper(32000),var(39)=0  ,710,711) ;710 cd则 711
time = 1
IgnoreHitPause = 1
persistent = 1



;----------------------------------------------------------------------------
[State 0, NotHitBy]             ;高P带有短暂无敌
type = NotHitBy
triggerall = 0
triggerall = fvar(22)>=3
triggerall = animelemtime(5) < 2

trigger1 = fvar(22)>=5
trigger1 = animelemtime(3)> 0

trigger2 = fvar(22)>=5
trigger2 =( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) > 35  || fvar(22)=6

trigger3 =( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) > 65

value = SCA
time = 2
ignorehitpause =  1
;persistent = 0


[State 0, NotHitBy]       ;高P带有短暂无敌
type = NotHitBy
triggerall = 0
triggerall = fvar(22)>=5
trigger1 = animelemtime(8)> 0    &&   animelemtime(11) < 2
value = SCA
time = 2
ignorehitpause =  1
;persistent = 0


;----------------------------------------------------------------------------
[State 0, NotHitBy]             ;高P带有短暂无敌  对远程
type = NotHitBy
triggerall = 1
triggerall = time = 0

trigger1 = fvar(22)>=5
trigger1 = enemy,numproj

trigger2 = fvar(22)>=5
trigger2 =( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) > 35

trigger3 = fvar(22)>=3
trigger3 =( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) > 55

value = SCA
time = 13
ignorehitpause =  1
persistent = 0


[State 0, NotHitBy]       ;高P带有短暂无敌
type = NotHitBy
triggerall = 1
triggerall = fvar(22)>=5
trigger1 = animelemtime(3)= 2
value = SCA
time = 6
ignorehitpause =  1
persistent = 0



[State 0, NotHitBy]       ;高P带有短暂无敌
type = NotHitBy
triggerall = 1
triggerall = fvar(22)>=5
trigger1 = animelemtime(8)= 2
value = SCA
time = 6
ignorehitpause =  1
persistent = 0


;----------------------------------------------------------------------------



[State 210, Width];画面端の押しし判定
type = Width
triggerall = animelem = 4
trigger1 = frontedgedist < 45
trigger2 =       (  (enemynear,pos x - pos x)*facing  )    < 5
edge = 30,20

[State 210, Width];画面端の押しし判定
type = Width
triggerall = animelem = 9
trigger1 = frontedgedist < 45
trigger2 =       (  (enemynear,pos x - pos x)*facing  )    < 5
edge = 40,20

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 11
edge = 20,20






;----------- 【添加Helper】 --------  添加 裂地
[state a]
type = Helper
trigger1 = pos y > -40
trigger1 =  animelemtime(4)= 0
sprpriority = 2
pos = 20, 0
postype = p1
stateno = 8650
id = 8650
helpertype = normal
pausemovetime = 0
keyctrl = 0
ownpal = 1
IgnoreHitPause = 1
Persistent = 0



;----------- 【添加Helper】 --------  添加 裂地
[state a]
type = Helper
trigger1 =  numhelper(8650)>0
trigger1 =  animelemtime(9)= 0
sprpriority = 2
pos = 20, 0
postype = p1
stateno = 8650
id = 8650
helpertype = normal
pausemovetime = 0
keyctrl = 0
ownpal = 1
IgnoreHitPause = 1
Persistent = 0



;----------- 【添加Helper】 --------  添加 裂空
[state a]
type = Helper
trigger1 = numhelper(8650)=0  ;没有裂地
trigger1 =  animelemtime(4)= (0+1)
sprpriority = 2
pos = 25, 35     ; 25
postype = p1
stateno = 8660
id = 8660
helpertype = normal
pausemovetime = 0
keyctrl = 0
ownpal = 1
IgnoreHitPause = 1
Persistent = 0



;----------- 【添加Helper】 --------  添加 裂空
[state a]
type = Helper
trigger1 =  numhelper(8660)>0
trigger1 =  animelemtime(9)= (0+1)
sprpriority = 2
pos = 25, 35        ; 25
postype = p1
stateno = 8660
id = 8660
helpertype = normal
pausemovetime = 0
keyctrl = 0
ownpal = 1
IgnoreHitPause = 1
Persistent = 0


;-----------------------ADD          刀光
[State 2001]
type = Explod
trigger1 = animelemtime(4) = 0;7
anim = 8650          ;
pos = 20,-170
scale = 0.5,0.7
postype = P1
ownpal = 1
id = 8650                ;
bindtime = -1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 9999999
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0


;-----------------------ADD      刀光
[State 2001]
type = Explod
trigger1 = animelemtime(9) = 0;7
anim = 8651           ;
pos = 20,-45
scale = 0.6,0.5
postype = P1
ownpal = 1
id = 8651               ;
bindtime = -1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 9999999
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0






;------------------------------------------------------------------
[state 40，turn];转身 ;原本是没有的
type = turn
trigger1 = 0
trigger1 = time = 9  ; 0
trigger1 = (EnemyNear(var(55)),pos x - pos x)*facing  < 0
IgnoreHitPause = 1


;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
Y = 0.5

;--------------------速度
[state a]
type = velmul
trigger1 = time = [1,41]
x = 0.9
y = 0.8

;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 1
;x = -0.5
y = -4.5


;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 4
y = -6.5

[state a]
type = veladd
trigger1 = animelem = 9
y = -6;.5

;--------------------速度
[state a]
type = veladd
trigger1 = animelemtime(10) > 2
;x = -1
y = 0.5 ; 0.5


;------------------------------------------ 狂级 加速 下落
[state a]
type = veladd
triggerall = 1
triggerall = var(59)>0            ;-----------------for ai  -----  写死在技能里
triggerall = fvar(22) >=3
triggerall = fvar(19) = 0
triggerall = EnemyNear(var(55)),time - EnemyNear(var(55)),animtime > 45  ||EnemyNear(var(55)),vel x > 16 -9*(p2dist x<35) ||(EnemyNear(var(55)),pos x - pos x)*facing  <0
triggerall = prevstateno = 106
triggerall = animelemtime(4) > 2
triggerall = EnemyNear(var(55)),stateno >= 200  && EnemyNear(var(55)), ctrl = 0

;trigger1 = ( EnemyNear(var(55)),vel x != [-0.5,0.5]  )  || (  (EnemyNear(var(55)),pos x - pos x)*facing >200 )
trigger1 =  EnemyNear(var(55)),time -  var(19) > 20  ;||  ((time >  EnemyNear(var(55)),time  ||  time > var(19) )&& EnemyNear(var(55)),movetype =A)

trigger2 =  (EnemyNear(var(55)),pos x - pos x)*facing  <0

trigger3 =  p2dist x< 70
trigger3 =  EnemyNear(var(55)),vel  x > 16 -9*(p2dist x<35)
;x = -1
y = 0.7 + 0.2*(fvar(22) >=5)      ;0.8 合适

;----------------------------------------------------------------------------
[State 620, Projectile]               ;
type = Projectile
trigger1 = animelem = 4
attr = A, NP
damage = (15+5*(life<0.85*lifemax && fvar(22)>=3))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 50+5*fvar(22),30
pausetime = 4,12                              -3*(var(47)<-900) -6*(var(47)<-1200) ;修复重力保护
sparkno = s-1
sparkxy = 60+random%20,10-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 -1*(var(47)<-600) -2*(var(47)<-900) -4*(var(47)<-1200)
ground.hittime  = 19 -1*(var(47)<-600) -2*(var(47)<-900) -4*(var(47)<-1200)
ground.velocity = -2.9
air.velocity = -1.1,-2.8     +0.5*(var(47)<-600) +1.5*(var(47)<-900) +3*(var(47)<-1200)  ;修复重力保护
air.fall = 1
fall.recovertime = 80
ID = 653
nochainID = 9999
guard.hittime = 18
guard.slidetime = 18
guard.velocity = -3.5
yaccel = 0.450
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 653
projanim = 653
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 5+5;-1
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1  ;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 25,-70
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261


[State 620, Projectile]               ;
type = Projectile
trigger1 = animelem = 9
attr = A, NP
damage = (15+5*(life<0.85*lifemax && fvar(22)>=3))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),2+2*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower =50+5*fvar(22),30
pausetime = 4,12                            -3*(var(47)<-900) -6*(var(47)<-1200) ;修复重力保护
sparkno =  s-1
sparkxy =  60+random%20,10-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 -1*(var(47)<-600) -2*(var(47)<-900) -4*(var(47)<-1200)
ground.hittime  = 19 -1*(var(47)<-600) -2*(var(47)<-900) -4*(var(47)<-1200)
ground.velocity = -2.9
air.velocity = -1.1,-2.8     +0.5*(var(47)<-600) +1.5*(var(47)<-900) +3*(var(47)<-1200)  ;修复重力保护
air.fall = 1
fall.recovertime = 80
ID = 1653
nochainID = 9999
guard.hittime = 18
guard.slidetime = 18
guard.velocity = -3.5
yaccel = 0.450
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 1653
projanim = 653
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 5+5;-1
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1 ;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 30,-95
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261



[State 0, CtrlSet]
type = CtrlSet
trigger1 =  animelem = 13
value = 1
;ignorehitpause =
;persistent =



[State 200, 1];
type = PlaySnd
trigger1 = animelem = 4
trigger2 = animelem = 9
value = 8000, 18;3

[State 200, 1];
type = PlaySnd
trigger1 = animelem = 3
trigger2 = animelem = 8
value = 500,3


;-------------【添加 helper】 ------------飞行道具  地面波------

[Statedef 8650]
type = S
ctrl = 0
anim = 9998
velset = 0,0
movetype = A
physics = N
sprpriority = 1

[State 0, PosSet]
type = PosSet
trigger1 = pos y != 0
y = 0
ignorehitpause = 1


[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = angledraw
trigger1 = 1
scale = 2,2;0.75,0.75


;-----------------------ADD        刀光
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 8657         ;
pos = 20,0
scale = 0.4,0.3
postype = P1
ownpal = 1
id = 8657            ;
bindtime = 1
sprpriority = 3
;removetime = 30
velocity = 8.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        刀光
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 18657         ;
pos = -20,0
scale = 0.5,0.25
postype = P1
ownpal = 1
id = 18657            ;
bindtime = 1
sprpriority = 5
;removetime = 30
velocity = 8.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



;-----------------------ADD        刀光  黑影
[State 2001]
type = Explod
trigger1 =  0
trigger1 = time = 1
anim = 8658         ;
pos = 20,0
scale = 0.4,0.3
postype = P1
ownpal = 1
id = 8658             ;
bindtime = 1
sprpriority = 2
;removetime = 30
velocity = 8.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        刀光  黑影
[State 2001]
type = Explod
trigger1 =  1
trigger1 = time = 1
anim = 8658         ;
pos = 21,0
scale = 0.5,0.25
postype = P1
ownpal = 1
id = 8658             ;
bindtime = 1
sprpriority = -2
;removetime = 30
velocity = 8.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        刀光  黑影   圆黑底
[State 2001]
type = Explod
trigger1 = time = 1
anim = 8656         ;
pos = -45,2
scale = 0.8,0.3
postype = P1
ownpal = 1
id = 8656             ;
bindtime = 1
sprpriority = 2
;removetime = 30
velocity = 8.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0






;-----------------------ADD        尘土
[State 2001]
type = Explod
trigger1 = root,stateno = 650
trigger1 = root,time < 25
trigger1 = time = 1
anim = 8653        ;
pos = 55,10
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8653             ;
bindtime = 1
sprpriority = 5
;removetime = 30
;velocity = 7,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD       尘土    黑影
[State 2001]
type = Explod
trigger1 = root,stateno = 650
trigger1 = root,time < 25
trigger1 = time = 1
anim = 8654         ;
pos = 55,11
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8654             ;
bindtime = 1
sprpriority = 4
;removetime = 30
;velocity = 7,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0




[State 620, Projectile]                  ;因为是helper 所以要用root              f 8650
type = Projectile
trigger1 = root,fvar(22)< 5
trigger1 = time = 1 ;- 1*(fvar(22)>=4 )
attr = S, NP
damage = (12+8*(root,stateno = 650)+2*(root,fvar(22)) )*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),9+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 20+2*fvar(22),20
pausetime = 2,13 + ceil(0.5*fvar(22))       -3*(root,var(47)<-900) -6*(root,var(47)<-1200) ;修复重力保护
sparkno =  s-1
sparkxy = 50+random%20 ,-30-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 + ceil(0.5*root,fvar(22))-4*(root,var(47)<-600) -6*(root,var(47)<-900) -8*(root,var(47)<-1200)
ground.hittime  = 19 + ceil(0.5*root,fvar(22))-4*(root,var(47)<-600) -6*(root,var(47)<-900) -8*(root,var(47)<-1200)
guard.hittime = 17+ ceil(0.5*root,fvar(22))
guard.slidetime = 17 + ceil(0.5*root,fvar(22))

ground.velocity = -4.7
guard.velocity = -3.7
air.velocity = -1.1,-4.5 -1   +1*(root,var(47)<-600) +2*(root,var(47)<-900) +4*(root,var(47)<-1200) ;修复重力保护
air.fall = 1
fall.recovertime = 80
ID = 8659
nochainID = 9999
yaccel = 0.450
forcestand = 1
;-----------color change-------------
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 8659
projanim = 8659
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 62;46
velocity = 8.1,0;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0.03,-0.11                                 ; 弹道
remvelocity = 0,0
projhits = 2
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 0,0
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;---------------------------
envshake.time = 9
envshake.ampl = 4
envshake.freq = 50
;p2stateno = 3261



[State 620, Projectile]                  ;因为是helper 所以要用root
type = Projectile
trigger1 = root,fvar(22)>=5
trigger1 = time = 1 ;- 1*(fvar(22)>=4 )
attr = S, NP
damage = (12+8*(root,stateno = 650)+2*(root,fvar(22)) )*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),9+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = L
getpower = 20+2*fvar(22),20
pausetime = 2,13  + ceil(0.5*fvar(22))          -3*(root,var(47)<-900) -6*(root,var(47)<-1200) ;修复重力保护
sparkno =  s-1
sparkxy = 50+random%20 ,-30-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 + ceil(0.5*root,fvar(22))-4*(root,var(47)<-600) -6*(root,var(47)<-900) -8*(root,var(47)<-1200)
ground.hittime  = 19 + ceil(0.5*root,fvar(22))-4*(root,var(47)<-600) -6*(root,var(47)<-900) -8*(root,var(47)<-1200)
guard.hittime = 17+ ceil(0.5*root,fvar(22))
guard.slidetime = 17 + ceil(0.5*root,fvar(22))

ground.velocity = -4.7
guard.velocity = -3.7
air.velocity = -1.1,-4.5 -1    +1*(root,var(47)<-600) +2*(root,var(47)<-900) +4*(root,var(47)<-1200) ;修复重力保护
air.fall = 1
fall.recovertime = 80
ID = 8659
nochainID = 9999
yaccel = 0.450
forcestand = 1
;-----------color change-------------
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 8659
projanim = 8659
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 62;46
velocity = 8.1,0;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0.03,-0.11                                 ; 弹道
remvelocity = 0,0
projhits = 2
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 0,0
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;---------------------------
envshake.time = 9
envshake.ampl = 4
envshake.freq = 50
;p2stateno = 3261





;---------------------[火花]
[state a];
type = Helper
;Trigger1 = ProjHit8669 = 1
Trigger1 = 1
Trigger1 = root,ProjHit8669 = 1
id = 7001
;name = "hit"
pos = -10+random%20,-55-random%30
postype = p2
stateno = 7001
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 99999
supermovetime = 99999
persistent = 0
ignorehitpause = 1
keyctrl = 0


;---------------------[]
[state destroyself]
type = destroyself
trigger1 = time >= 90;   30    +  60 ;10

trigger2 =  root,stateno != 650
trigger2 = time > 3



;-------------【添加 helper】 ------------飞行道具  空中波------

[Statedef 8660]
type = A
ctrl = 0
anim = 9998
velset = 0,0
movetype = A
physics = N
sprpriority = 1

[State 0, PosSet]
type = PosSet
trigger1 =0
trigger1 = pos y != 0
y = 0
ignorehitpause = 1


[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = angledraw
trigger1 = 1
scale = 0.5,0.5;2,2


;-----------------------ADD        刀光
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 8667         ;
pos = 20,0
scale = 0.5,0.4
postype = P1
ownpal = 1
id = 8657            ;
bindtime = 1
sprpriority = 3
;removetime = 30
velocity = 8.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



;-----------------------ADD        刀光  黑影
[State 2001]
type = Explod
trigger1 =  1
trigger1 = time = 1
anim = 8668         ;
pos = 25,-10
scale = 0.25,0.35
postype = P1
ownpal = 1
id = 8658             ;
bindtime = 1
sprpriority = -2
;removetime = 30
velocity = 8.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



[State 620, Projectile]                  ;因为是helper 所以要用root                  f 8660
type = Projectile
trigger1 = root,fvar(22) < 5
trigger1 = time = 1 ;- 1*(fvar(22)>=4 )
attr = A, NP
damage = (12+8*(root,stateno = 650)+2*(root,fvar(22)) )*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),9+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 20+2*fvar(22),20
pausetime = 2,13  + ceil(0.5*fvar(22))     -3*(root,var(47)<-900) -6*(root,var(47)<-1200) ;修复重力保护
sparkno =  s-1;s7002
sparkxy =  50+random%20 ,-60-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 + ceil(0.5*root,fvar(22))-4*(root,var(47)<-600) -6*(root,var(47)<-900) -8*(root,var(47)<-1200)
ground.hittime  = 19 + ceil(0.5*root,fvar(22))-4*(root,var(47)<-600) -6*(root,var(47)<-900) -8*(root,var(47)<-1200)
guard.hittime = 17+ ceil(0.5*root,fvar(22))
guard.slidetime = 17 + ceil(0.5*root,fvar(22))

ground.velocity = -4.7
guard.velocity = -3.7
air.velocity = -1.1,-4.5   +1*(root,var(47)<-600) +2*(root,var(47)<-900) +4*(root,var(47)<-1200) ;修复重力保护
air.fall = 1
fall.recovertime = 80
ID = 8669
nochainID = 9999
yaccel = 0.45
forcestand = 1
;-----------color change-------------
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 8669
projanim = 8669
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 48;46
velocity = 8.1,0;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0.03,-0.11                                 ; 弹道
remvelocity = 0,0
projhits = 2    -1*(fvar(19)>0  )
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 20,10
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;---------------------------
envshake.time = 9
envshake.ampl = 4
envshake.freq = 50
;p2stateno = 3261



[State 620, Projectile]                  ;因为是helper 所以要用root                  f 8660
type = Projectile
trigger1 = root,fvar(22) >= 5
trigger1 = time = 1 ;- 1*(fvar(22)>=4 )
attr = A, NP
damage = (12+8*(root,stateno = 650)+2*(root,fvar(22)) )*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),9+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = M
getpower = 20+2*fvar(22),20
pausetime = 2,13  + ceil(0.5*fvar(22))          -3*(root,var(47)<-900) -6*(root,var(47)<-1200) ;修复重力保护
sparkno =  s-1;s7002
sparkxy =  50+random%20 ,-60-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 + ceil(0.5*root,fvar(22))-2*(root,var(47)<-600) -4*(root,var(47)<-900) -8*(root,var(47)<-1200)
ground.hittime  = 19 + ceil(0.5*root,fvar(22))-2*(root,var(47)<-600) -4*(root,var(47)<-900) -8*(root,var(47)<-1200)
guard.hittime = 17+ ceil(0.5*root,fvar(22))
guard.slidetime = 17 + ceil(0.5*root,fvar(22))

ground.velocity = -4.7
guard.velocity = -3.7
air.velocity = -1.1,-4.5   +1*(root,var(47)<-600) +2*(root,var(47)<-900) +4*(root,var(47)<-1200) ;修复重力保护
air.fall = 1
fall.recovertime = 80
ID = 8669
nochainID = 9999
yaccel = 0.45
forcestand = 1
;-----------color change-------------
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 8669
projanim = 8669
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 48;46
velocity = 8.1,0;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0.03,-0.11                                 ; 弹道
remvelocity = 0,0
projhits = 2    -1*(fvar(19)>0  )
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 20,10
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;---------------------------
envshake.time = 9
envshake.ampl = 4
envshake.freq = 50
;p2stateno = 3261



;---------------------[火花]
[state a];
type = Helper
;Trigger1 = ProjHit8669 = 1
Trigger1 = 1
Trigger1 = root,ProjHit8669 = 1
id = 7001
;name = "hit"
pos = -10+random%20,-55-random%30
postype = p2
stateno = 7001
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 99999
supermovetime = 99999
persistent = 0
ignorehitpause = 1
keyctrl = 0



;---------------------[]
[state destroyself]
type = destroyself
trigger1 = time >= 90;   30    +  60 ;10

trigger2 =  root,stateno != 650
trigger2 = time > 3

;-------------【添加 helper】 ------------飞行道具  地面波------   狂三专用

[Statedef 8670]
type = S
ctrl = 0
anim = 9998
velset = 0,0
movetype = A
physics = N
sprpriority = 1

[State 0, PosSet]
type = PosSet
trigger1 = pos y != 0
y = 0
ignorehitpause = 1


[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = angledraw
trigger1 = 1
scale = 2,2;0.75,0.75


;-----------------------ADD        刀光
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 8657         ;
pos = 20,0
scale = 0.5,0.4
postype = P1
ownpal = 1
id = 8657            ;
bindtime = 1
sprpriority = 3
;removetime = 30
velocity = 8,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        刀光
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 18657         ;
pos = -20,0
scale = 0.6,0.3
postype = P1
ownpal = 1
id = 18657            ;
bindtime = 1
sprpriority = 5
;removetime = 30
velocity = 8,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



;-----------------------ADD        刀光  黑影
[State 2001]
type = Explod
trigger1 =  1
trigger1 = time = 1
anim = 8658         ;
pos = 20,0
scale = 0.5,0.4
postype = P1
ownpal = 1
id = 8658             ;
bindtime = 1
sprpriority = 2
;removetime = 30
velocity = 8,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        刀光  黑影
[State 2001]
type = Explod
trigger1 =  1
trigger1 = time = 1
anim = 8658         ;
pos = 21,0
scale = 0.5,0.3
postype = P1
ownpal = 1
id = 8658             ;
bindtime = 1
sprpriority = -2
;removetime = 30
velocity = 8,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        刀光  黑影   圆黑底
[State 2001]
type = Explod
trigger1 = 0
trigger1 = time = 1
anim = 8656         ;
pos = -45,2
scale = 0.8,0.3
postype = P1
ownpal = 1
id = 8656             ;
bindtime = 1
sprpriority = 2
;removetime = 30
velocity = 8,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0






;-----------------------ADD        尘土
[State 2001]
type = Explod
;trigger1 = root,numexplod(8653)=0
;trigger1 = root,stateno = 650
;trigger1 = root,time < 25
trigger1 = time = 1
anim = 8653        ;
pos = 55,10
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8653             ;
bindtime = 1
sprpriority = 5
;removetime = 30
;velocity = 7,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD       尘土    黑影
[State 2001]
type = Explod
;trigger1 = root,numexplod(8654)=0
;trigger1 = root,stateno = 650
;trigger1 = root,time < 25
trigger1 = time = 1
anim = 8654         ;
pos = 55,11
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8654             ;
bindtime = 1
sprpriority = 4
;removetime = 30
;velocity = 7,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0




[State 620, Projectile]                  ;因为是helper 所以要用root
type = Projectile
trigger1 = time = 1 ;- 1*(fvar(22)>=4 )
attr = A, NP
damage = (8+16*(root,stateno = 650)+2*(root,fvar(22)) )*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = -1;MA
getpower = 50+5*fvar(22),30
pausetime = 2,12
sparkno =  s-1
sparkxy =  50+random%20 ,-30-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 20+ ceil(0.5*root,fvar(22))
ground.hittime  =  20+ ceil(0.5*root,fvar(22))
guard.hittime = 18 + root,fvar(22)
guard.slidetime = 18 + root,fvar(22)

ground.velocity = -4.7
guard.velocity = -3.7
air.velocity = -1.1,-4.7  ;-4.5
air.fall = 1
fall.recovertime = 80
ID = 8679
nochainID = 9999
yaccel = 0.450
kill = 0
;-----------color change-------------
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 8679
projanim = 8659
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 48;46
velocity = 8,0;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0.03,-0.11                                 ; 弹道
remvelocity = 0,0
projhits = 2
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 0,0
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
.;---------------------------
envshake.time = 12
envshake.ampl = 5
envshake.freq = 60
;p2stateno = 2406



;------------------------------------------------------------


;---------------------[]
[state destroyself]
type = destroyself
trigger1 = time >= 30



;---------------------------------------------------------------------------
;相位转换       700改;用于狂中
[Statedef 707]
type = S      ;S/C/A/L  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｌ：ダウン
movetype = I   ; Ｉ：通常状B/Ａ：攻淖B/Ｈ：ダメ`ジをくらってる状B
physics = N   ;S/C/A/N  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｎ：oし
poweradd= 0
ctrl = 0
anim = 700
velset = 0,0
sprpriority = 2


;====================================== 与【擦弹】有关 ==========================================
[State -2]                              ; var 43 = 霸体时间
type = Varset
trigger1 = var(43) = 0
trigger1 = time > 1    &&    animtime <= (-6 +3*(fvar(22)>=5))          ;   【设置】此技能的擦弹时间，
var(43) = 1
IgnoreHitPause = 1
persistent = 1


[State -2]                              ; [[345相杀]]  帮助物体
Type = Helper
;trigger1 = var(42) > 0                 ; 霸体层数 > 0
Trigger1 = Numhelper(6345) = 0
trigger1 = time > 1    &&    animtime <= (-6 +3*(fvar(22)>=5))          ;   【设置】此技能的擦弹时间，
StateNo = 6345
ID = 6345
name = "cadan"
PosType = P1
Pos = 0,0
Ownpal = 1
SprPriority = 2
IgnoreHitPause = 1
Persistent = 0
SuperMoveTime = 999999999
PauseMoveTime = 999999999


[State -2]                           ;var 20相杀  帮助物体  ,超过次时间 则相杀无效
type = Varset
trigger1 = var(43) > 0
trigger1 = animtime > -6 +3*(fvar(22)>=5)         ;   【设置】此技能的擦弹时间
var(43) = 0
IgnoreHitPause = 1
persistent = 1
;====================================== 与【擦弹】有关 END ==========================================


[State 5210, green]
type = PalFX
trigger1 = time <= 15
trigger1 = time%2 = 0
time = 1
add = 222,12,222


[State 700, 5100]
type = SelfState
;trigger1 = 1
trigger1 = time = 0 ;2
trigger1 = !Alive
value = 5100           ;   5150



[State 6000, SuperPause]
type = SuperPause
trigger1 =  time = 1
time = 24
movetime = 24
anim = -1
sound = s8000, 22
darken = 120
persistent = 0


;-----------------------ADD            破盾
[State 2001]
type = Explod
trigger1 = time = 1
anim = 8750         ;
pos = 8,-85
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8750               ;
bindtime = 1
sprpriority = 4
ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD           白圈
[State 2001]
type = Explod
trigger1 = time = 1
anim = 8751         ;
pos = 8,-85
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8751               ;
bindtime = 1
sprpriority = 3
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD           白圈
[State 2001]
type = Explod
trigger1 = time = 1+1
anim = 8751         ;
pos = 8,-85
scale = 0.9,0.9
postype = P1
ownpal = 1
id = 8751               ;
bindtime = 1
sprpriority = 3
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0



;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = time = 1
anim = 8233       ;
pos = 0,-70
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = -1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


[state a]
type = angledraw
trigger1 = 0
scale = 0.8 + 0.02*(random%(60-time)), 0.8 + 0.02*(random%(60-time))


[state a]
type = posset
trigger1 = time = 0
y = 0

[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22)=1
trigger1 = animelemtime(8) < 0
value = ,AA,AP
time = fvar(22)            +2*(var(59)>0 && fvar(22)>=5)


[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22) >= 3
trigger1 = animelemtime(8) < 0
value = SCA
time = fvar(22)              +2*(var(59)>0 && fvar(22)>=5)

[state a]
type = playerpush
trigger1 = animelem = 9,<=0
value = 0


[State 600, 1];
type = PlaySnd
trigger1 = Time = 1
value = 8000, 5




[State 600, 1]
type = velset
trigger1 = animelem = 1
x = 5

[State 600, 1]
type = velset
trigger1 = animelem = 2
x = 15    ;15

[State 600, 1]
type = velmul
trigger1 = animelem = 3,>0
trigger1 = vel x != [-0.5,0.5]
x =0.9-0.05*((enemynear,pos x - pos x)*facing < 50)-0.05*((enemynear,pos x - pos x)*facing <100)-0.1*( (enemynear,pos x - pos x)*facing  < 0 && fvar(22)>=5)-0.1*(fvar(19)=1 && numhelper(2350)>0 )

[State 600, 1]
type = velset
trigger1 = animelem = 9
x = 0

[State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 32
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1


[State 200, 7]
type = ChangeState
;trigger1 = anim = 700
trigger1 = AnimTime = 0
value = 0
ctrl = 1
IgnoreHitPause = 1



;---------------------------------------------------------------------------
;相位转换
[Statedef 700]
type = S      ;S/C/A/L  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｌ：ダウン
movetype = I   ; Ｉ：通常状B/Ａ：攻淖B/Ｈ：ダメ`ジをくらってる状B
physics = N   ;S/C/A/N  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｎ：oし
poweradd= 0
ctrl = 0
anim = 700
velset = 0,0
sprpriority = 2



[State 5210, green]
type = PalFX
trigger1 = time <= 15
trigger1 = time%2 = 0
time = 1
add = 222,12,222


[State 700, 5100]
type = SelfState
trigger1 = time = 2
trigger1 = !Alive
value = 5100           ;   5150


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = animelem = 1
anim = 8234       ;
pos = 0,-65
scale = 1,1
postype = P1
ownpal = 1
id = 8234          ;
bindtime = -1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


[state a]
type = angledraw
trigger1 = 0
scale = 0.8 + 0.02*(random%(60-time)), 0.8 + 0.02*(random%(60-time))


[state a]
type = posset
trigger1 = time = 0
y = 0

[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22)=1
trigger1 = animtime < -6
value = ,AA,AP
time = fvar(22)


[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22) >= 3
trigger1 = animtime < -6
value = SCA
time = fvar(22) ;+2*(((helper(32000),var(36)=0 && fvar(22)>=5) || (prevstateno=750))&&life>2 )   ;本动作为 37 但是相反


;-------------------------------------------------
[State -2]                      ;盾防    防御性能
type = HitOverride
triggerall = 1                           ; on/off
Triggerall = fvar(22)>=5
Triggerall = palno = [10,12]        ;最高时允许
triggerall = var(59) > 0                 ; ai
triggerall =  !ishelper && alive && RoundState = 2
;triggerall =  !Enemy,HitDefAttr = SCA,AT
;triggerall = helper(32000),var(39)=0  ||     helper(32000),var(38)=0   ;cooldown
;triggerall =  time > 2
Trigger1 = animtime >= -2
Trigger1 = life > 2

attr = SCA,AA,AP;,AT
stateno = 1701    ;  + (750-1701)*(power >= 1000 && random < 25)        ;防止无限循环
time = 1
IgnoreHitPause = 1
persistent = 1
;-----------------------------------------------------------------------------------------------------------------


[state a]
type = playerpush
trigger1 = animelem = 9,<=0
value = 0


[State 600, 1];
type = PlaySnd
trigger1 = Time = 1
value = 8000, 5




[State 600, 1]
type = velset
trigger1 = animelem = 1
x = 5

[State 600, 1]
type = velset
trigger1 = animelem = 2
x = 12             + ceil(0.5*fvar(22))      -2

[State 600, 1]
type = velmul
trigger1 = animelem = 3,>0
trigger1 = vel x != [-1.1,1.1]
x = 0.9 -0.03*((enemynear,pos x - pos x)*facing < 0)-0.01*( (enemynear,pos x - pos x)*facing  < 0 && fvar(22)>=5)-0.2*(fvar(19)=1 && numhelper(2350)>0 )

[State 600, 1]
type = velset
trigger1 = animelem = 9
x = 0

[State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 32
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1


[State 200, 7]
type = ChangeState
;trigger1 = anim = 700
trigger1 = AnimTime = 0
value = 0
ctrl = 1
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;相位转换                               ;向后
[Statedef 701]
type = S     ; S/C/A/L  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｌ：ダウン
movetype = I  ;  Ｉ：通常状B/Ａ：攻淖B/Ｈ：ダメ`ジをくらってる状B
physics = N   ;S/C/A/N  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｎ：oし
poweradd= 0
ctrl = 0
anim = 701
velset = 0,0
sprpriority = 2




[State 5210, green]
type = PalFX
trigger1 = time <= 15
trigger1 = time%2 = 0
time = 1
add = 222,12,222


[State 700, 5100]
type = SelfState
trigger1 = time = 2
trigger1 = !Alive
value = 5100           ;   5150

;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = animelem = 1
anim = 8234      ;
pos = 0,-65
scale = 1,1
postype = P1
ownpal = 1
id = 8234           ;
bindtime = -1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


[state a]
type = posset
trigger1 = time = 0
y = 0

[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22)=1
trigger1 = animtime < -6
value = ,AA,AP
time = fvar(22)


[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22) >= 3
trigger1 = animtime < -6
value = SCA
time = fvar(22) ;+2*(((helper(32000),var(37)=0 && fvar(22)>=5) || (prevstateno=750))&&life>2 )    ;本动作为 36 但是相反


;-------------------------------------------------
[State -2]                      ;盾防    防御性能
type = HitOverride
triggerall = 1                           ; on/off
Triggerall = fvar(22)>=5
Triggerall = palno = [10,12]        ;最高时允许
triggerall = var(59) > 0                 ; ai
triggerall =  !ishelper && alive && RoundState = 2
;triggerall =  !Enemy,HitDefAttr = SCA,AT
;triggerall = helper(32000),var(39)=0  ||     helper(32000),var(38)=0   ;cooldown
;triggerall =  time > 2
Trigger1 = animtime >= -2
Trigger1 = life > 2

attr = SCA,AA,AP;,AT
stateno = 1701    ;  + (750-1701)*(power >= 1000 && random < 25)        ;防止无限循环
time = 1
IgnoreHitPause = 1
persistent = 1
;-----------------------------------------------------------------------------------------------------------------



[state a]
type = playerpush
trigger1 = animelem = 9,<=0
value = 0


[State 600, 1];
type = PlaySnd
trigger1 = Time = 1
value = 8000, 5



[State 600, 1]
type = velset
trigger1 = animelem = 1
x = -4

[State 600, 1]
type = velset
trigger1 = animelem = 2
x = -8        - ceil(0.5*fvar(22))                +2

[State 600, 1]
type = velmul
trigger1 = animelem = 3,>0
trigger1 = vel x != [-0.8,0.8]
x = 0.9  -0.03*(   (  (enemynear,pos x - pos x)*facing  )     < 0)

[State 600, 1]
type = velset
trigger1 = animelem = 9
x = 0

[State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 32
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1


[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
IgnoreHitPause = 1




;---------------------------------------------------------------------------
;相位转换
[Statedef 710]
type = A    ;  S/C/A/L  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｌ：ダウン
movetype = I   ; Ｉ：通常状B/Ａ：攻淖B/Ｈ：ダメ`ジをくらってる状B
physics = N  ;  S/C/A/N  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｎ：oし
poweradd= 0
ctrl = 0
anim = 710
velset = 0,0
sprpriority = 2


[State 5210, green]
type = PalFX
trigger1 = 1
trigger1 = time <= 15
trigger1 = time%2 = 0
time = 1
add = 222,12,222


[State 820, 1]
type = SelfState
trigger1 = time = 2
;trigger1 = Animelemtime(2)>=0
trigger1 = !Alive
value = 5050           ;   5150
ignorehitpause=1


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = animelem = 1
anim = 8234      ;
pos = 0,-65
scale = 1,1
postype = P1
ownpal = 1
id = 8234          ;
bindtime = -1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22)=1
trigger1 = animtime < -6
value = ,AA,AP
time = fvar(22)     +3*(var(59)>0 && fvar(22)>=5)


[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22) >= 3
trigger1 = animtime < -6
value = SCA
time = fvar(22)    +3*(var(59)>0 && fvar(22)>=5)

[state a]
type = playerpush
trigger1 = animelem = 9,<=0
value = 0


[State 600, 1];
type = PlaySnd
trigger1 = Time = 1
value = 40, 2



[State 600, 1]
type = velset
trigger1 = animelem = 1
y = (-0.04)*pos y


[state a]
type = posset
trigger1 = animelem = 8
y = 0

[State 600, 1]
type = velset
trigger1 = animelem = 8
Y = 0


[State 600, 1]
type = veladd
trigger1 = animelem = 1
x = 6 +2
y = -4

[State 600, 1]
type = veladd
trigger1 = time > 2
y = 0.5


[State 600, 1]
type = velmul
trigger1 = animelem = 2,>0
trigger1 = vel x != [-0.5,0.5]
x = 0.95



[State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 26
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1


[State 200, 7]
type = ChangeState
trigger1 = pos y > 0
trigger1 = vel y > 0
value = 52
ctrl = 0
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;相位转换                              ;向后
[Statedef 711]
type = A    ; S/C/A/L  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｌ：ダウン
movetype = I  ;  Ｉ：通常状B/Ａ：攻淖B/Ｈ：ダメ`ジをくらってる状B
physics = N   ;S/C/A/N  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｎ：oし
poweradd= 0
ctrl = 0
anim = 711
velset = 0,0
sprpriority = 2




[State 5210, green]
type = PalFX
trigger1 = time <= 15
trigger1 = time%2 = 0
time = 1
add = 222,12,222

[State 820, 1]
type = SelfState
trigger1 = time = 2
;trigger1 = Animelemtime(2)>=0
trigger1 = !Alive
value = 5050           ;   5150
ignorehitpause=1


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = animelem = 1
anim = 8234      ;
pos = 0,-65
scale = 1,1
postype = P1
ownpal = 1
id = 8234          ;
bindtime = -1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22)=1
trigger1 = animtime < -6
value = ,AA,AP
time = fvar(22)     +3*(var(59)>0 && fvar(22)>=5)


[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = fvar(22) >= 3
trigger1 = animtime < -6
value = SCA
time = fvar(22)    +3*(var(59)>0 && fvar(22)>=5)

[state a]
type = playerpush
trigger1 = animelem = 9,<=0
value = 0


[State 600, 1];
type = PlaySnd
trigger1 = Time = 1
value = 40, 2



[State 600, 1]
type = velset
trigger1 = animelem = 1
y = (-0.04)*pos y


[state a]
type = posset
trigger1 = animelem = 8
y = 0

[State 600, 1]
type = velset
trigger1 = animelem = 8
Y = 0


[State 600, 1]
type = veladd
trigger1 = animelem = 1
x = -6 -2
y = -4

[State 600, 1]
type = veladd
trigger1 = time > 2
y = 0.5


[State 600, 1]
type = velmul
trigger1 = animelem = 2,>0
trigger1 = vel x != [-0.5,0.5]
x = 0.95



[State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 26
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1


[State 200, 7]
type = ChangeState
trigger1 = pos y > 0
trigger1 = vel y > 0
value = 52
ctrl = 0
IgnoreHitPause = 1



;---------------------------------------------------------------------------
; 防御中 自身破防
[Statedef 750]
type = S      ;S/C/A/L  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｌ：ダウン
movetype = I   ; Ｉ：通常状B/Ａ：攻淖B/Ｈ：ダメ`ジをくらってる状B
physics = N   ;S/C/A/N  Ｓ：立ち/Ｃ：屈み/Ａ：空中/Ｎ：oし
poweradd= 0
ctrl = 0
anim = 750
velset = 0,0
sprpriority = 5


[State 0, Turn]
type = Turn
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0


[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  time = 1
value = 9750,0 +(Random%2)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0


[state a]
type = posset
trigger1 = time = 0
y = 0


[State 6000, SuperPause]
type = SuperPause
trigger1 =  time = 1
time = 28
movetime = 28
anim = -1
sound = -1 ;s8000,31  ;-1 ;
darken = 120
persistent = 0


;-----------------------ADD     紫圈
[State 2001]
type = Explod
trigger1 = time = 1
anim = 6349              ;
pos = -5+ random%10,-85+ random%10
scale = 0.35,0.35
postype = P1
ownpal = 1
id = 6349                 ;
bindtime = 1
sprpriority = 3
;accel = 0.2,0
;vel = 2.2,0
;ontop = 1
supermovetime = 99999
pausemovetime = 99999
removeongethit = 1
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD            破盾
[State 2001]
type = Explod
trigger1 = time = 1
anim = 8750         ;
pos = 8,-85
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8750               ;
bindtime = 1
sprpriority = 4
ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD           白圈
[State 2001]
type = Explod
trigger1 = time = 1
anim = 8751         ;
pos = 8,-85
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8751               ;
bindtime = 1
sprpriority = 3
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD           白圈
[State 2001]
type = Explod
trigger1 = time = 1+1
anim = 8751         ;
pos = 8,-85
scale = 0.9,0.9
postype = P1
ownpal = 1
id = 8751               ;
bindtime = 1
sprpriority = 3
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0



[State 1];o长巫Bを作る
type = NotHitBy
trigger1 = animelemtime(4) < 1
value = SCA
time = 1+ceil(0.5*fvar(22)   )



[State 600, 1];
type = PlaySnd
trigger1 = Time = 1
value = 8000, 22



[State 600, 1]
type = velset
trigger1 = animelem = 1
x = -0.5
ignorehitpause = 1

[State 600, 1]
type = velset
trigger1 = animelem = 4
x = 0
ignorehitpause = 1



[State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 36
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1


[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
IgnoreHitPause = 1


;------------------------------------------------------------------
;=====================790 添加脱离 ==================
[Statedef 790]
type = A
movetype = A
physics = N
velset = 0,-0.5
ctrl = 0
anim = 790
PowerAdd = 0
sprpriority = 2
;facep2 = 1

;====================================== 与【擦弹】有关 ==========================================
[State -2]                              ; var 43 = 霸体时间
type = Varset
triggerall = 1
trigger1 = var(43) = 0
trigger1 = time = [2,24]         ;   【设置】此技能的擦弹时间，
var(43) = 1
IgnoreHitPause = 1
persistent = 1


[State -2]                              ; [[345相杀]]  帮助物体
Type = Helper
triggerall = 1
Trigger1 = Numhelper(6345) = 0
trigger1 = time = [2,24]           ;   【设置】此技能的擦弹时间，
StateNo = 6345
ID = 6345
name = "cadan"
PosType = P1
Pos = 0,0
Ownpal = 1
SprPriority = 2
IgnoreHitPause = 1
Persistent = 0
SuperMoveTime = 999999999
PauseMoveTime = 999999999


[State -2]                           ;var 20相杀  帮助物体  ,超过次时间 则相杀无效
type = Varset
triggerall = 1
trigger1 = var(43) > 0
trigger1 = time > 24        ;   【设置】此技能的擦弹时间
var(43) = 0
IgnoreHitPause = 1
persistent = 1
;====================================== 与【擦弹】有关 END ==========================================


;---------------------[火花]
[state a];
type = Helper
;Trigger1 = ProjHit8669 = 1
Trigger1 = 1
Trigger1 = animelemtime(3)> 0    &&    animelemtime(6)< 0
Trigger1 = enemynear,movetype = H
Trigger1 = p2dist x =[-95,95]
id = 7005
;name = "hit"
pos = floor(p2dist x/2 +25) +(random % 10) , floor(p2dist y/2 -65) -(random % 20)
postype = p1
stateno = 7005
bindtime = 1
ownpal = 1
helpertype = normal
pausemovetime = 99999
supermovetime = 99999
persistent = 0
ignorehitpause = 1
keyctrl = 0


[state a]
type = lifeadd
triggerall = 1
trigger1= fvar(22)>=5
trigger1= animelemtime(3) = 0
value = 0.05*lifemax  ; -0.005
;absolute = 1
;kill = 0
ignorehitpause=1
persistent = 0



[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 1
edge = 1,1

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 6
edge = 19,19


[State 0, PlayerPush]
type = PlayerPush
trigger1 = animelem = 1
value = 0
;ignorehitpause =
;persistent =


[State 0, PlayerPush]
type = PlayerPush
trigger1 = animelem = 6
value = 1
;ignorehitpause =
;persistent =


;-----------------------ADD        脱离brust
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 3
anim = 8790     ;
pos = 0,-60
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8790          ;
bindtime = -1
sprpriority = 4
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 3
anim = 8233       ;
pos = 0,-60
;scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 8
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



[State 790, 1]
type = Turn
trigger1 = time = 0
trigger1 = facing =  EnemyNear(var(55)),facing
trigger1 = (  (EnemyNear(var(55)),pos x - pos x)*facing  )     < 0



[State 310, ReversalDef]          ;f 790
type = ReversalDef
trigger1 = 1
trigger1 =(enemynear,pos x - pos x)*facing - const(size.ground.front)- enemynear,const(size.ground.front) = [-45,45]
trigger1 = p2bodydist y = [-75,75]
trigger1 = animelemtime(3) > 0  && animelemtime(6) < 0
pausetime = 1,0  ;自己的停顿，对方的停顿    ；------------------------0,0
hitflag = M-                        ;宁可自己多停顿 ，别对方多停
hitsound = s122,0
;attr = S, SA
;reversal.attr = SCA, AA,AP,AT     ; ------------------778899
reversal.attr = SCA, AA,AT     ; ------------------778899
numhits = 0
getpower = 100
ignorehitpause = 1
persistent = 0
;      p1stateno = 215
p2stateno = 3211  +2  ; 浮空







[State 230, Projectile]               ;
type = Projectile
trigger1 = 1
trigger1 =  animelem = 3 || animelem = 4 || animelem = 5;3     ;3
attr = A, NP
damage = (5+12*fvar(22))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 50+5*fvar(22),30
pausetime = 1,8
sparkno = s-1
sparkxy = 5+(random%15),-65 +(random%15)
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -24+48*((  (enemynear,pos x - pos x)*facing  )  < 0),-7.5 -0.1*ceil(fvar(22)) ;-1*( enemynear,pos Y > -25)
air.velocity = -24+48*((  (enemynear,pos x - pos x)*facing  )     < 0),-6.5 -0.1*ceil(fvar(22)) ;-1*( enemynear,pos Y > -25)
fall = 1
air.fall = 1
fall.recovertime = 80
ID = 793
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -5
yaccel = .40
;-----------color change-------------
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 793
projanim = 793
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 4;-1
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 0,0
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261


[State 2000, KEZ~]
type = SuperPause
trigger1 = time = 2
poweradd = 0; -1000
anim = -1
time = 10
movetime = 10


[State 2000, c]
type = AfterImage
trigger1 = time = 0
time = 60
trans = add1
;framegap = 5
length = 10
palbright = 8,8,8
palcontrast = 100,100,100
palpostbright = 0,0,0
paladd = 0,0,0
palmul = 1,1,1

[state a]
type = envshake
trigger1 = animelem = 3
time = 10
freq = 60
ampl = -4





[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 6
statetype = A       ;S,A,C,L
movetype = I        ;I,A,H
physics = A         ;A,C,S,N
ignorehitpause = 1
;persistent =



[state vel]
type = posadd                       ;pos
trigger1 = time = 0
y = -5



[state vel]                        ;纵向
type = velset
trigger1 = time = 0
y = -0.5

[state vel]                        ;纵向
type = velset
trigger1 = animelem = 3
y = 0


[state veladd]                    ;纵向add
type = veladd
trigger1 = animelemtime(6) >0
y = 0.2


[state a]                      ;防止缓慢飘落
type = veladd
trigger1 = time > 60
y = 0.5 +0.5*(time > 90)

[State 200]                   ;播放音效    金属爆破音
type = PlaySnd
trigger1 = animelem = 3
value = s8000,121



[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 2
value = 9100,3     ;
;voulme = 440
channel = 0
lowpriority = 1

;---------------------[G]
[State 1200, 无敌]
type = NotHitBy
trigger1 = AnimElemtime(6) <= 2
value = SCA
time = 1
IgnoreHitPause = 1


[State 1150]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
trigger2 = time > 300
value = 52
ctrl = 0
IgnoreHitPause = 1




;---------------------------------------------------------------------------
;               投技      改为 移动投
[Statedef 1800]
type    = S
movetype= A
physics = N
juggle  = 0
velset = 2,0
poweradd= 20*fvar(22)
ctrl = 0
anim = 1800
sprpriority = 1


[State 0, Turn]         ;自动转身
type = Turn
trigger1 = var(59) > 0
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0


;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 1400]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = statetype != A
triggerall = EnemyNear,StateType != L
triggerall = fvar(19)= 0
Triggerall = time = 0
Triggerall = ( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) )  < 105

Trigger1 = fvar(22) < 5
Trigger1 =   random < (5- 1*fvar(22)) * 200


value = 220  + 1000*(random % 2=0)
ignorehitpause = 1
;-----------------------------------------------------------------------------------------------



;-------------------------------------------------


[State -2]                      ;盾防    防御性能
type = HitOverride
triggerall = 1                           ; on/off
Triggerall = fvar(22)>=5
triggerall = var(59) > 0                 ; ai
triggerall =  !ishelper && alive && RoundState = 2
;triggerall =  !Enemy,HitDefAttr = SCA,AT
;triggerall = helper(32000),var(39)=0  ||     helper(32000),var(38)=0   ;cooldown
;triggerall =  time > 2

Trigger1 = time = [2,12]

attr = SCA,AA,AP;,AT
stateno = 1701     ; + (750-1701)*(power >= 1000 && random < 25)        ;防止无限循环
time = 1
IgnoreHitPause = 1
persistent = 1


;-----------------------------------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------------------------------





[State 810, ];投系时 让对法无法防御
type = AttackDist
trigger1 = 1
value = 0


[State 0, PosSet]          ;防止 站在空中
type = PosSet
trigger1 =  time = 0
trigger1 = pos Y != [-5,5]
y = 0
;ignorehitpause =
;persistent =



;--------------------速度
[state a]
type = velset
trigger1 = animelem = 2
x = 9

;--------------------速度
[state a]
type = velmul
trigger1 = 1
trigger1 = vel x != [-1.5,1.5]
x = 0.97

;--------------------速度
[state a]
type = velmul
trigger1 = animelemtime(9) >0
trigger1 = vel x != [-0.5,0.5]
x = 0.85


[State 800, 1]
type = HitDef
Trigger1 = Animelem = 4
Trigger1 = p2stateno != 150 && 151 && 152 && 153 && 130 && 131 && 140
;Trigger1 = enemynear,pos Y > -50
;Trigger1 = enemynear,stateno != 150 && 151 && 152 && 153 && 154 && 155    && 130 && 131 && 132 && 140 ;
attr = S,ST          ;ｓ：立ち　ｎ：通常　ｔ：投げ
hitflag = M- ;MAF;         ;コンボの途中から投げが入らないようO定してある
priority = 1, Miss    ;１は先位が低いので技がでないかミスするというO定
sparkno = -1          ;-をつければスパ`クエフェクトはoい
sprpriority = 1       ;２Ｐより上にカンフ`マンが表示される
;p1facing = ifelse (command = "holdback", -1, 1) ;前を押したらタ`ンするO定
p2facing = 1          ;？
p1stateno = 806     ;投げが成功した龊悉我婴工耄保肖违攻譬`ト
p2stateno = 3806       ;投げが成功した龊悉我婴工耄玻肖违攻譬`ト
hitsound = S800,1
fall = 1              ;落ちる力を２Ｐにかけるか
kill = 0
hitonce = 1
numhits = 0




[State 00]
type = PlaySnd
trigger1 = Time= 3
value = 110, 0
;loop = 1
;channel = 1


[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1




;---------------------------------------------------------------------------
;               投技
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 2,0
poweradd= 20*fvar(22)
ctrl = 0
anim = 800  +2*(var(59) > 0)   ; 802 为 AI专用
sprpriority = 1


;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 800]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = statetype != A
;triggerall = EnemyNear(var(55)),statetype != A
triggerall = prevstateno != [150,159]
triggerall =   (EnemyNear(var(55)),pos x - pos x)*facing  - 4*(EnemyNear(var(55)),vel x) > 0      ;12
;triggerall = ( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) - 5*(EnemyNear(var(55)),vel x)  < 50
;triggerall = random < (111 +333*(life > 0.85*lifemax)+ 55*(palno <4)  + 55*(palno <7)  + 444*(EnemyNear(var(55)),statetype = A ) )*((life > 0.85*lifemax)*0.2 +(life > 0.55*lifemax)*0.2  +(life > 0.35*lifemax)*0.4 +0.2  )
triggerall = power >= 1000
triggerall = random<(0.2+0.8*(helper(32000),var(56)>900)-0.6*(fvar(16)>0))*(0.2+0.2*(backedgedist < 25)+0.3*(life<lifemax*0.95)+0.05*fvar(22))*(111 +444*(EnemyNear(var(55)),facing = facing)+ 555*(var(20) = 3)+ 555*(var(20)>0 && backedgedist < 25))
triggerall = fvar(19)= 0
triggerall =  numhelper(2650)= 0   ;无 琴里
trigger1 =  Time = 0
trigger1 =  (    ( (EnemyNear(var(55)),pos x - pos x)*facing < 85 )  && random % 3 !=0   )
value = 2600
ignorehitpause = 1


;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 800]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = statetype != A
;triggerall = EnemyNear(var(55)),statetype != A
triggerall = prevstateno != [150,159]
triggerall =   (EnemyNear(var(55)),pos x - pos x)*facing  - 4*(EnemyNear(var(55)),vel x) > 0      ;12
;triggerall = ( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) - 5*(EnemyNear(var(55)),vel x)  < 50
;triggerall = random < (111 +333*(life > 0.85*lifemax)+ 55*(palno <4)  + 55*(palno <7)  + 444*(EnemyNear(var(55)),statetype = A ) )*((life > 0.85*lifemax)*0.2 +(life > 0.55*lifemax)*0.2  +(life > 0.35*lifemax)*0.4 +0.2  )
triggerall = power >= 1000
triggerall = random<(0.2+0.8*(helper(32000),var(56)>900)-0.6*(fvar(16)>0))*(0.2+0.2*(backedgedist < 25)+0.3*(life<lifemax*0.95)+0.05*fvar(22))*(111 +444*(EnemyNear(var(55)),facing = facing)+ 555*(var(20) = 3)+ 555*(var(20)>0 && backedgedist < 25))
triggerall = fvar(19)= 0
triggerall = numhelper(2350)= 0 && numhelper(2150)= 0     ;无  折纸
trigger1 =  Time = 0

value = 2300
ignorehitpause = 1





;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 1400]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = fvar(22) < 5   ; 低强度时  使用
triggerall = statetype != A
triggerall = prevstateno != [150,159]
triggerall =   (EnemyNear(var(55)),pos x - pos x)*facing  - 8*(EnemyNear(var(55)),vel x) > 0      ;12
triggerall = ( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) - 5*(EnemyNear(var(55)),vel x)  < 65
;triggerall = random < (111 +222*(life > 0.85*lifemax)+ 111*(palno <4)  + 111*(palno <7)  + 444*(EnemyNear(var(55)),statetype = A ) )*((life > 0.85*lifemax)*0.2 +(life > 0.55*lifemax)*0.3  +(life > 0.35*lifemax)*0.3 +0.2  )
triggerall = fvar(19)= 0
triggerall = EnemyNear(var(55)),facing = facing   &&  EnemyNear(var(55)),animtime < 11  ||   (var(20) = 3)

trigger1 = Time = 0
trigger1 = random <=  (0.5+0.5*(fvar(16)=0) )*(444 + 555*(var(20) = 3)  )

value = 410
ignorehitpause = 1
;---------------------------------------------------------------------------


;---------------------------------------------------------------------------
;--------【临时变招  补救】--------------   for  AI    临时补救措施
;---------------------------------------------------------------------------
[State 1400]
type = ChangeState
triggerall = var(59) > 0  && Roundstate = 2  && alive && (!ishelper)
triggerall = fvar(22) = 1   ; 低强度时  使用
triggerall = statetype != A
triggerall = fvar(19)= 0
triggerall = EnemyNear(var(55)),pos y > - 15
triggerall = ((EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) < 35

trigger1 = Time = 0
trigger1 = random <=  325+25*var(57)        ;手加减模式时， 将投技转化为 可防御且较慢的下脚

value = 400  - 200*(random % 3 =0)
ignorehitpause = 1
;---------------------------------------------------------------------------




[State 0, Turn]         ;自动转身
type = Turn
trigger1 = var(59) > 0
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0

[State 810, ];投系时 让对法无法防御
type = AttackDist
trigger1 = 1
value = 0




[State 0, NotHitBy]         ;狂级有无敌
type = NotHitBy
trigger1 = fvar(22)>=3   &&    time <= 3
trigger2 = movecontact         ;接触时也无敌 ，防止将对手卡在空中
value = SCA
time = 1
ignorehitpause =  1


[State 6000, SuperPause]
type = SuperPause
trigger1 =  fvar(22)>=5     ;狂中有停时
trigger1 =  time = 0
time = 2
movetime = 2
anim = -1
sound = -1
darken = 0
ignorehitpause =  1
persistent = 0

;-----------------------ADD        地面黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 4
anim = 8233        ;
pos = 60,0
scale = 0.5,0.2
postype = P1
ownpal = 1
id = 8233           ;
bindtime = -1
sprpriority = -3
;removetime = 30
velocity = 0,-1
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



[State 800, 1]
type = HitDef
Trigger1 = Animelem = 2
Trigger1 = p2stateno != 150 && 151 && 152 && 153 && 130 && 131 && 140
;Trigger1 = enemynear,pos Y > -50
;Trigger1 = enemynear,stateno != 150 && 151 && 152 && 153 && 154 && 155    && 130 && 131 && 132 && 140 ;
attr = S,ST          ;ｓ：立ち　ｎ：通常　ｔ：投げ
hitflag = M- ;MAF;         ;コンボの途中から投げが入らないようO定してある
priority = 1, Miss    ;１は先位が低いので技がでないかミスするというO定
sparkno = -1          ;-をつければスパ`クエフェクトはoい
sprpriority = 1       ;２Ｐより上にカンフ`マンが表示される
;p1facing = ifelse (command = "holdback", -1, 1) ;前を押したらタ`ンするO定
p2facing = 1          ;？
p1stateno = 806     ;投げが成功した龊悉我婴工耄保肖违攻譬`ト
p2stateno = 3806       ;投げが成功した龊悉我婴工耄玻肖违攻譬`ト
hitsound = s-1 ;800,1
fall = 1              ;落ちる力を２Ｐにかけるか
kill = 0
hitonce = 1
numhits = 0



[State 00]
type = PlaySnd
trigger1 = AnimElem = 3
value = 8000, 1
;loop = 1
channel = 1


[State 800, 2]
type = ChangeState
Trigger1 = var(59) > 0      ;for ai    方便观察的变招
Trigger1 = time = 3
Trigger1 = fvar(22)>=3    || life < 0.35*lifemax
value = 400    + 2200*(fvar(22)>=5  && power > 1000  && (random <333-333*(enemynear,vel x > 9)+222*(power>4000)+222*(enemynear,facing =facing)) &&  numhelper(2650)= 0 )
ctrl = 0


[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1




;=======================[投技]====================================

[Statedef 806]
type     = S
movetype = A
physics  = S
ctrl = 0
anim = 806
velset = 0,0
sprpriority = 3
;facep2 = 1

 [State 1010, Super A]
type     = SuperPause
trigger1 = time = 0
anim     = -1
time     = 2
movetime = 0
darken   = 0
ignorehitpause =  1
persistent = 0


[State 200, 5];voice
type = PlaySnd
trigger1 = animelem = 3
value = 9000,0+(random%3)
;channel = 0
;voulme = 440
channel = 0
lowpriority = 1


[State 200, 5]
type = PlaySnd
trigger1 =  Time = 1;animelem = 5     ;电流
value = 8000,12
IgnoreHitPause = 1
persistent = 0

[State 200, 5]
type = PlaySnd
trigger1 = 1
trigger1 = Time = 2   ;暗影 嗡~
value = 8000,5
IgnoreHitPause = 1
persistent = 0



[State 0, Turn]
type = Turn
triggerall =  (EnemyNear(var(55)),pos x - pos x)*facing  < 0
trigger1 = time = [0,1]







[State 52, 2]         ;888999
type = PosSet
trigger1 = Time = 0
y = 0

[State 210, Width];画面端の押しし判定    --------[ throw  ]
type = Width
trigger1 = 1;animelem = 1
edge = 80,0

;-----------------------ADD        地面黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 4  -2
anim = 8233        ;
pos = 60,0
scale = 0.5,0.2
postype = P1
ownpal = 1
id = 8233           ;
bindtime = -1
sprpriority = -3
;removetime = 30
velocity = 0,-1
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑暗球 黑皮
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 8103        ;
pos = 60,-60
scale = 0.7,0.7
postype = P1
ownpal = 1
id = 18103            ;
bindtime = 1
sprpriority = -3
;removetime = 30
velocity = 0,-1
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0





;-----------------------ADD         黑暗球 内核
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 8102        ;
pos = 60,-60
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 18102           ;
bindtime = 1
sprpriority = 4
;removetime = 30
velocity = 0,-1
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 9
id = 18102
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 9
id = 18103
ignorehitpause = 1
;persistent =


;---------------------[火花]       爆炸
[state a];
type = Helper
trigger1 = animelem = 9 ; animelemtime(11)>0
id = 7007
;name = "hit"
pos = 70, -110 ;- 0.5*(p2dist Y)
postype = p1
stateno = 7007
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0

;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = animelem = 9 ; animelemtime(11)>0
anim = 8233       ;
pos = 70, -110 ;- 0.5*(p2dist Y)
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = animelem = 9 ; animelemtime(11)>0
anim = 8233       ;
pos = 70, -110 ;- 0.5*(p2dist Y)
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



[State 52, 1]
type = VelSet
trigger1 = time = 0
x = 0
y = 0

[state a]
type = targetbind ; bindtotarget
trigger1 = animelem = 1 ;||  animelem = 13
pos = 60,0



[state a]
type = envshake
trigger1 = animelem = 9
time = 40
freq = 90
ampl = 4

;---------------------[音效]

[State 2000, 6];           爆炸
type = Playsnd
trigger1 = animelem = 9
value = 8000,8

[State 2000, 6];           燃烧
type = Playsnd
trigger1 = animelem = 10
value = 8000,7


;---------------------[对方状态]
[State 801, 2]
type = Targetstate
trigger1 = animelem = 9         ;爆炸
value = 3807


;---------------------[伤害]
[state a]
type = targetlifeadd
trigger1= animelem = 3 || animelem = 4 || animelem = 5|| animelem = 6
value = -0.01*(target,lifemax)
kill = 0
absolute = 1



;---------------------[伤害]        ;最后  可KILL
[state a]
type = targetlifeadd
trigger1= animelem = 9
value = -0.1*ceil((target,lifemax)*(0.5+0.15*fvar(22)))
kill = 1
absolute = 1



[State 4001, hitadd]
type = hitadd
trigger1= animelem = 9
value = 1

[State 4001, hitpower]
type = targetpoweradd
trigger1= animelem = 9
value = 100



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
trigger2 = Time > 800
value = 0
ctrl = 1
ignorehitpause = 1

;======================================

;;======================================
;======================================


;800后 敌人的状态3806
[Statedef 3806]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0     ;    0----无碰撞

[State 3606,anim]
type = ChangeAnim2
Trigger1 = Time = 0
value = 5007
Ignorehitpause = 1

[State 0, Turn]
type = Turn
triggerall =  facing = EnemyNear,facing
trigger1 = time = [0,1]
Ignorehitpause = 1

[State 700, 2];被抓取的对象 进入无敌 ，以防被队友打中 从而化解投技
type = NotHitBy
trigger1 = 1
value = SCA

[State 52, 2]
type = PosSet
trigger1 = Time = [0,1]
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = 0
y = -1
;ignorehitpause = 1
;persistent =


[State 820, 1]
type = ChangeState
trigger1 = time >= 75;60
trigger1 = Alive
value = 3807
ctrl = 0
ignorehitpause = 1


[State 820, 1]
type = SelfState
trigger1 = time >= 180
trigger1 = Alive
value = 5210


;[State 820, 1]
;type = SelfState
;trigger1 = time >= 60
;trigger1 = !Alive
;value = 5050

;---------------------------------------------------------------------------
;(ENEMY)           爆炸后 下落
[Statedef 3807]
type    = A
movetype= H
physics = N
sprpriority = 1
velset = -2.5,-11.5;2.1,-3.1


[State 0, 消除帮助物体]
type=changestate
trigger1=ishelper ;+(name!="BlackPrincess_Tohka")
value=6919
ignorehitpause=1


[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0     ;    0----无碰撞


[State 700, 2];无敌
type = NotHitBy
trigger1 = 1
trigger1 = time < 30
value = SCA
time = 1

;--------------------速度
[state a]
type = velmul
trigger1 = vel X !=[-1,1]
trigger1 = time > 0
x = 0.95


[State 0, Turn]
type = Turn
triggerall =  facing = EnemyNear,facing
trigger1 = time = 0
Ignorehitpause = 1

[State 820, 1]
type = ChangeAnim
Trigger1 = Time = 0
value = 5050

[State 821, 1]
type = VelAdd
Trigger1 = time > 0
y = .39   ; 下落速度   .40


[State 821, 3]
type = selfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
;trigger1 = Alive
value = 5110
ignorehitpause = 1



;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;必⒓
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

 ;---------------------------------------------------------------------------
; 【升龙】  【 236 a  】
[Statedef 1000]
type    = S
movetype= A
physics = N
juggle  = 0
poweradd= 50
velset = 0,0
anim = 1000
sprpriority = 1
ctrl = 0
;facep2 = 1


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
;trigger1 = movecontact
;trigger1 =   (  (enemynear,pos x - pos x)*facing  )     > 0
edge = 45,19

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 12
edge = 19,19



[State 0, StateTypeSet]   ; 攻击之后  方便对手反击
type = StateTypeSet
trigger1 = animelem = 12
statetype = A       ;S,A,C,L
movetype = I        ;I,A,H
physics = A         ;A,C,S,N
;ignorehitpause =
;persistent =



;----------- 【添加Helper】 --------  当身 增加攻击面       借用1230的 Helper ---- 1237
[state a]
type = Helper
triggerall = 1
trigger1 = fvar(22)>=5              ;狂中
trigger1 = NumHelper(1237) = 0           ;本身不存在
trigger1 = animelemtime(8) > 0  && animelemtime(9) < 0
trigger1 =( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) )  = [-5,45]
trigger1 = p2bodydist y = [-85,85]
sprpriority = 2
pos = 10, -40
postype = p1
stateno = 1237
id = 1237
helpertype = normal
pausemovetime = 0
keyctrl = 0
ownpal = 1
IgnoreHitPause = 1
;Persistent = 0


;-----------------------ADD
[State 2001]
type = Explod
trigger1 = animelemtime(4) = 1;7
anim = 8100           ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8100               ;
bindtime = -1
sprpriority = 5
ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 9999999
supermovetime = 99999
IgnoreHitPause = 0
;persistent = 0



[State 5210, 1] ;Blink white
type = PalFX
trigger1 = 0
trigger1 = Time = 0
time = 7
add = 22,22,22 ;256,256,256
sinadd = 125,125,125,18


[State 1100, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(6) = 0
statetype = A
physics = A
ignorehitpause = 1


[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  time = 1
value = 9100,0; +(Random%3)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0


[State 200, 1];
type = PlaySnd
trigger1 = animelem = 5
value = 500, 11



;---------------------[x]
[State 1100, VelSet]
type = VelSet
trigger1 = AnimElem = 4
x =   ifelse( (2  + 0.05* ((enemynear,pos x - pos x)*facing) ) >7   , 7  , 2 + 0.05* ((enemynear,pos x - pos x)*facing)  )

;---------------------[x]
[State 1100, VelSet]
type = VelSet
trigger1 = AnimElem = 6
y = -8

[State 1100, Gravity]
type = VelAdd
trigger1 = AnimElemTime(9) > 0
y = 0.1

;---------------------[x]
[State 1100, VelSet]
type = VelMul
trigger1 = vel x != [-0.5,0.5]
x = 0.9


;---------------------[G]
[State 170, G]
type = NotHitBy
trigger1 = animelemtime(8)<1
value = SCA
time = 1 + ceil(0.5*fvar(22) )
ignorehitpause = 1


[State 210, 2]
type = HitDef
;trigger1 = fvar(22) >= 5
trigger1 = animelem = 8
attr = A, SA
animtype  = hard
damage    = 30*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 60+5*fvar(22),30
guardflag = M
pausetime = 4,8    ; 4,14
sparkno = s-1
sparkxy = -10,-64+0.5*(p2dist y)
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = high
ground.slidetime = 22;+fvar(22)
ground.hittime  = 22;+fvar(22)
ground.velocity = - 2.5,-7.9
air.velocity = -3.2,-6.9
guard.velocity = - 5
airguard.velocity = -2.5,-4
ID = 1000
fall = 1
air.fall = 1
fall.recovertime = 90
Ground.CornerPush.VelOff   = -5
Air.CornerPush.VelOff      = -5
Down.CornerPush.VelOff     = -5
Guard.CornerPush.VelOff    = -5
yaccel = 0.45


[State 210, 2]
type = HitDef
;trigger1 = fvar(22) >= 5
trigger1 = animelem = 10
attr = A, SA
animtype  = hard
damage    = 30*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 60+5*fvar(22),30
guardflag = M
pausetime = 10,14    ;  11,12
sparkno = s-1
sparkxy = -10,-64+0.5*(p2dist y)
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = high
ground.slidetime = 22;+fvar(22)
ground.hittime  = 22;+fvar(22)
ground.velocity = - 2.5,-7.9
air.velocity = -3.2,-5.9
guard.velocity = - 5
airguard.velocity = -2.5,-4
ID = 1000
fall = 1
air.fall = 1
fall.recovertime = 90
Ground.CornerPush.VelOff   = -5
Air.CornerPush.VelOff      = -5
Down.CornerPush.VelOff     = -5
Guard.CornerPush.VelOff    = -5
yaccel = 0.45


;---------------------[火花]
[state a];
type = Helper
trigger1 = animelemtime(8)>0 &&  animelemtime(10)<0
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 +55) +(random % 10) , floor(p2dist y/2 -75) -(random % 20)
postype = p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0


;---------------------[火花]
[state a];
type = Helper
trigger1 = animelemtime(10)>0 &&  animelemtime(11)<1
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 +55) +(random % 10) , floor(p2dist y/2 -75) -(random % 20)
postype = p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0



;---------------------[Xe[g]
[State 1150]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52



;---------------------------------------------------------------------------
; 【 236 b  】         小山崩        起跳
[Statedef 1010]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= 50
ctrl = 0
velset = 0,0
anim = 1010

[State 1100, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(3) = 0
statetype = A
physics = A
ignorehitpause = 1

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 3
edge = 35,20



[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  time = 1
value = 9000,0 +(Random%3)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0


[State 0, NotHitBy]
type = NotHitBy
trigger1 = fvar(22)>=4
trigger1 = fvar(19)>0    ;-----命中敌人后无敌
value = SCA
time = 2
ignorehitpause =  1


;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0


;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 3
x =8   -2*((enemynear,pos x - pos x)*facing       <65)    -2*((enemynear,pos x - pos x)*facing       <35)
y = -4.5  +0.5

;--------------------速度
[state a]
type = velmul
trigger1 = vel x != [-1,1]
x = 0.9


[State 200, 1];
type = PlaySnd
trigger1 = animelem = 3
value = 500, 4

;---------------------------------------------------------------------------
; 【 236 b  】       小山崩        落地
[Statedef 1011]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= 50
ctrl = 0
;velset = 0,0
anim = 1011     +2*(fvar(19)>0 && var(59)>0) ;对电脑无情，防止对方受击框过小


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 45
trigger1 = animelem = 1
edge = 55,20

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 5
edge = 25,20


[state a]
type = posset
;trigger1 = time >= 0
trigger1 = time = 0
y = 0
ignorehitpause = 1



[State 0, NotHitBy]
type = NotHitBy
trigger1 = fvar(22)>=4
trigger1 = fvar(19)>0    ;-----命中敌人后无敌
trigger1 = animelemtime(5)<1      ;5
value = SCA
time = 2
ignorehitpause =  1

;-----------------------ADD        尘土
[State 2001]
type = Explod
trigger1 = animelem = 3
anim = 8653        ;
pos = 65,9
scale = 0.4,0.4
postype = P1
ownpal = 1
id = 8653             ;
bindtime = 1
sprpriority = 5
;removetime = 30
;velocity = 7,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD       尘土    黑影
[State 2001]
type = Explod
trigger1 = animelem = 3
anim = 8654         ;
pos = 65,9
scale =  0.4,0.4
postype = P1
ownpal = 1
id = 8654             ;
bindtime = 1
sprpriority = -4
;removetime = 30
;velocity = 7,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelem = 3
anim = 8233       ;
pos = 65,0
scale = 1.5,0.5
postype = P1
ownpal = 1
id = 8233           ;
bindtime = 1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = velset
trigger1 = AnimElem = 3
y = 0


[State 210, 2]
type = HitDef
trigger1 = (  fvar(22) < 5  && var(59) > 0  )  ||  var(59) = 0
trigger1 = animelem = 3
attr = S, SA
animtype  = hard
damage    = 40*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 30+3*fvar(22)  +200*(power<500&&var(59)>0)+200*(power<750&&var(59)>0)+200*(power<1000&&var(59)>0),10
guardflag = HA
pausetime = 13,16    ;  11,12
sparkno = s-1
sparkxy = -10,-70
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 19 ; -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19  ;-1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 1.2,-7.5
air.velocity = -0.9,-6.5    ; +1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200)
guard.velocity = - 15
airguard.velocity = -10,-2.5
ID = 1011
fall = 1
air.fall = 1
fall.recovertime = 120
Ground.CornerPush.VelOff   = -24    +4
Air.CornerPush.VelOff      = -24    +4
Down.CornerPush.VelOff     = -24    +4
Guard.CornerPush.VelOff    = -24    +4
yaccel = 0.4
;p2stateno = 3261             ;-----------------------------------带入 ;【on/off】
;---------------------------
envshake.time = 12
envshake.ampl = 10
envshake.freq = 60

;-----------------------------------带入
[State 20] ;
type = targetState
trigger1 = 1             ;【on/off】
trigger1 = movehit && NumTarget(1011)
value = 3261
ctrl = 0
IgnoreHitPause = 1
Persistent     = 0


[State 210, 2]
type = HitDef
trigger1 = fvar(22) >= 5  &&  var(59) > 0        ;非起手技能，如果被对手防御，则说明对手脱离
trigger1 = animelem = 3
attr = S, SA
animtype  = hard
damage    = 40*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 30+3*fvar(22)  +200*(power<500&&var(59)>0)+200*(power<750&&var(59)>0)+200*(power<1000&&var(59)>0),10
guardflag = -1
pausetime = 13,16    ;  11,12
sparkno = s-1
sparkxy = -10,-70
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 19 ; -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19  ;-1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = - 1.2,-7.5
air.velocity = -0.9,-6.5    ; +1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200)
guard.velocity = - 15
airguard.velocity = -10,-2.5
ID = 1012
fall = 1
air.fall = 1
fall.recovertime = 120
Ground.CornerPush.VelOff   = -24    +4
Air.CornerPush.VelOff      = -24    +4
Down.CornerPush.VelOff     = -24    +4
Guard.CornerPush.VelOff    = -24    +4
yaccel = 0.4
;p2stateno = 3261             ;-----------------------------------带入 ;【on/off】
;---------------------------
envshake.time = 12
envshake.ampl = 10
envshake.freq = 60

;-----------------------------------带入
[State 20] ;
type = targetState
trigger1 = 1             ;【on/off】
trigger1 = movehit && NumTarget(1012)
value = 3261
ctrl = 0
IgnoreHitPause = 1
Persistent     = 0


;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 +35) +(random % 10) , floor(p2dist y/2 -25) -(random % 20)
postype = p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0


[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;【236 c】 站立飞道        黑暗球
[Statedef 1020]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= 50+10*fvar(22)
ctrl = 0
anim = 1020
sprpriority = 1
velset = 0,0
;facep2 = 1


;----------- 【添加Helper】 --------  添加 黑暗球
[state a]
type = Helper
trigger1 =  animelem= 8
sprpriority = 2
pos = 30, 0      ;40
postype = p1
stateno = 8102
id = 8102
helpertype = normal
pausemovetime = 0
keyctrl = 0
ownpal = 1
IgnoreHitPause = 1
Persistent = 0



[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai      step 1
triggerall = fvar(22) >=5
trigger1 = time = 1
anim     = -1
time     = 1
movetime = 1
darken   = 0
ignorehitpause =  1
persistent = 0

[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai      step 2
triggerall = fvar(22) >=5
trigger1 = time = 3
anim     = -1
time     = 1
movetime = 1
darken   = 0
ignorehitpause =  1
persistent = 0

[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai     step 3
triggerall = fvar(22) >=5
trigger1 = time = 5
anim     = -1
time     = 1
movetime = 1
darken   = 0
ignorehitpause =  1
persistent = 0

[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai     step 4
triggerall = fvar(22) >=5
trigger1 = time = 7
anim     = -1
time     = 1
movetime = 1
darken   = 0
ignorehitpause =  1
persistent = 0

[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai       step 5
triggerall = fvar(22) >=5
trigger1 = time = 9
anim     = -1
time     = 1
movetime = 1
darken   = 0
ignorehitpause =  1
persistent = 0


[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai       step 6
triggerall = fvar(22) >=5
trigger1 = time = 11
anim     = -1
time     = 1
movetime = 1
darken   = 0
ignorehitpause =  1
persistent = 0

[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai       step 7
triggerall = fvar(22) >=5
trigger1 = time = 13
anim     = -1
time     = 1
movetime = 1
darken   = 0
ignorehitpause =  1
persistent = 0



;------------------;------------------;------------------;------------------
;-----------------------ADD      手部 幻影    凶- 狂下
[State 2001]
type = Explod
trigger1 =  fvar(22) < 5
trigger1 = animelem =1
anim = 8107          ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8107            ;
bindtime = 1
sprpriority = 3
ontop = 0
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 0       ;  9999
supermovetime = 0       ;  9999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD      手部 幻影     狂中
[State 2001]
type = Explod
trigger1 =  fvar(22) >=5
trigger1 = animelem =1
anim = 8107          ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8107            ;
bindtime = 1
sprpriority = 3
ontop = 0
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 7       ;  9999
supermovetime = 7       ;  9999
IgnoreHitPause = 1
persistent = 0



[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  time = 1
value = 9100,6 ;9200,5 ;+(Random%3)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0


[State 0, VarAdd]
type = Varset
trigger1 = var(31) =0
trigger1 = animelem = 2
v = 31
value = 99
ignorehitpause = 1
;persistent =




;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0



;--------------------速度
[state a]
type = velset
trigger1 = animelem = 8
;x = -0.5
x = 0





[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;------------;------------;------------;------------;------------;------------
;-------------【添加 helper】 ------------被召唤物  黑暗球------
;------------;------------;------------;------------;------------;------------
[Statedef 8102]
type = A
ctrl = 0
anim = 9998
velset = 1.0,0
movetype = A
physics = N
sprpriority = 1

[State 0, PosSet]
type = PosSet
trigger1 = pos y != 0
y = 0
ignorehitpause = 1



[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = angledraw
trigger1 = 1
scale = 2,2;0.75,0.75

[State 0, VelSet]
type = VelSet
trigger1 = time >= 0
trigger1 = vel x != 1.1
x = 1.0
ignorehitpause = 1
;persistent =



;-----------------------ADD        黑暗球 黑皮    89f
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 8103        ;
pos = 0,-70
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8103            ;
bindtime = 1
sprpriority = 3
;removetime = 30
velocity = 1.0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD         黑暗球 内核   89f
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 8102        ;
pos = 0,-70
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8102           ;
bindtime = 1
sprpriority = 4
;removetime = 30
velocity = 1.0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0




[State 620, Projectile]                  ;因为是helper 所以要用root
type = Projectile
triggerall = (random < 1001 -1001*(root,movetype = H  && root,stateno !=[120,159])   ) || root,fvar(22)>=5
trigger1 =  !(  root,stateno = 410  && root,movehit )
trigger1 =  !(  root,stateno = 420  && root,movehit )
trigger1 =  !(  root,stateno = 1230  && root,movehit )
trigger1 = time = 5 ||time = 15|| time = 25 ||time = 35 || time = 45 ||time = 55 ||time = 65|| time = 75 ;|| time = 85
attr = A, NP
damage = (8+2*(root,fvar(22)) +5*(root,fvar(22)>=5) )*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+1*root,fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 50,20
pausetime = 1,4
sparkno =  s-1
sparkxy = 20+random%10,-55-random%30
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high

ground.slidetime = 15+ ceil(1.0*root,fvar(22) )   ; -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  =  15+ ceil(1.0*root,fvar(22) )   ; -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
guard.hittime =   11 + ceil(1.0*root,fvar(22) )   ;    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
guard.slidetime = 11 + ceil(1.0*root,fvar(22) )    ;   -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)

ground.velocity = -3.9
guard.velocity = -4.7
air.velocity = -1.1,-4.2   ;+1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200)       - 1.2
air.fall = 1
fall.recovertime = 80
ID = 8104
nochainID = 9999
yaccel = 0.450
;-----------color change-------------
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 8104
projanim = 8104
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 3;31
velocity = 1.0,0;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0.03,-0.11                                 ; 弹道
remvelocity = 0,0
projhits = 1
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 0,0
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261



[State 620, Projectile]                  ;因为是helper 所以要用root
type = Projectile
triggerall = (random < 1001 -1001*(root,movetype = H  && root,stateno !=[120,159])   ) || root,fvar(22)>=5
trigger1 =  !(  root,stateno = 410  && root,movehit )
trigger1 =  !(  root,stateno = 420  && root,movehit )
trigger1 =  !(  root,stateno = 1230  && root,movehit )
trigger1 = time = 10 ||time = 20|| time = 30 ||time = 40 || time = 50 || time = 60 ||time = 70 || time = 80
attr = A, NP
damage = (8+2*(root,fvar(22)) +5*(root,fvar(22)>=5) )*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+1*root,fvar(22)
priority = 3, Hit
animtype  = medium ;hard
hitflag = MAF
guardflag = MA
getpower = 50+5*fvar(22),30
pausetime = 1,4
sparkno = s-1
sparkxy = 20+random%10,-55-random%30
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 15+ ceil(1.0*root,fvar(22) )   ; -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  =  15+ ceil(1.0*root,fvar(22) )   ; -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
guard.hittime =   11 + ceil(1.0*root,fvar(22) )   ;    -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
guard.slidetime = 11 + ceil(1.0*root,fvar(22) )    ;   -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)

ground.velocity = -3.9
guard.velocity = -4.7
air.velocity = -1.1,-4.2  ; +1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200)     - 1.2
air.fall = 1
fall.recovertime = 80
ID = 8104
nochainID = 9999
yaccel = 0.450
;-----------color change-------------
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 8104
projanim = 8104
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 3;31
velocity = 1.0,0;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0.03,-0.11                                 ; 弹道
remvelocity = 0,0
projhits = 1
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 0,0
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261


;------------------------------------------------------------
;---------------------[]
[state destroyself]
type = destroyself
trigger1 = time > 80 +2




[State 00]
type = ChangeState
trigger1 = root,movetype = H  &&( root,stateno !=[120,159])   && root,fvar(22)< 5
value = 8105



;---------------------------------------------------------------------------
[Statedef 8105]
type = A
ctrl = 0
anim = 9998
velset = 1.0,0
movetype = A
physics = N
sprpriority = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 =  1
id = 8102


[State 0, RemoveExplod]
type = RemoveExplod
trigger1 =  1
id = 8103
;-----------------------ADD        黑暗球 消失

[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 8105       ;
pos = 0,-70
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8105            ;
bindtime = 1
sprpriority = 3
;removetime = 30
velocity = 1.0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 999999
supermovetime = 999999
IgnoreHitPause = 1
persistent = 0



[state destroyself]
type = destroyself
trigger1 = time > 2
;---------------------------------------------------------------------------
; バックステップ
[Statedef 1105]
type    = S
physics = S
ctrl = 0
anim = 105
velset = 0,0

[State -2]
type = Nothitby
Trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1


[State 0, Turn]
type = Turn
trigger1 = var(59)>0      ; for  AI
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    > 0    ; < 0  故意反向
ignorehitpause = 1
persistent = 0


[state a]
type = playerpush
trigger1 = time > 1
value = 0


[State 00]
type = ChangeState
trigger1 = animtime = 0
value = 1106

;---------------------------------------------------------------------------
; 空中
[Statedef 1106]
type    = A
physics = A
ctrl = 0
anim = 106
sprpriority = 1


[State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 32
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1




[state a]
type = playerpush
trigger1 = time < 9
value = 0

[state a]
type = playerpush
trigger1 = time >= 9
value = 1


[State 00]
type = VelSet
trigger1 = Time = 0
x = -5  -1 ; -1
y = -4  -0.5  -0.5*(enemynear,pos Y < - 55 )

[State 00]
type = Veladd
trigger1 = Time > 0
x = -0.1

[State 00]
type = Velmul
trigger1 =  (  (enemynear,pos x - pos x)*facing  )     > 0
x = 0.95


[State -2]
type = Nothitby
Trigger1 = 1
value = ,AT
time = 1
ignorehitpause = 1

[State -2]
type = Nothitby
Trigger1 = time = 0
value2 = SCA
time = 9 + fvar(22)  +6*(fvar(19)>0)



[State 01]
type = ChangeState
;trigger1 = var(59)>0       ; ------------  not  only  for  ai
trigger1 = time = 4  ;-1
value = 1610


[State 01]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 107



;---------------------------------------------------------------------------
;【y】 集气
[Statedef 1200]
type    = S
movetype= I
physics = S
poweradd= 50+5*fvar(22)
ctrl = 0
anim = 1200
sprpriority = 1
;facep2 = 1


;-------------------------------------------------

[State -2]                      ;高P数强化防御性能
type = HitOverride
triggerall = 1                           ; on/off
Triggerall = fvar(22)>=5
triggerall = var(59) > 0 && RoundState = 2
triggerall =  !ishelper && alive
triggerall =   helper(32000),var(37)=0  || helper(32000),var(36)=0   ;cooldown
triggerall =  time <= 12

trigger1 =  time <= 6    ||   EnemyNear(var(55)),time - var(19) > 20  ;相对时间

attr = SCA,AA,AP,AT
stateno = ifelse( helper(32000),var(37)=0  ,700,701)
time = 1
IgnoreHitPause = 1
persistent = 1

;-------------------------------------------------


[State -2]                      ;盾防    防御性能
type = HitOverride
triggerall = 1                           ; on/off
Triggerall = fvar(22)>=5                ;狂中
Triggerall = palno = [10,12]        ;最高时允许
triggerall = var(59) > 0                 ; for ai
triggerall =  !ishelper && alive && RoundState = 2
;triggerall =  !Enemy,HitDefAttr = SCA,AT
;triggerall = helper(32000),var(39)=0  ||     helper(32000),var(38)=0   ;cooldown
triggerall =  time > 12
Trigger1 = Enemy,numproj     ||      (EnemyNear(var(55)),pos x - pos x)*facing > 200    ||  EnemyNear(var(55)),vel x > 11


attr = SCA,AA,AP;,AT
stateno = 1701    ;  + (750-1701)*(power >= 1000 && random < 25)        ;防止无限循环
time = 1
IgnoreHitPause = 1
persistent = 1


;-----------------------------------------------------------------------------------------------------------------




;-----------------------ADD        集气
[State 2001]
type = Explod
trigger1 = 1
trigger1 = time = 1
anim = 1209         ;
pos = -6,-3
scale = 0.8,0.5
postype = P1
ownpal = 1
id = 1209           ;
bindtime = -1
sprpriority = 2
removetime = 240
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



[State 200, 5];集气
type = PlaySnd
;trigger1 = var(31) =0
trigger1 = time = 2
;trigger1 = animelem = 3
value = 8000,21
channel = 12



[State 0, VarAdd]
type = Varset
trigger1 = 0
trigger1 = animelem = 3
trigger1 = var(31) =0
;trigger1 = time = 1
v = 31
value = 60
ignorehitpause = 1
;persistent =



[State 0, PowerAdd]
type = PowerAdd
trigger1 = 1
value = 5+fvar(22)
;ignorehitpause =
;persistent =



;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0



;--------------------速度
[state a]
type = velset
trigger1 = animelem = 2
x = 0


[State 210, 5]
type = ChangeState
triggerall = !Var(59)                              ;    for    human
triggerall = Alive   &&   RoundState = 2  && !IsHelper
triggerall = statetype != A
triggerall = time >=6
trigger1 = command = "a"
value = 1210
ctrl = 0


[State 210, 5]
type = ChangeState
triggerall = !Var(59)                              ;    for    human
triggerall = Alive   &&   RoundState = 2  && !IsHelper
triggerall = statetype != A
triggerall = time >=6
trigger1 = command = "b"
value = 1220
ctrl = 0


[State 210, 5]
type = ChangeState
triggerall = !Var(59)                              ;    for    human
triggerall = Alive   &&   RoundState = 2  && !IsHelper
triggerall = statetype != A
triggerall = time >=6
trigger1 = command = "c"
value = 1230
ctrl = 0



[State 210, 5]
type = ChangeState
triggerall = Var(59) > 0                         ;    for    ai
triggerall = Alive   &&   !IsHelper
triggerall = statetype != A
triggerall = time >=6
trigger1 = time > 120
trigger2 = time > 33 && random < 33
trigger3 = enemy,numproj  ;||  Enemy,HitDefAttr = SCA,AT;NP ,SP,HP
trigger4 =  RoundState != 2

trigger5 =  time > 9
trigger5 =   (  (enemynear,pos x - pos x)*facing - const(size.ground.front)- enemynear,const(size.ground.front)   ) < 85

trigger6 =  enemynear,stateno >= 200 &&  enemynear,ctrl = 0
trigger6 =  enemynear,movetype = I  &&   enemynear,vel x > 3
trigger6 =  enemynear,time > 5

trigger7 =  inguarddist    ||    helper(32000),   inguarddist    ||  helper(33000),  inguarddist

trigger8 =  fvar(19)>0


value = 1205
ctrl = 0


[State 210, 5]
type = ChangeState
triggerall = !Var(59)                              ;    for    human
triggerall = Alive     && !IsHelper
triggerall = statetype != A
triggerall = time >=6
trigger1 = command = "y"
trigger2 = command = "holdback"
trigger3 = command = "holdfwd"
trigger4 = time > 240
trigger5 =  RoundState != 2
;trigger5 = enemy,numproj  ||  Enemy,HitDefAttr = SCA,AT;NP ,SP,HP
value = 1205
ctrl = 0



;---------------------------------------------------------------------------
;【y】 集气  结束
[Statedef 1205]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 1205
sprpriority = 1
;facep2 = 1

[State 0, NotHitBy]       ;测试用
type = NotHitBy
trigger1 = fvar(22)>=3
value = SCA


[State 230, Projectile]               ;骗检测
type = Projectile
triggerall = 1
trigger1 = var(59) >0                  ;ai
trigger1 = fvar(22) >= 5               ;狂中
trigger1 = time = 0
attr = A, NP
damage = (30+10*(life<0.85*lifemax && fvar(22)>=3))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 50+5*fvar(22),30
pausetime = 2,10
sparkno = s-1
sparkxy = 20+random%20 ,-50-random%20
hitsound   = s450,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 19 -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 19 -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.velocity = -4
air.velocity = -2,-3.9          +0.5*(var(47)<-600) +0.5*(var(47)<-900) +0.5*(var(47)<-1200)
air.fall = 1
fall.recovertime = 80
ID = 6233
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -5
yaccel = .45
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 6233
projanim = 233
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 2  ;12
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = -22,999
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261




[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
;【y】 集气      --------for ai  ------特例执行
[Statedef 1201]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 1201
poweradd= 50+200*( fvar(22) >=5 )
sprpriority = 1
;facep2 = 1

[State 0, NotHitBy]       ;测试用
type = NotHitBy
trigger1 = fvar(22)>=5
value = SCA

[State 0, Turn]
type = Turn
trigger1 =  time = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0


[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai  ------特例执行
triggerall = fvar(22) >=5
triggerall = fvar(19) = 0 ;立回
triggerall = time = 1 ;AnimElem = 1
Triggerall = EnemyNear(var(55)), vel x = 0   && EnemyNear(var(55)), movetype = I
Trigger1 = fvar(16) >0
anim     = -1
time     = 4
movetime = 4
darken   = 0
ignorehitpause =  1
persistent = 0




[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 1220
ctrl = 0




;---------------------------------------------------------------------------
;  【蓄力 A】
[Statedef 1210]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= 50
ctrl = 0
velset = 0,0
anim = 1210

 [State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 32
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1


;-----------------------ADD      刀光
[State 2001]
type = Explod
trigger1 = animelemtime(2) = 4;7
anim = 8121          ;
pos = -6,0
scale = 0.55,0.5
postype = P1
ownpal = 1
id = 8121                ;
bindtime = -1
sprpriority = 5
ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
;pausemovetime = 9999999
supermovetime = 99999
IgnoreHitPause = 0
;persistent = 0


[State 200, 1];    wind
type = PlaySnd
trigger1 = animelem = 2
value = 500, 0

[State 200, 5]
type = PlaySnd
trigger1 = animelem = 2     ;电流
value = 8000,12
IgnoreHitPause = 1
persistent = 0


[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  time = 1
value = 9000,0 +(Random%3)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0






[State 210, Width];画面端の押しし判定
type = Width
trigger1 = 1;animelem = 1
edge = 25,20

;--------------------速度
[state a]
type = velmul
trigger1 = time = 0
x = 0.5

;--------------------速度
[state a]
type = velset
trigger1 = time = 0
y = 0

;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 3
x = 10  ;11


;--------------------速度
[state a]
type = velset
trigger1 = animelem = 8
x = 0



[State 230, Projectile]               ;
type = Projectile
trigger1 = animelem = 4  || animelem = 5  ; || animelem = 6
attr = A, NP
damage = (30+20*(life<0.85*lifemax && fvar(22)>=5))*(IfElse(Enemy,Const(Data.Defence)>100,Enemy,Const(Data.Defence)/100,1)),5+5*fvar(22)
priority = 3, Hit
animtype  = hard
hitflag = MAF
guardflag = HA
getpower = 100+5*fvar(22),50
pausetime = 3,11
sparkno = s-1
sparkxy = 40+random%20,-64+0.5*(p2dist y)
hitsound   = s510,0
guard.sparkno = s7010
guardsound = s122,0
ground.type = high
ground.slidetime = 18 -3*(var(57)>10) +ceil(0.5*fvar(22))  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)     ; 18
ground.hittime  =  18 -3*(var(57)>10) +ceil(0.5*fvar(22))  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)       ; 18
ground.velocity = -7
air.velocity = -2.5,-2.9          +0.5*(var(47)<-600) +0.5*(var(47)<-900) +0.5*(var(47)<-1200)
air.fall = 1
fall.recovertime = 80
ID = 1213
nochainID = 9999
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -11
yaccel = 0.45
;-----------color change-------------
palfx.time = 24
palfx.add = 108,1,158
palfx.mul = 256,256,256
palfx.sinadd = 150,150,150,5
palfx.color = 0
palfx.invertall = 0
;-----------------;-----------------proj
sprpriority = 4
;envshake.time = 10
;envshake.ampl = -3
projID = 1213
projanim = 1213
projhitanim = 9998
projremanim = 9998
projcancelanim = 9998
projscale = 0.5,0.5
projremove = 1
projremovetime = 9;-1
velocity = 0,0;5.5;4.5+1.5*(fvar(22)<5),4.5+1.5*(fvar(22)<5)     ; 弹道
;accel = 0,-0.1                                 ; 弹道
remvelocity = 0,0
projhits = 1;+1*(fvar(22)>=3)
projpriority = 1
projsprpriority = 3
;projedgebound = 200        ;射程有关
;projstagebound = 200        ;射程有关
offset = 0,0
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;p2stateno = 3261




[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
;【蓄力 B 】
[Statedef 1220]
type    = S
movetype= A
physics = S
juggle  = 1
poweradd= 50
ctrl = 0
velset = 0,0
anim = 1220

[State 1010, Super A]
type     = SuperPause
triggerall = var(59) > 0    ;   --------for ai  ------特例执行
triggerall = fvar(22) >=5
triggerall = fvar(19) = 0 ;立回
triggerall = time = 1 ;AnimElem = 1
Triggerall = EnemyNear(var(55)), vel x = 0   && EnemyNear(var(55)), movetype = I
Trigger1 = fvar(16) >0
anim     = -1
time     = 5    ;4
movetime = 5    ;4
darken   = 0
ignorehitpause =  1
persistent = 0



[State 210, Width];画面端の押しし判定
type = Width
trigger1 = frontedgedist < 40
trigger1 = animelem = 2
edge = 10,20

[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 6
edge = 20,20

[state a]                               ;小心冲 过头
type = velmul
trigger1 = frontedgedist < 50
x = 0.5


[State 810, ];        特例修正
type = AttackDist
trigger1 = animelem = 1
value = 150 - 149*(prevstateno= 1201)


[State 2000, c]                      ; 幻影拖尾
type = Afterimage
;trigger1 = animelem = 1
trigger1 = time = 1
time = 32
length = 10
;FrameGap = 2
;TimeGap = 3
Trans = AddAlpha
alpha = 0,133
palmul = 256,256,180
paladd = 50,-110,0
PalBright =  8,8,8
PalContrast = 128,128,200
;palcolor = 256
;palinvertall = 0
ignorehitpause = 1

;-----------------------ADD          移动产生火焰特效
[State 2001]
type = Explod
trigger1 = animelemtime(2) = 0;7
anim = 2208        ;
pos = 35,-5
scale = 0.75,0.5
postype = P1
ownpal = 1
id =  2208               ;
bindtime = 1
sprpriority = 2
vel = -0.5,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD          刀光
[State 2001]
type = Explod
trigger1 = animelemtime(5) = 0;7
anim = 8122          ;
pos = 26,21
scale = 0.5,0.6
postype = P1
ownpal = 1
id = 8122                ;
bindtime = -1
sprpriority = 5
ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


[State 1];
type = NotHitBy
trigger1 = 0    ;测试用
value = SCA

[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  time = 1
value = 9000,0 +(Random%3)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0


[State 200, 1];   WIND
type = PlaySnd
trigger1 = animelem = 2
value = 500, 4


;--------------------速度
[state a]
type = veladd
trigger1 = animelem = 2
x = 12      -4*(  var(59) > 0   &&  (EnemyNear(var(55)),pos x - pos x)*facing  < 75 ) +4*(prevstateno= 1201);特例执行



;--------------------速度
[state a]
type = velset
trigger1 = animelem = 10
x = 0



[State 210, 2]
type = HitDef
trigger1 = fvar(22) < 3
trigger1 = animelem = 6
attr = S, SA
animtype  = hard
damage    = 50*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 30+3*fvar(22),10
hitflag = MAF
guardflag = MA
pausetime = 12,14    ;  11,12
sparkno = s-1
sparkxy = -15+random%20,-74+0.5*(p2dist y)
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 16 + 6*(fvar(22)>=3) -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 16 + 6*(fvar(22)>=3)  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
guard.hittime =   16 + 6*(fvar(22)>=3)  -6
guard.slidetime = 16 + 6*(fvar(22)>=3)  -6

ground.velocity = - 5
air.velocity = -5.5,-6.9     +1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200) -0.5*(enemynear,pos Y > -25)-0.5*(enemynear,pos Y > -55) -0.5*(enemynear,pos Y > -75)
guard.velocity = - 10.5
airguard.velocity = -2,-1.5
ID = 1220
air.fall = 1
fall.recovertime = 180
yaccel = 0.45
;---------------------------
envshake.time = 12
envshake.ampl = 10
envshake.freq = 60


[State 210, 2]
type = HitDef
trigger1 = fvar(22) >= 3
trigger1 = animelem = 6
attr = S, SA
animtype  = hard
damage    = 50*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 60+5*fvar(22),30
hitflag = MAF
guardflag = M
pausetime = 12,14    ;  11,12
sparkno = s-1
sparkxy = -15+random%20,-74+0.5*(p2dist y)
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 16 + 6*(fvar(22)>=3) -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
ground.hittime  = 16 + 6*(fvar(22)>=3)  -1*(var(47)<-600) -2*(var(47)<-900) -3*(var(47)<-1200)
guard.hittime =   16 + 6*(fvar(22)>=3)  -6
guard.slidetime = 16 + 6*(fvar(22)>=3)  -6

ground.velocity = - 5
air.velocity = -5.5,-6.9     +1*(var(47)<-600) +1*(var(47)<-900) +1*(var(47)<-1200) -0.5*(enemynear,pos Y > -25)-0.5*(enemynear,pos Y > -55) -0.5*(enemynear,pos Y > -75)
guard.velocity = - 10.5
airguard.velocity = -2,-1.5
ID = 1220
air.fall = 1
fall.recovertime = 180
yaccel = 0.45
;---------------------------
envshake.time = 12
envshake.ampl = 10
envshake.freq = 60



;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 +55) +(random % 10) , floor(p2dist y/2 -75) -(random % 20)
postype = p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0


[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 8         ;转为普通  帮助对方还击
statetype = S
movetype = I
physics = S



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1






;-----------【测试用,必须关闭】----------------------------------------------------------------------------
;----------------------------------------------------------------------
[Statedef 1238]              ;1237 改    测试用
type = S
movetype = I;A
physics = S
anim = 1238
ctrl = 0
velset = 0,0


[State 6100, ReversalDef]
type = ReversalDef
trigger1 = animelem = 2
pausetime = 1,0  ;自己的停顿，对方的停顿    ；------------------------0,0
hitflag = M-                        ;宁可自己多停顿 ，别对方多停
hitsound = s122,0
reversal.attr = SCA,AA,AT
numhits = 0
getpower = 0
ignorehitpause = 1
persistent = 0
;p1stateno = 215
p2stateno = 13213  ; 浮空   测试用即死


;---------------------[]
[state destroyself]
type = destroyself
trigger1 = animelem = 3
trigger2 = time > 5
;trigger3 = root,movetype = H   -----【测试用,必须关闭】-



;----------------------------------------------------------------------
;----------------------------------------------------------------------
;----------------------------------------------------------------------
[Statedef 1237]              ;1230  挡身专用
type = S
movetype = I;A
physics = S
anim = 1237
ctrl = 0
velset = 0,0


[State 6100, ReversalDef]
type = ReversalDef
trigger1 = animelem = 2
pausetime = 1,0  ;自己的停顿，对方的停顿    ；------------------------0,0
hitflag = M-                        ;宁可自己多停顿 ，别对方多停
hitsound = s122,0
reversal.attr = SCA,AA,AT
numhits = 0
getpower = 0
ignorehitpause = 1
persistent = 0
;p1stateno = 215
p2stateno = 3211  +2  ; 浮空


;---------------------[]
[state destroyself]
type = destroyself
trigger1 = animelem = 3
trigger2 = time > 5
trigger3 = root,movetype = H


;---------------------------------------------------------------------------
;【蓄力 C 】
[Statedef 1230]
type    = S
movetype= I
physics = S
juggle  = 1
poweradd= 50
ctrl = 0
velset = 0,0
anim = 1230


;----------- 【添加Helper】 --------  当身 增加攻击面
[state a]
type = Helper
triggerall = 1
trigger1 = fvar(22)>=5              ;狂中
trigger1 = NumHelper(1237) = 0           ;本身不存在
trigger1 = animelemtime(13) > 0  && animelemtime(16) < 0
trigger1 =( (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) )  = [-35,35]
trigger1 = p2bodydist y = [-85,85]
sprpriority = 2
pos = 15, -20
postype = p1
stateno = 1237
id = 1237
helpertype = normal
pausemovetime = 9999
supermovetime = 9999
keyctrl = 0
ownpal = 1
IgnoreHitPause = 1
;Persistent = 0


[State 810, ];  AttackDist 修正    闪现时 没有攻击距离
type = AttackDist
trigger1 = animelem = 1
value = 0


[State 810, ];  AttackDist 修正
type = AttackDist
trigger1 = animelem = 11   + 1*(fvar(22)>=3 )
value = 100


[State 0, NotHitBy]                                      ;13-14有攻击
type = NotHitBy
trigger1 = animelemtime(16) < 0
value = SCA
time = 2                ;+    ceil(0.7*fvar(22))          ;0.7-1.1
ignorehitpause =  1



[State 0, NotHitBy]                                      ;狂   命中对手后 进入无敌
type = NotHitBy
trigger1 = fvar(22) >= 3
trigger1 = fvar(19) > 0  ;对方挨打
trigger1 = movehit
value2 = SCA
time = 2
ignorehitpause =  1




[State 600, 1];
type = PlaySnd
trigger1 = Time = 1
value = 8000, 5

[State 200, 5]
type = PlaySnd
trigger1 = animelem = 12     ;电流
value = 8000,12

[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  time = 1
value = 9000,0 +(Random%3)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0


[State 200, 1];   WIND
type = PlaySnd
trigger1 = animelem = 12;
value = 500, 2



[State 210, Width];画面端の押しし判定
type = Width
trigger1 =  animelem = 1
edge = 1,1


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 18
edge = 5,5


 [State 0, StateTypeSet]           ;转为攻击
type = StateTypeSet
trigger1 =  animelem = 11
statetype = S       ;S,A,C,L
movetype = A        ;I,A,H
physics = S         ;A,C,S,N
;ignorehitpause =
;persistent =


 [State 0, StateTypeSet]               ;转为普通
type = StateTypeSet
trigger1 =  fvar(22) = 1      ;---------帮助 凶级反击
trigger1 =  animelem = 18

trigger2 =  fvar(22) >=3      ;---------延缓 狂级反击
trigger2 =  animelem = 20

statetype = S       ;S,A,C,L
movetype = I        ;I,A,H
physics = S         ;A,C,S,N
;ignorehitpause =
;persistent =

[State 0, PlayerPush]
type = PlayerPush
trigger1 = time > 2
trigger1 = animelemtime(18) <0
value = 0
;ignorehitpause =
;persistent =

[State 0, PlayerPush]
type = PlayerPush
trigger1 = animelemtime(18) >=0
value = 1
;ignorehitpause =
;persistent =

;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = animelem = 1
anim = 8233       ;
pos = -5,-70
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = -1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0




;-----------------------ADD          移动产生火焰特效
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelemtime(11) = 0;7
anim = 2208        ;
pos = 15,-5
scale = 0.75,0.5
postype = P1
ownpal = 1
id =  2208               ;
facing = 1
bindtime = 1
sprpriority = 2
vel = 1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0

;-----------------------ADD          幻影分身
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelemtime(9) = 0;7
anim = 1239       ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 0
id = 1231               ;
facing = 1
bindtime = 1
sprpriority = -2
vel = 2,0
accel = -0.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD          幻影分身
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelemtime(1) = 1;7
anim = 1239       ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 0
id = 1231               ;
facing = 1
bindtime = 1
sprpriority = -2
vel = 6,0
accel = -0.3,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD            刀光
[State 2001]
type = Explod
trigger1 = animelem =13 ;7
anim = 8123        ;
pos = 30,40
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8123               ;
bindtime = -1
sprpriority = 5
;vel = -0.5,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0







[State 1000, 4]
type = PosAdd
trigger1 = 0
trigger1 = AnimElem = 10
x = ( (  (enemynear,pos x - pos x)*facing  )  + 75) ;- 40*( enemynear,movetype = H )      ;+25+25
y = 0


;--------------------速度          ;启动
[state a]
type = velset
trigger1 = animelem = 1
x = 26 + (  (enemynear,pos x - pos x)*facing  )/11  ;15

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 11
x = 0

;--------------------速度         ;反向启动
[state a]
type = velset
trigger1 = animelem = 12
x = 12  + 3*(p2dist x >0) + 3*(p2dist x > 50)  ;+ 1*fvar(22)

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 18
x = 0

;--------------------速度
[state a]
type = velmul
trigger1 = vel x !=[-0.5,0.5]
x = 0.95     -0.15*  (  (enemynear,pos x - pos x)*facing      < 0  &&  animelemtime(12)> 0)



;-----------------------------------------------------


[State 210, 2]                              ;f 1230
type = HitDef
;trigger1 = fvar(22) >= 5
trigger1 = animelem = 13
attr = S, SA
animtype  = hard
damage    = 60*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 60+5*fvar(22),30
hitflag = MAF
guardflag = M
pausetime = 5,15  ;  11,12
sparkno = s-1
sparkxy = -15+random%20,-74+0.5*(p2dist y)
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 23
ground.hittime  = 23

ground.velocity = 0.4*(1-2*( (enemynear,pos x - pos x)*facing  > 0)),-6 - 1*(enemynear,pos y > -25) - 1*(enemynear,pos y > -50) - 1*(enemynear,pos y > -75) ;-7
air.velocity = 0.4*(1-2*( (enemynear,pos x - pos x)*facing  > 0)),-4.5  - 1*(enemynear,pos y > -25) - 1*(enemynear,pos y > -50) - 1*(enemynear,pos y > -75) ;-6
guard.velocity = 3*(1-2*( (enemynear,pos x - pos x)*facing  > 0))
airguard.velocity =  2*(1-2*( (enemynear,pos x - pos x)*facing  > 0)),-2.5

ID = 1230
fall = 1
air.fall = 1
fall.recovertime = 120
mindist = -999,-25
maxdist = 999,25
numhits = 1;ceil(0.5*fvar(22))
yaccel = 0.40
;---------------------------




[State 210, 2]                      ;第二击       ;f 1230
type = HitDef
;trigger1 = fvar(22) >= 5
trigger1 = animelem =14
attr = S, SA
animtype  = hard
damage    = 60*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 60+5*fvar(22),30
hitflag = MAF
guardflag = M
pausetime = 13,15   ;  11,12
sparkno = s-1
sparkxy = -15+random%20,-74+0.5*(p2dist y)
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 23
ground.hittime  = 23

ground.velocity = 0.4*(1-2*( (enemynear,pos x - pos x)*facing  > 0)),-7 - 1*(enemynear,pos y > -25) - 1*(enemynear,pos y > -60)  ;-7
air.velocity = 0.4*(1-2*( (enemynear,pos x - pos x)*facing  > 0)),-6    - 1*(enemynear,pos y > -25) - 1*(enemynear,pos y > -60)  ;-6
guard.velocity = 3*(1-2*( (enemynear,pos x - pos x)*facing  > 0))
airguard.velocity =  2*(1-2*( (enemynear,pos x - pos x)*facing  > 0)),-2.5

ID = 1235
fall = 1
air.fall = 1
fall.recovertime = 120
mindist = -999,-25
maxdist = 999,25
numhits = 1;ceil(0.5*fvar(22))
;---------------------------
envshake.time = 15
envshake.ampl = 12
envshake.freq = 72
yaccel = 0.4




[State 20] ;qbg
type = targetState
trigger1 = fvar(19)>0
trigger1 = enemynear,statetype = A
trigger1 = movehit && NumTarget(1235)
value = 3229
ctrl = 0
IgnoreHitPause = 1
Persistent     = 0

;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 -5) +(random % 10) , floor(p2dist y/2 -75) -(random % 20)
postype = p1         ;p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 0, Turn]
type = Turn
;trigger1 = EnemyNear(var(55)),backedgedist > 25
trigger1 = animelemtime(10) = 0
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    < 0
ignorehitpause = 1
persistent = 0

[State 210, 5]
type =  Turn
trigger1 =0
trigger1 = AnimTime = 0



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
;【蓄力 C 】                   保留
[Statedef 1231]
type    = S
movetype= I
physics = S
juggle  = 1
poweradd= 50
ctrl = 0
velset = 0,0
anim = 1231



[State 0, NotHitBy]                                      ;14有攻击
type = NotHitBy
trigger1 = animelemtime(12+ceil(0.5*fvar(22))  )< 0
value = SCA
time = 2
ignorehitpause =  1


[State 600, 1];
type = PlaySnd
trigger1 = Time = 1
value = 8000, 5

[State 210, Width];画面端の押しし判定
type = Width
trigger1 =  animelem = 1
edge = 1,1


[State 210, Width];画面端の押しし判定
type = Width
trigger1 = animelem = 17
edge = 5,5


 [State 0, StateTypeSet]
type = StateTypeSet
trigger1 =  animelem = 11 + 1*(fvar(22) >=3)
statetype = S       ;S,A,C,L
movetype = A        ;I,A,H
physics = S         ;A,C,S,N
;ignorehitpause =
;persistent =

[State 0, PlayerPush]
type = PlayerPush
trigger1 = time > 2
trigger1 = animelemtime(17) <0
value = 0
;ignorehitpause =
;persistent =

[State 0, PlayerPush]
type = PlayerPush
trigger1 = animelemtime(17) >=0
value = 1
;ignorehitpause =
;persistent =

;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = animelem = 1
anim = 8233       ;
pos = -5,-70
scale = 1,1
postype = P1
ownpal = 1
id = 8233           ;
bindtime = -1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 999999999
supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0




;-----------------------ADD          移动产生火焰特效
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelemtime(11) = 0;7
anim = 2208        ;
pos = 15,-5
scale = 0.75,0.5
postype = P1
ownpal = 1
id =  2208               ;
facing = -1
bindtime = 1
sprpriority = 2
vel = 1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0

;-----------------------ADD          幻影分身
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelemtime(9) = 0;7
anim = 1239      ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 0
id = 1231               ;
facing = 1
bindtime = 1
sprpriority = -2
vel = 2,0
accel = -0.1,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0


;-----------------------ADD          幻影分身
[State 2001]
type = Explod
trigger1 = 1
trigger1 = animelemtime(1) = 1;7
anim = 1239       ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 0
id = 1231               ;
facing = 1
bindtime = 1
sprpriority = -2
vel = 6,0
accel = -0.3,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0



;-----------------------ADD       刀光
[State 2001]
type = Explod
trigger1 =  0
trigger1 = animelemtime(13) = 0;7
anim = 8220           ;
pos = 0,0
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8220                ;
bindtime = -1
facing = 1
sprpriority = 4
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
persistent = 0






[State 200, 5];voice
type = PlaySnd
;trigger1 = var(31) =0
trigger1 =  time = 1
value = 9000,0 +(Random%3)
;channel = 0
voulme = 511
channel = 10
lowpriority = 1
ignorehitpause = 1
persistent = 0


[State 200, 1];   WIND
type = PlaySnd
trigger1 = animelem = 12;
value = 500, 2


[State 1000, 4]
type = PosAdd
trigger1 = 0
trigger1 = AnimElem = 10
x = ( (  (enemynear,pos x - pos x)*facing  )  + 75) ;- 40*( enemynear,movetype = H )      ;+25+25
y = 0


;--------------------速度
[state a]
type = velset
trigger1 = animelem = 1
x = 28 + (  (enemynear,pos x - pos x)*facing  )/10 ; + 7

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 11
x = 0

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 12
x = -14

;--------------------速度
[state a]
type = velset
trigger1 = animelem = 17
x = 0

;--------------------速度
[state a]
type = velmul
trigger1 = vel x !=[-0.5,0.5]
x = 0.95     -0.1*  (  (enemynear,pos x - pos x)*facing      > 0  &&  animelemtime(12)> 0)


[State 210, 2]
type = HitDef
;trigger1 = fvar(22) >= 5
trigger1 = animelem = 13
attr = S, SA
animtype  = hard
damage    = 50*(1+0.1*fvar(22))
priority = 4, Hit
getpower = 60+5*fvar(22),30
guardflag = M
pausetime = 13,15   ;  11,12
sparkno = s-1
sparkxy = -15+random%20,-74+0.5*(p2dist y)
hitsound   = s510,1
guardsound = s121,0
guard.sparkno = s7010
ground.type = low
ground.slidetime = 23
ground.hittime  = 23

ground.velocity = 1.2 ,-9
air.velocity = 1.1,-7
guard.velocity = 4
airguard.velocity =  4,-2.5
ID = 1230
fall = 1
air.fall = 1
fall.recovertime = 120
mindist = -999,-25
maxdist = 999,25
numhits = ceil(0.5*fvar(22))
;---------------------------
envshake.time = 12
envshake.ampl = 10
envshake.freq = 60
yaccel = 0.45

;[State 20] ;qbg
;type = targetState
;trigger1 = movehit && NumTarget(1230)
;value = 3807
;ctrl = 0
;IgnoreHitPause = 1
;Persistent     = 0




;---------------------[火花]
[state a];
type = Helper
trigger1 = movehit
id = 7002
;name = "hit"
pos = floor(p2dist x/2 -5) +(random % 10) , floor(p2dist y/2 -75) -(random % 20)
postype = p1         ;p1
stateno = 7002
ownpal = 1
bindtime = 1
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0



[State 0, Turn]
type = Turn
;trigger1 = var(59) > 0
trigger1 = animelem = 10
trigger1 =     (  (EnemyNear(var(55)),pos x - pos x)*facing  )    > 0
;ignorehitpause = 1
;persistent = 0

[State 210, 5]
type =  Turn
trigger1 = AnimTime = 0



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1




;-------------------------以下是 【打击火花】------------------------
;----------------------------------------------------------------------------
;(HELPER) 火花 轻拳
;----------------------------------------------------------------------------
[Statedef 7000]
type = A
ctrl = 0
anim = 7000
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = root,movetype = H && root,stateno !=[120,159]
flag = invisible
ignorehitpause = 1


;---------------------[]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256


[State 00]
type = VarRandom
trigger1 = Time = 0
v = 1
range = 0,50                 ;范围


[state a]
type = angledraw
trigger1 = 1
scale = 0.5+ 0.01*var(1),0.5 + 0.01*var(1)



[state a]
type = angleset
trigger1 = 1
value = -55 + var(1)


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = time = 1 ; animelemtime(11)>0
anim = 8234      ;
pos = 0, 0 ;- 0.5*(p2dist Y)
scale = 0.5,0.5
postype = P1
ownpal = 1
id = 8234          ;
bindtime = 1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0
trigger2 = time > 20
IgnoreHitPause = 1


;----------------------------------------------------------------------------
;----------------------------------------------------------------------------
;(HELPER) 火花 轻斩
;----------------------------------------------------------------------------
[Statedef 7001]
type = A
ctrl = 0
anim = 7001
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = root,movetype = H && root,stateno !=[120,159]
flag = invisible
ignorehitpause = 1

;---------------------[]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256


[State 00]
type = VarRandom
trigger1 = Time = 0
v = 1
range = 0,60                 ;范围


[state a]
type = angledraw
trigger1 = 1
scale = 0.7+ 0.01*var(1),0.5 + 0.01*var(1)



[state a]
type = angleset
trigger1 = 1
value = -55 + var(1)


;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = time = 1 ; animelemtime(11)>0
anim = 8234      ;
pos = 0, 0 ;- 0.5*(p2dist Y)
scale = 0.75,0.75
postype = P1
ownpal = 1
id = 8234          ;
bindtime = 1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0



;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0
trigger2 = time > 20
IgnoreHitPause = 1

;----------------------------------------------------------------------------
;----------------------------------------------------------------------------
;(HELPER) 火花 中斩
;----------------------------------------------------------------------------
[Statedef 7002]
type = A
ctrl = 0
anim = 7002
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = root,movetype = H && root,stateno !=[120,159]
flag = invisible
ignorehitpause = 1


;---------------------[]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256


[State 00]
type = VarRandom
trigger1 = Time = 0
v = 1
range = 0,70                ;范围


[state a]
type = angledraw
trigger1 = 1
scale = 0.9+ 0.01*var(1),0.5 + 0.01*var(1)



[state a]
type = angleset
trigger1 = 1
value = -55 + var(1)



;-----------------------ADD        黑圈
[State 2001]
type = Explod
trigger1 = time = 1 ; animelemtime(11)>0
anim = 8234      ;
pos = 0, 0 ;- 0.5*(p2dist Y)
scale = 1,1
postype = P1
ownpal = 1
id = 8234           ;
bindtime = 1
sprpriority = -5
;removetime = 30
velocity = 0,0
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
;pausemovetime = 999999999
;supermovetime = 999999999
IgnoreHitPause = 1
persistent = 0


;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0
trigger2 = time > 20
IgnoreHitPause = 1

;----------------------------------------------------------------------------
;----------------------------------------------------------------------------
;(HELPER) 火花 轻拳  大
;----------------------------------------------------------------------------
[Statedef 7005]
type = A
ctrl = 0
anim = 7000
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = root,movetype = H && root,stateno !=[120,159]
flag = invisible
ignorehitpause = 1

;---------------------[]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256


[State 00]
type = VarRandom
trigger1 = Time = 0
v = 1
range = 0,90                 ;范围


[state a]
type = angledraw
trigger1 = 1
scale = 1.1+ 0.01*var(1),1.1 + 0.01*var(1)



[state a]
type = angleset
trigger1 = 1
value = -55 + var(1)



;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0
trigger2 = time > 20
IgnoreHitPause = 1




;----------------------------------------------------------------------------
;(HELPER) 火花 枪击
;----------------------------------------------------------------------------
[Statedef 7006]
type = A
ctrl = 0
anim = 7006
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = root,movetype = H && root,stateno !=[120,159]
flag = invisible
ignorehitpause = 1

;---------------------[]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256


[State 00]
type = VarRandom
trigger1 = Time = 0
v = 1
range = 0,90                 ;范围


[state a]
type = angledraw
trigger1 = 1
scale = 0.5+ 0.01*var(1),0.5 + 0.01*var(1)



[state a]
type = angleset
trigger1 = 1
value = -55 + var(1)


;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0
trigger2 = time > 20
IgnoreHitPause = 1



;----------------------------------------------------------------------------
;(HELPER) 火花 冲拳  大   爆炸
;----------------------------------------------------------------------------
[Statedef 7007]
type = A
ctrl = 0
anim = 2209
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = root,movetype = H && root,stateno !=[120,159]
flag = invisible
ignorehitpause = 1


;---------------------[]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256


[State 00]
type = VarRandom
trigger1 = Time = 0
v = 1
range = 0,50                 ;范围


[state a]
type = angledraw
trigger1 = 1
scale = 1.1+ 0.01*var(1),1.1 + 0.01*var(1)



[state a]
type = angleset
trigger1 = 0;1
value = -55 + var(1)





;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0
trigger2 = time > 38
IgnoreHitPause = 1




;----------------------------------------------------------------------------
;(HELPER) 空间震 警报  01
;----------------------------------------------------------------------------
[Statedef 7507]
type = A
ctrl = 0
anim = 7507
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = root,movetype = H && root,stateno !=[120,159]
flag = invisible
ignorehitpause = 1

;---------------------[]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256


[State 0, Turn]
type = Turn
trigger1 = facing = -1
;ignorehitpause =
;persistent =

;[State 00]
;type = VarRandom
;trigger1 = Time = 0
;v = 1
;range = 0,50                 ;范围


[state a]
type = angledraw
trigger1 = 1
scale = 1.5,1.5 ;.1+ 0.01*var(1),1.1 + 0.01*var(1)

[State 0, VelSet]
type = VelSet
trigger1 =  1
x = 0.5 -1*(pos y > -100)




[state a]
type = angleset
trigger1 = 0;1
value = -25; + var(1)


;---------------------[]
[state a]
type = destroyself
trigger1 = time > 209
IgnoreHitPause = 1


;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
;---------------------------------------------------------------------------
;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
[Statedef 32000];   jilu
anim = 9998
ctrl = 0

[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = 1
flag = NoShadow
flag2 = invisible
flag3 = noautoturn
;flag4 = nostandguard
;flag5 = nocrouchguard
;flag6 = noairguard

[State 32000, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 10000,{s]
type=selfstate
trigger1=!ishelper
value=0

[State 0, Turn]
type = Turn
trigger1 =  facing = root,facing
;ignorehitpause =
;persistent =

[State 0, PosSet]                        ;前
type = PosSet
trigger1 = 1
x = root,pos x + 75*(facing)*(-1)
y = 25
;ignorehitpause =
;persistent =

[state a]
type = angledraw
trigger1 = 1
scale = 0.25,0.25

;================================ [reversal record]============

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H
var(2) = 2
ignorehitpause = 1

 [State -3, ]
type = Varadd
trigger1 = roundstate = 2
trigger1 = root,movetype = H   && root,stateno !=[150,159]
var(2) = -1
ignorehitpause = 1

[State -3, ]
type = Varadd
triggerall = 1
trigger1 = var(3) < 59
trigger1 = roundstate = 2
trigger1 = root,movetype != H
;trigger1 = stateno = [5000, 5299]
trigger1 = root,var(20)>0
var(3) = 1
ignorehitpause = 1

;----------------------------------------------------------------------------------------------
;================================ [cooldown record]============

;------------------------- ;800  or 1800-------------------  对脱离人物的记录

[State -3, ]
type = VarSet
trigger1 = var(6) <= 0            ;< 2000    ;!= 2400
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 800 ||  root,stateno = 1800     ;800  or 1800
var(6) = 2400
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(6)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 800  &&  root,stateno != 1800     ;800  or 1800
var(6) = -1
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 = var(6)>0
trigger1 = roundstate = 2
trigger1 = EnemyNear(var(55)),stateno = 5120   ;敌人起身时 清空CD 因为大概没有脱离
var(6) = 0
ignorehitpause = 1


;---------------------------800 不要对倒地的人用-----------------
[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 =enemynear,stateno = [5000, 5299]
var(7) = 15
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(7)>0
trigger1 = roundstate = 2
trigger1 = enemynear,stateno != [5000, 5299]
var(7) = -1
ignorehitpause = 1


;---------------------------800-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 800
var(8) = 30
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(8)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 800
var(8) = -1
ignorehitpause = 1


;---------------------------600 - 52  CD-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,prevstateno = 600
trigger1 = root,stateno = 52;100
var(9) = 25  ;30
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(9)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
;trigger1 = root,prevstateno = 100
trigger1 = root,stateno != 52;100
var(9) = -1
ignorehitpause = 1







;---------------------------100 前冲CD-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,prevstateno = 100
trigger1 = root,stateno = 52;100
var(10) = 25  ;30
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(10)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
;trigger1 = root,prevstateno = 100
trigger1 = root,stateno != 52;100
var(10) = -1
ignorehitpause = 1




;---------------------------1200-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1200
var(11) = 120
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(11)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1200
var(11) = -1
ignorehitpause = 1



;---------------------------1020-------------------     黑暗球

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1020
var(12) = 240
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(12)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1020
var(12) = -1
ignorehitpause = 1


;---------------------------1020-------------------         黑暗球    被破

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = var(13) < 7200
trigger1 = root,movetype = H
trigger1 = root,stateno != [120,159]
trigger1 = var(12) = [237,240]
;trigger1 = root,prevstateno = 1020
var(13) = 7200
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(13)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
;trigger1 = root,stateno != 1020
var(13) = -1
ignorehitpause = 1



;---------------------------1010-------------------  小崩

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1010
var(14) = 300     ; cd = 300f
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(14)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1010
var(14) = -1
ignorehitpause = 1




;---------------------------1105-------------------  后跳

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1105
var(15) = 600   -240     ; cd = 600f
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(15)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1105
var(15) = -1
ignorehitpause = 1

;---------------------------106-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 106
var(16) = 120
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(16)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 106
var(16) = -1
ignorehitpause = 1

;---------------------------790------------------  小冷却 以防200

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 790
var(17) = 30
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(17)>0
trigger1 = roundstate = 2
trigger1 = root,stateno != 790
var(17) = -1
ignorehitpause = 1





;---------------------------750-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 750
var(18) = 360   - 20*ceil(root,fvar(22)) -50*((root,life/root,lifemax)<0.85) -50*((root,life/root,lifemax)<0.55) -50*((root,life/root,lifemax)<0.35)
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(18)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 750
var(18) = -1
ignorehitpause = 1

;--------------------------;--------------------------;--------------------------;--------------------------
;---------------------------790------------------    【脱离】的CD
[State -3, ]
type = VarSet
;trigger1 = 0
triggerall = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
triggerall = root,stateno = 790
trigger1 = 1
var(19)= 1080 - 70*ceil(root,fvar(22))      ;1100  ,70
ignorehitpause = 1


[State -3, ]
type = VarSet
triggerall = roundstate = 2
triggerall = root,stateno = 790
triggerall = root,fvar(22)>=5
triggerall = root,palno = [10,12]                ;最高强度时，允许缩短【脱离】冷却
trigger1 = (root,life / root,lifemax)  <0.7
trigger1 = var(56)<800
trigger2 = (root,life / root,lifemax)  <0.55
trigger2 = var(56)<1100
trigger3 = (root,life / root,lifemax)  <0.4
trigger3 = var(56)<1500
var(19)= 480
ignorehitpause = 1



[State -3, ]
type = Varadd
trigger1 = var(19)>0
trigger1 = roundstate = 2
trigger1 = root,stateno != 790
var(19) = -1
ignorehitpause = 1




;---------------------------2000-----------------     连段用 三代IPONE

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 2000
trigger1 = root,time > 2
var(20) = 900
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(20)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 2000
var(20) = -1
ignorehitpause = 1


;---------------------------2000-----------------     立回用 三代IPONE

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 2000
trigger1 = root,time > 2
var(21) = 240
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(21)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 2000
var(21) = -1
ignorehitpause = 1

;---------------------------2200-----------------      冲拳

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 2200
var(22) = 1200    -120
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(22)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 2200
var(22) = -1
ignorehitpause = 1


;---------------------------1230-------------------    闪步上挑

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1230
var(23) = 180
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(23)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1230
var(23) = -1
ignorehitpause = 1



;---------------------------204-- or --1201---------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 204   ||  root,stateno = 1201
var(24) = 300           ;    ---骗招CD
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(24)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 204  &&  root,stateno != 1201
var(24) = -1
ignorehitpause = 1

;---------------------------2600------------------- ;尽量不要重复使用

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 2600
var(26) = 600       ;480f
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(26)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 2600
var(26) = -1
ignorehitpause = 1


;--------------------------1700------------------- ;尽量不要重复使用
[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1700   ||  root,stateno = 1708   ||  root,stateno = 1709
;        因为  -3  AI要求 小于30    所以用 25
var(27) = 25 + 30*(root,stateno = 1700) +60*(root,time > 30)+60*(root,time > 35) +60*(root,time > 40)     ;480f
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(27)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1700  &&  root,stateno != 1708  &&  root,stateno != 1709
var(27) = -1
ignorehitpause = 1

;---------------------------1000-------------------    升龙

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1000
trigger1 = root,animelem = 10   ||  root,animelem = 11      ;升龙没打中
trigger1 = EnemyNear(var(55)),movetype != H
var(30) = 18000                               ;---------其实就是 不再使用
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(30)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1000
var(30) = -1
ignorehitpause = 1


;---------------------------1000-------------------      ;升龙cd  裸凹时限制几率

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1000
var(31) = 1200
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(31)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1000
var(31) = -1
ignorehitpause = 1



;---------------------------707-------------------     前冲被动闪

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 707
var(35) = 90   - 30
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(35)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 707
var(35) = -1
ignorehitpause = 1



;---------------------------701-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 701
var(36) = 60    + 60
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(36)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 701
var(36) = -1
ignorehitpause = 1





;---------------------------700-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 700
var(37) = 60   + 60                       ;奇数是向前
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(37)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 700
var(37) = -1
ignorehitpause = 1


;---------------------------711-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 711
var(38) = 60    + 60
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(38)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 711
var(38) = -1
ignorehitpause = 1


;---------------------------710-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 710         ;奇数是向前
var(39) = 60      + 60
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(39)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 710
var(39) = -1
ignorehitpause = 1




;---------------------------400-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 400
var(40) = 60
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(40)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 400
var(40) = -1
ignorehitpause = 1



;---------------------------400-------------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 400
trigger1 = root,movecontact
var(41) = 120 ;240
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(41)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 400
var(41) = -1
ignorehitpause = 1


;---------------------------650-------------------   关系到 连段  不要用 600来接

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 650
trigger1 = numhelper(8650)>0      ;限定地波
var(45) = 90
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(45)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 650
var(45) = -1
ignorehitpause = 1


;---------------------------1610-------------------   后跳斩之后 不要接轻拳

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = root,movetype != H    ;防止与对方带入重复
trigger1 = root,stateno = 1610
var(46) = 60
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(46)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = root,stateno != 1610
var(46) = -1
ignorehitpause = 1


;---------------------------650-------------------         后跳发波    被破之后 改用600骗技能

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = var(49) < 600  ;600F
trigger1 = root,movetype = H
trigger1 = root,stateno != [120,159]
trigger1 = root,prevstateno = 650
var(49) = 600         ;600F  则10秒内 不再使用
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(49)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
;trigger1 = root,stateno != 650
var(49) = -1
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(49)> 10            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = (root,stateno =600 || root,stateno =610 )  && root,time = 3  ;当出招600,610时， 清理CD
var(49) = -1*ceil(0.9*var(49))
ignorehitpause = 1




;-----------------------------变得果断-----------------

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
trigger1 = var(50)=0
trigger1 = root,var(46)< -900
var(50) = 1
ignorehitpause = 1
;--------------------当被吊打900F之后 变得果断

;===================================================================== 计时器移植
[State 0, VarSet]
type = VarSet
trigger1 = roundstate !=2
var(56) = 0                         ;-------这里请勿修改
persistent = 1

[State 0, VarSet]
type = VarAdd
trigger1 = roundstate =2
var(56) = 1                         ;-------这里请勿修改
ignorehitpause = 1
persistent = 1



;================================[cooldown record end]==============================
[State 10000,]
Type = DestroySelf
trigger1 = roundstate > 2


;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
[Statedef 33000];                      jilu
anim = 9998
ctrl = 0




[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = 1
flag = NoShadow
flag2 = invisible
flag3 = noautoturn
;flag4 = nostandguard
;flag5 = nocrouchguard
;flag6 = noairguard



[State 32000, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 10000,{s]
type=selfstate
trigger1=!ishelper
value=0

[State 0, Turn]
type = Turn
trigger1 =  facing != root,facing
;ignorehitpause =
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = root,pos x + 75*(facing)*(-1)
y = 25
;ignorehitpause =
;persistent =

[state a]
type = angledraw
trigger1 = 1
scale = 0.25,0.25

;================================ [crush gurad record]============

[State -3, ]
type = VarSet
trigger1 = roundstate = 2
;trigger1 = root,movetype != H ||   root,stateno =[120,159]
trigger1 =  root,stateno =[120,159]
var(2) = 2
ignorehitpause = 1

 [State -3, ]                             ;递减
type = Varadd
trigger1 = roundstate = 2
trigger1 = root,movetype = H   && (root,stateno !=[150,159] )
var(2) = -1
ignorehitpause = 1

[State -3, ]                             ;归零
type = VarSet
trigger1 = roundstate = 2
;trigger1 = root,movetype != H ||   root,stateno =[120,159]
trigger1 =  (root,stateno !=[120,159])   && root,movetype != H
var(2) = 0
ignorehitpause = 1

[State -3, ]
type = Varadd
triggerall = 0     ;   -------off
trigger1 = var(3) < 59
trigger1 = roundstate = 2
trigger1 = root,movetype != H
;trigger1 = stateno = [5000, 5299]
trigger1 = root,var(20)>0
var(3) = 1
ignorehitpause = 1



;-----------------------------------------------------------------
;记录过的对方投技账号
[State -3, ]
type = VarSet
trigger1 =  var(7)  = 0
trigger1 = roundstate = 2
trigger1 = Enemy,HitDefAttr = SCA,AT            ; 投技记录的 第1槽
var(7) = enemynear,stateno
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 =  var(8)  = 0
trigger1 = roundstate = 2
trigger1 = Enemy,HitDefAttr = SCA,AT            ; 投技记录的 第2槽
trigger1 = enemynear,stateno != var(7)
var(8) = enemynear,stateno
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 =  var(9)  = 0
trigger1 = roundstate = 2
trigger1 = (root,stateno = [120,159] )  ||  (root,prevstateno = [120,159] )
trigger1 = Enemy,HitDefAttr = SCA,AT
trigger1 = enemynear,prevstateno != var(7)       ; 这里是前一个动作， 提早防御反击，防止0帧投
trigger1 = enemynear,prevstateno != var(8)
var(9) = enemynear,prevstateno
ignorehitpause = 1

;--------归零------------------------------------
[State -3, ]
type = VarSet
trigger1 =  var(8)  != 0
trigger1 =  var(8)  = var(7)
var(8) = 0
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 =  var(9)  != 0
trigger1 =  var(9)  = var(7)   ||  var(9)  = var(8)
var(9) = 0
ignorehitpause = 1


;=========================================;=========================================


;================================ [crush gurad record]============          jilu


[State -3, ]
type = VarSet
trigger1 = var(11) = 0
trigger1 = var(2)>0
;trigger1 = helper(33000),var(2)>0
trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(11) = root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 = var(11) != 0  &&  var(12) = 0
trigger1 = var(2)>0
;trigger1 = helper(33000),var(2)>0
trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(12) =  root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 = var(11) != 0  &&  var(12) != 0   &&  var(13) = 0
trigger1 = var(2)>0
;trigger1 = helper(33000),var(2)>0
trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(13) =  root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1



[State -3, ]
type = VarSet
trigger1 =  var(12) != 0
trigger1 = var(12) = var(11)
var(12) = 0
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 =  var(13) != 0
trigger1 = var(13) = var(12)  ||  var(13) = var(11)
var(13) = 0
ignorehitpause = 1


;----------------
[State -3, ]
type = VarSet
trigger1 =  0 ;--------------------测试用   off
trigger1 =  var(1) = 0
var(11) = 270
ignorehitpause = 1

;================================ [end]============

;================================ [被直接攻击 记录]============


[State -3, ]
type = VarSet
trigger1 = var(21) = 0
;trigger1 = var(2)=0
;trigger1 = helper(33000),var(2)>0
trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(21) = root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 = var(21) != 0  &&  var(22) = 0
;trigger1 = var(2)=0
;trigger1 = helper(33000),var(2)>0
trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(22) =  root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 = var(21) != 0  &&  var(22) != 0   &&  var(23) = 0
;trigger1 = var(2)=0
;trigger1 = helper(33000),var(2)>0
trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(23) =  root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 = var(21) != 0  &&  var(22) != 0   &&  var(23) != 0  &&  var(24) = 0

trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(24) = root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 = var(21) != 0  &&  var(22) != 0   &&  var(23) != 0  &&  var(24) != 0  &&  var(25) = 0

trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(25) =  root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 = var(21) != 0  &&  var(22) != 0   &&  var(23) != 0  &&  var(24) != 0  &&  var(25) != 0 &&  var(26) = 0

trigger1 = roundstate = 2
trigger1 = root,movetype = H &&  root,stateno != [150,159]
var(26) =  root,var(38)    ;enemynear,stateno             ;考虑到自己被暂停所以如此
ignorehitpause = 1

;-----------------------

[State -3, ]
type = VarSet
trigger1 =  var(22) != 0
trigger1 = var(22) = var(21)
var(22) = 0
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 =  var(23) != 0
trigger1 = var(23) = var(22)  ||  var(23) = var(21)
var(23) = 0
ignorehitpause = 1

[State -3, ]
type = VarSet
trigger1 =  var(24) != 0
trigger1 = var(24) = var(23)  ||  var(24) = var(22)  ||  var(24) = var(21)
var(24) = 0
ignorehitpause = 1


[State -3, ]
type = VarSet
trigger1 =  var(25) != 0
trigger1 = var(25) = var(24)  ||  var(25) = var(23)  ||  var(25) = var(22)  ||  var(25) = var(21)
var(25) = 0
ignorehitpause = 1


[State -3, ]
type = VarSet
trigger1 =  var(26) != 0
trigger1 = var(26) = var(25)  ||  var(26) = var(24)  ||  var(26) = var(23)  || var(26) = var(22)  ||  var(26) = var(21)
var(26) = 0
ignorehitpause = 1


;=========================================



;-----  helper(33000),var(55) = 敌人 防御 时  解除缓冲-------------------
;----------------------------------------------

[State -3, ]
type = VarSet
trigger1 =  var(55)  != 15
trigger1 = roundstate = 2
trigger1 = enemynear,stateno = [150,159]
var(55) = 15
ignorehitpause = 1

[State -3, ]
type = Varadd
trigger1 = var(55)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
trigger1 = enemynear,stateno != [150,159]
var(55) = -1
ignorehitpause = 1
;-----------------------------------------------

[State 10000,]
Type = DestroySelf
trigger1 = roundstate > 2




;=========================================;=========================================
;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
[Statedef 35000];                     堆放杂物
anim = 9998
ctrl = 0


;----------------------   起盾     + 消去 盾特效
[State -2]
type = Explod
triggerall = 1
trigger1 = root,stateno = [1700,1701]
trigger1 = numExplod(1720) =0
anim = 1720     ;
id = 1720
pos = -20 +5 ,-60
scale = 0.5,0.5
postype = P1
ownpal = 1
bindtime = -1
;removetime = 20
sprpriority = 3
;ontop = 1
removeongethit = 1
supermovetime = 9999
pausemovetime = 9999
IgnoreHitPause = 1
;persistent = 0


[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = root,stateno != [1700,1701]
trigger2 = root,movetype = H
trigger3 =  facing != root,facing
id = 1720
ignorehitpause = 1
;persistent =


;----------------------   起盾     + 消去 盾特效
[State -2]
type = Explod
triggerall = 1
trigger1 = root,stateno = [120,159]
trigger1 = numExplod(1722) =0
anim = 1722   -2   ;
id = 1722
pos = -20 +5 ,-60
scale = 0.5,0.5
postype = P1
ownpal = 1
bindtime = -1
;removetime = 20
sprpriority = 3
;ontop = 1
removeongethit = 1
supermovetime = 9999
pausemovetime = 9999
IgnoreHitPause = 1
;persistent = 0


[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = root,stateno != [120,159]
trigger2 =  facing != root,facing
id = 1722
ignorehitpause = 1
;persistent =



[State 32000, AssertSpecial]
type = AssertSpecial
Trigger1 = 1
flag = NoShadow
flag2 = invisible
flag3 = noautoturn
;flag4 = nostandguard
;flag5 = nocrouchguard
;flag6 = noairguard
ignorehitpause = 1


[State 32000, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1

[State 10000,{s]
type=selfstate
trigger1=!ishelper
value=0
ignorehitpause = 1

[State 0, Turn]
type = Turn
trigger1 =  facing != root,facing
ignorehitpause = 1
;persistent =

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = root,pos x + 5*(facing)*(-1)     ;相差3  在后边  可以防止坑AI
y = root,pos y
ignorehitpause = 1
;persistent =

[state a]
type = angledraw
trigger1 = 1
scale = 0.25,0.25
ignorehitpause = 1
;-----------------------------------------------

[State 10000,]
Type = DestroySelf
trigger1 = roundstate > 2
ignorehitpause = 1


;---------------------------------------------------------------------------


;---------------------------------------------------------------------------


;---------------------------------------------------------------------------



;---------------------------------------------------------------------------

;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; Varのラウンド持ち越し
[Statedef 5900]
type = S

[State 5900, 1] ;Clear all int variables                 var变量归零
type = VarRangeSet
trigger1 = roundsexisted = 0
farst = 2
last = 59
value = 0

[State 5900, 2] ;Clear all float variables              fvar变量归零
type = null;VarRangeSet
trigger1 = roundsexisted = 0
fvalue = 0

[State 5900, 3] ;Intro for round 1                    仅第一回合 自我介绍
type = ChangeState
trigger1 = roundno = 1
value = 190


[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; 下面是 -2 的部分
;---------------------------------------------------------------------------
[Statedef -2]

;============================================================================================================
;-------------【强度控制总表】-------------Fvar(22)关系到  出招概率，霸体层数，无敌时间，等
;============================================================================================================

[State -2, 根据色表调整攻击力]                ; 凶上
type = VarSet
trigger1 = palno = [1,3]
fvar(22) = 1
IgNoreHitPause = 1

[State -2, 根据色表调整攻击力]                ;  狂下
type = VarSet
trigger1 = palno = [4,6]
fvar(22) = 3 +(1*(Life<LifeMax*0.5))
IgNoreHitPause = 1

[State -2, 根据色表调整攻击力]                  ;狂中 1
type = VarSet
trigger1 =  palno = [7,12]
fvar(22) = 5 +(1*(Life<LifeMax*0.5))
IgNoreHitPause = 1

;[State -2, 根据色表调整攻击力]                  ;狂中 2
;type = VarSet
;trigger1 =  palno = [10,12]
;fvar(22) = 6 ;+(1*(Life<LifeMax*0.5))
;IgNoreHitPause = 1

[state -2]                     ;防止橙俗量操作，某某量在A定外r重置量
type = varset
TriggerAll = (!IsHelper)
trigger1 = fvar(22) != [1,6]
fvar(24) = 6
IgNoreHitPause = 1


;=======================================================
;-------------------以下是 【空中2次跳跃】--------------
;=======================================================
;----------------------------------------------------------------------
;----------------------------------------------------------------------
; Air Jump / Air Dash                              airair

[State -2, VarSet];Air Jump flag initialize         空中双跳限制  归零
type = VarSet
trigger1 = StateType != A || StateNo = 5210
var(35) = 0

[State -2, VarSet];Air Dash flag initialize          空中冲刺限制  归零
type = VarSet
trigger1 = StateType != A || StateNo = 5210
var(36) = 0

[State -2, VarSet];Holdup detector                 空中双跳 方向键设置 累积
type = VarAdd
trigger1 = command = "holdup"
var(37) = 1

[State -2, VarSet];Holdup flag initialize           空中双跳 方向键设置 归零
type = VarSet
trigger1 = command != "holdup"
var(37) = 0




;=======================================================
;--------------以上是 空中2次跳跃 end-------------
;=======================================================

[state -2, a];右向きO定
type = varset
trigger1 = var(10) = 0
trigger1 = facing = 1
v = 10
value = 1

[state -2, a];左向きO定
type = varset
trigger1 = var(10) = 0
trigger1 = facing = -1
v = 10
value = 2

;[State -2, 1]; 停止声音
;type = stopSnd
;trigger1 = (stateno != 100)  &&  (stateno != [20,21])   &&  (stateno != [110,117])
;channel = 1


[State -2, 3]
type = stopSnd
trigger1 = MoveType = H
channel = 2


[State 0, StopSnd]
type = StopSnd
trigger1 = stateno !=1200
channel = 12
;ignorehitpause =
;persistent =



[State -2, 4];ハイジャンプ判定
type = varadd
trigger1 = 1
v = 15
value = -1

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;::::::::ブ`メラン
;---------------------[キャッチに移行]

;预留 ---已经删除
;[state a];立ち
;type = ChangeState
;value = 1005
;triggerall = var(3) = 1
;triggerall = statetype = S
;trigger1 = ctrl

;[state a];しゃがみ
;type = ChangeState
;value = 1006
;triggerall = var(3) = 1
;triggerall = statetype = C
;trigger1 = ctrl

;[state a];ジャンプ
;type = ChangeState
;value = 1007
;triggerall = var(3) = 1
;triggerall = statetype = A
;trigger1 = ctrl


;---------------------[涫]

;---------------------[ヘルパ`]

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;:::::::: 色表判断是否为 EX



;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;::::::::涫O定(多分ダメ`ジvSが殆ど)
[state a]
type = varset
trigger1 = movetype = H
var(13) = 0                          ;  var(13)


;::::::::ボイス涓の乱数            var(6)
[State 180, 1]
type = VarRandom
trigger1 = 1
v = 6
range = 0,2



;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;::::::::スロ`I理                    （慢镜头 处理？）

;[state -2, a];スロ`I理をするrgのカウント
;type = varadd
;trigger1 = 1
;persistent = 0
;ignorehitpause = 1
;v = 4
;value = -1

;[state -2, a];スロ`I理
;type = pause
;trigger1 = var(4) >= 1
;trigger1 = gametime % 2
;persistent = 0
;ignorehitpause = 1
;time = 1


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;ダメ`ジrのエフェクト、サウンドの消去           图像的处理，消去某些特效
;//////////////////////////////////////////////////////////////////////////
[State 1]
type = removeexplod
trigger1 = stateno != 101
ID = 102


;ダメ`ジrのサウンドの消去
[state a]
type = stopsnd
trigger1 = MoveType = H
channel = 1

;ダメ`ジrの残像の消去
[state a];
type = afterimagetime
trigger1 = MoveType = H
time = 0

;///////////////////////////////////////////////////////////////////////
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;各种 攻击 a正
;//////////////////////////////////////////////////////////////////////////
; 

[state a]                       ;778899
type = attackmulset
trigger1 = fvar(22) < 3
value =0.34-0.10*(enemy,gethitvar(hitcount)>4)-0.10*(enemy,gethitvar(hitcount)>8)-0.05*(enemy,gethitvar(hitcount)>12)-0.05*(enemy,gethitvar(hitcount)>16)-0.01*(life>lifemax*0.65)+0.2*(helper(32000),var(56)>3200)
ignorehitpause = 1

[state a]
type = attackmulset
trigger1 = fvar(22) = [3,4]
value =0.44-0.10*(enemy,gethitvar(hitcount)>4)-0.10*(enemy,gethitvar(hitcount)>8)-0.10*(enemy,gethitvar(hitcount)>12)-0.10*(enemy,gethitvar(hitcount)>16)-0.02*(life>lifemax*0.65)+0.4*(helper(32000),var(56)>3200)
ignorehitpause = 1

[state a]
type = attackmulset
trigger1 = fvar(22) >= 5     ;超过50秒后  连击修正减轻，提高效率
trigger1 = palno = [7,9]         ; 狂中部分 削弱
value =0.54-0.10*(enemy,gethitvar(hitcount)>4)-0.10*(enemy,gethitvar(hitcount)>8)-0.10*(enemy,gethitvar(hitcount)>12)-0.15*(enemy,gethitvar(hitcount)>16)-0.03*(life>lifemax*0.65)+0.6*(helper(32000),var(56)>3200)
ignorehitpause = 1


[state a]
type = attackmulset
trigger1 = fvar(22) >= 5     ;超过50秒后  连击修正减轻，提高效率
trigger1 = palno = [10,12]        ; 狂中部分 加强
value =0.64-0.10*(enemy,gethitvar(hitcount)>4)-0.15*(enemy,gethitvar(hitcount)>8)-0.15*(enemy,gethitvar(hitcount)>12)-0.15*(enemy,gethitvar(hitcount)>16)-0.04*(life>lifemax*0.65)+0.8*(helper(32000),var(56)>3200)
ignorehitpause = 1





   ; DefenceMulSet        连段防御倍率   defm

;----------------           低P 防御调整
[State -2,DefenceMulSet]
type = DefenceMulSet
;triggerall = movetype != H
;triggerall = life != lifemax
Trigger1 = Alive && Roundstate  = 2
Trigger1 = fvar(22) < 3
value= 0.8 + 0.1*(Life/LifeMax)
ignorehitpause = 1

;----------------           中P 防御调整
[State -2,DefenceMulSet]
type = DefenceMulSet
;triggerall = movetype != H
;triggerall = life != lifemax
Trigger1 = Alive && Roundstate  = 2
Trigger1 = fvar(22) = 3
value= 0.6 + 0.2*(Life/LifeMax)
ignorehitpause = 1

;----------------           高P  防御调整
[State -2,DefenceMulSet]
type = DefenceMulSet
;triggerall = movetype != H
;triggerall = life != lifemax
Trigger1 = Alive && Roundstate  = 2
Trigger1 = fvar(22) > 3
value= 0.4 + 0.4*(Life/LifeMax)
ignorehitpause = 1




[State -2, 防御化]
Type = LifeAdd
Trigger1 = 1
Trigger1 = stateno != 1701           ;防止精防回血
Trigger1 = stateno != 750
Trigger1 = stateno != [700,711]   ;防止精防回血
Trigger1 = Life - GetHitVar(Damage) >= 1
Trigger1 = (PalNo=[1,3])&&(StateNo!=[120,159])&&(Life>=10)&&(GetHitVar(Damage))
Value = GetHitVar(Damage)*(0.04 + 0.03*(Life < 0.35*lifemax) + 0.03*(movetype=H && (stateno !=[5000,5099])) + 0.01*var(20)   )
;Kill = 0                                        ; kill= 0 防御会高很多

[State -2, 防御化]
Type = LifeAdd
Trigger1 = 1
Trigger1 = stateno != 1701           ;防止精防回血
Trigger1 = stateno != 750
Trigger1 = stateno != [700,711]   ;防止精防回血
Trigger1 = Life - GetHitVar(Damage) >= 1
Trigger1 = (PalNo=[4,6])&&(StateNo!=[120,159])&&(Life>=10)&&(GetHitVar(Damage))
Value = GetHitVar(Damage)*(0.08  + 0.06*(Life < 0.35*lifemax)+ 0.06*(movetype=H && (stateno !=[5000,5099])) + 0.02*var(20)  )
;Kill = 0                                           ; kill= 0 防御会高很多

[State -2, 防御化]
Type = LifeAdd
Trigger1 = 1
Trigger1 = stateno != 1701           ;防止精防回血
Trigger1 = stateno != 750
Trigger1 = stateno != [700,711]   ;防止精防回血
Trigger1 = Life - GetHitVar(Damage) >= 1
Trigger1 = (PalNo=[7,9])&&(StateNo!=[120,159])&&(Life>=10)&&(GetHitVar(Damage))
Value = GetHitVar(Damage)*(0.16 + 0.09*(Life < 0.35*lifemax)+ 0.09*(movetype=H && (stateno !=[5000,5099]))+ 0.03*var(20)  )
;Kill = 0                                       ; kill= 0 防御会高很多


[State -2, 防御化]
Type = LifeAdd
Trigger1 = 1
Trigger1 = stateno != 1701           ;防止精防回血
Trigger1 = stateno != 750
Trigger1 = stateno != [700,711]   ;防止精防回血
Trigger1 = Life - GetHitVar(Damage) >= 1
Trigger1 = (PalNo=[10,12])&&(StateNo!=[120,159])&&(Life>=10)&&(GetHitVar(Damage))
Value = GetHitVar(Damage)*(0.22 + 0.12*(Life < 0.35*lifemax)+ 0.12*(movetype=H && (stateno !=[5000,5099]))+ 0.04*var(20)  )
;Kill = 0



;---------------------------------------------------------------------------
;---------------------------------------------------------------------------

;[Statedef -3]
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;//////////////////////////////////////////////////////////////////////////


[State -2, Landing Sound]
type = PlaySnd
triggerall = Time = 2  ;1
trigger1 = stateno = 52 
trigger2 = stateno = 107 
value = 40, 0
channel = 5
lowpriority = 1

[State -2, 2]; 普通起跳 音效
type = PlaySnd
triggerall = time = 1
trigger1 = stateno = [36,40]
trigger1 = var(15) <= 0
value = 40, 1

[State -2, 2]; 大跳起跳 音效
type = PlaySnd
triggerall = time = 1
trigger1 = stateno = [36,40]
trigger1 = var(15) > 1
value = 40, 2

[State -2, Landing Sound]      ; 后跳起跳 音效
type = PlaySnd
triggerall = Time = 1
;trigger1 = stateno = 100 
trigger1 = stateno = 105 
trigger2 = stateno = 1105
value = 105, 0
channel = 5
lowpriority = 1

 ;---------
[State 200, 5];voice    死亡
type = PlaySnd
trigger1 = var(33) =0            ;var(33) 防止 死亡语音 重复
trigger1 = !alive && (!ishelper)
trigger1 = var(33) := 1    ||  1
value = 9515,0
;channel = 0
;voulme = 440
channel = 4
lowpriority = 1
ignorehitpause = 1
persistent = 0
;---------


;------------------  removeexplod   ------------------------------------------
;落地刀光消除
[State 1]
type = removeexplod
triggerall = pos y >= 0
trigger1 = stateno != 52 && stateno !=610
trigger2 = stateno = 52 && time > 2
ID = 8610
IgnoreHitPause = 1

;落地刀光消除
[State 1]
type = removeexplod
triggerall = pos y >= 0
trigger1 = stateno != 52 && stateno !=620
trigger2 = stateno = 52 && time > 2
ID = 8620
IgnoreHitPause = 1

;非集气时  取消特效
[State 1]
type = removeexplod
trigger1 = stateno != 1200
ID = 1209
IgnoreHitPause = 1


[state a];残像消去
type = afterimagetime
trigger1 = movetype = H
time = 0
;IgnoreHitPause = 1


;[State 210, Width];画面端の押しし判定
;type = Width
;trigger1 = 1
;edge = 5,0



;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; 【大跳】                                jump
[State -2, 5];【大跳】 判定
type = varset
trigger1 = stateno = 10
trigger1 = time = 0
trigger2 = stateno = 100
v = 15
value = 20

[State -2, 5]; 落地  归零
type = varset
trigger1 = stateno = 52
trigger1 = time = 0
v = 15
value = 0

; 【小跳】
[State -2, 5];【小跳】判定
type = varset
trigger1 = !var(59)
trigger1 = stateno = 40
trigger1 = command != "holdup"
;trigger2 = var(59) >= 1
v = 16
value = 1




[State -2, 5];落地  归零
type = varset
trigger1 = !var(59)
trigger1 = stateno = 40
trigger1 = command = "holdup"
;trigger2 = var(59) >= 1
;trigger2   = p2bodydist X = [100,256]
v = 16
value = 0


;---------------------[[设定速度]]------------------------    datiao      jump
[State -2, 5]
type = velset                     ;前跳
trigger1 = stateno = 50
trigger1 = anim = 42
trigger1 = time = 1
trigger1 = var(15) >= 1
x = 5.7
y = -10.5


[State -2, 5]                    ;后跳
type = velset
trigger1 = stateno = 50
trigger1 = anim = 43
trigger1 = time = 1
trigger1 = var(15) >= 1
x = -5.7
y = -10.5

[State -2, 5];小ジャンプ
type = veladd
trigger1 = stateno = 50
trigger1 = time = 1
trigger1 = var(16) = 1
y = 2.2;         2.1  -  2.5         ;2.3

[State -2, 5];小ジャンプ
type = velmul
trigger1 = stateno = 50
trigger1 = time = 1
trigger1 = var(16) = 1
x = 0.8;3

;---------------------------------------------------------------
[State -2, 5]
type = AfterImage
trigger1 = stateno = 50
trigger1 = time = 1
trigger1 = var(15) >= 1
time = 10
trans = add1
timegap = 1
framegap = 2
length = 8
palbright = 12,12,12
palcontrast = 225,225,225
palpostbright = 0,0,0
paladd = 0,0,0
palmul = 1,1,1




[State -2,简化快速缓冲]             ;huanchong      屏蔽0帧投
type = Nothitby
triggerall = 1            ; 开关   【on/off】
;TriggerAll = var(57) = 0   ;  非【手加减】模式
TriggerAll = stateno != [200,3999]
TriggerAll = !movereversed        ;自身被挡身时，不使用（友情）
TriggerAll = var(49) <=  ( 2   +  4*(fvar(22) >=5)   )       ;考虑对方出手时间，而并不是一直无敌
TriggerAll =  helper(33000),var(55) = 0  ||  (life < lifemax*0.65  &&  fvar(22)>= 5) ;敌人防御时，给敌人反击的机会
TriggerAll = (!IsHelper)
triggerAll = stateno != [150,159]
triggerAll = statetype != A
triggerAll = movetype != H    &&   fvar(19) = 0   ; 自身与对方都未受击
;triggerAll = (EnemyNear(var(55)),pos x - pos x)*facing  > 100
triggerAll =  var(19) < 1 + 1*  ((EnemyNear(var(55)),pos x - pos x)*facing  > 50)                    ;相对时间
;TriggerAll = var(59) > 0
triggerAll =  (  (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front)   ) > 15-6*(fvar(22)>=5)

Trigger1 = fvar(22)>= 3    ; 【强度】限定
;Trigger1 = !Enemy,HitDefAttr = SCA,AT

value = ,AT
;value2 = SCA
time = 1
ignorehitpause =1
;persistent = 1




[State -2,简化快速缓冲]             ;huanchong      屏蔽 攻击框过长 技能
type = Nothitby
triggerall = 1            ; 开关   【on/off】
;TriggerAll = var(57) = 0   ;  非【手加减】模式
TriggerAll = stateno != [200,3999]
TriggerAll = !movereversed        ;自身被挡身时，不使用（友情）
TriggerAll = var(49) <=  ( 2   +  4*(fvar(22) >=5)   )       ;考虑对方出手时间，而并不是一直无敌
TriggerAll =  helper(33000),var(55) = 0   ||  (life < lifemax*0.65  &&  fvar(22)>= 5)  ;敌人防御时，给敌人反击的机会
TriggerAll = (!IsHelper)
triggerAll = stateno != [150,159]
triggerAll = statetype != A
triggerAll = movetype != H    &&   fvar(19) = 0   ; 自身与对方都未受击
triggerAll = (EnemyNear(var(55)),pos x - pos x)*facing  > 100
triggerAll =  var(19) < 1 + 1*  ((EnemyNear(var(55)),pos x - pos x)*facing  > 50)               ;【相对时间】
TriggerAll = var(59) > 0
triggerAll =  (  (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front)   ) > 15-6*(fvar(22)>=5)

Trigger1 = fvar(22)>= 5       ; 【强度】限定

;value = ,AT
value2 = SCA
time = 1
ignorehitpause =1
;persistent = 1



;==========;==========;==========;==========;==========


;=======================================
;------------【1000以下 被击回气】---------------
;=======================================
[State -2, POWER]     ;  开场时给予 一定 POWER
type = Powerset
triggerall = Alive
triggerall = RoundState = [0,1]
triggerall = power <  200*fvar(22) -100
trigger1 =  1;palno = [4,12]
value = 200*fvar(22) - 75
ignorehitpause = 1
persistent = 0


[State -2, POWER]   ; 平时  回POWER速度     778899
type = poweradd
triggerall = Alive   && (!IsHelper)
triggerall = RoundState = 2
triggerall = power < 4500
;trigger1 = StateType != L
;trigger1 = MoveType = H
trigger1 = gametime % 5 = 0
value =  ceil(1.5*fvar(22)) + ceil(0.5*fvar(22))*(power<1000)
ignorehitpause = 1



[State -2, POWER]   ; 1000以下  MoveType = H 回POWER速度
type = poweradd
triggerall = Alive   && (!IsHelper)
triggerall = RoundState = 2
triggerall = power < 4500
trigger1 = StateType != L
trigger1 = MoveType = H
trigger1 = gametime % 5 = 0
trigger1 = power <= 1000

value =  fvar(22)*2           ;每秒
ignorehitpause = 1


[State -2, POWER]   ; 4500以下  MoveType = H 回POWER速度
type = poweradd
triggerall = Alive   && (!IsHelper)
triggerall = RoundState = 2
triggerall = power < 4500

trigger1 = fvar(22) >= 3
trigger1 = StateType != L
trigger1 = MoveType = H
trigger1 = gametime % 5 = 0
trigger1 = power <= 2000+1000*(fvar(22) >= 3) +2000*(fvar(22) >= 5)
value =  fvar(22)*1.0
ignorehitpause = 1


[State -2, POWER]   ; 4500以下  长时间的弹幕压制后    高P数
type = poweradd
triggerall = Alive   && (!IsHelper)
triggerall = RoundState = 2
triggerall = power < 4500

Trigger1 = var(46) > 500;1000
trigger1 = fvar(22) >= 3
trigger1 = StateType != L
trigger1 = MoveType = H
trigger1 = gametime % 5 = 0

value =  1+1*(Enemy,numproj)           ;每秒10
ignorehitpause = 1


;=======================================
;------------【Lou 连击上限】---------------        【作废】
;=======================================




;===============;===============;===============
;===============【被击时间统计】===========     var(46)
;===============;===============;===============
[State -2, 被击时间统计ATM 防御 回升]
type = Varadd
;trigger1 = gametime % 1 = 0
trigger1 = Movetype != H     &&  (stateno != 1701) ;精防
;trigger1 = stateno = [120,159]
trigger1 = var(46) > 0
v = 46
value = -1  -5*(var(46) > 5)  + 5*(stateno=[120,159])  + 5*(stateno= 1701)     ;;-------------回升
ignorehitpause =  1
;persistent =

 [State -2, 被击时间统计ATM 防御 累加]
type = Varadd
;trigger1 = (Movetype = H  ) || stateno = 120
trigger1 = ( stateno = [120,159] )    ||   (stateno = 1701)
;trigger1 = var(46) > 0
v = 46
value = 1         + 10*(var(46)<-10)       +1*(stateno = 1701)      ;防御  +1  精防+2 效果相同？
ignorehitpause =  1
;persistent =


;=============================================================================
;===============;===============;===============
 [State -2,  被击时间统计ATM被打的瞬间]
type = Varset
trigger1 = 0             ; --------[off]
trigger1 = Movetype = H
trigger1 = stateno != [120,159]
trigger1 = var(46) > 0
v = 46
value = 0
ignorehitpause =  1
;persistent =

;===============;===============;===============
[State -2, 被击时间统计ATM 被击 回升]
type = Varadd
;trigger1 = gametime % 1 = 0
trigger1 = Movetype != H       &&  (stateno != 1701) ;精防
;trigger1 = stateno = [120,159]
trigger1 = var(46) < 0
v = 46
value = 5                           ;-------------回升
ignorehitpause =  1
;persistent =

[State -2, 被击时间统计ATM 被击 累加]
type = Varadd
;trigger1 = gametime % 1 = 0
trigger1 = Movetype = H
trigger1 = (stateno != [120,159])     &&  (stateno != 1701) ;精防
;trigger1 = var(46) < 0
v = 46
value = -1       - 10*(var(46)>0)             ;挨打
ignorehitpause =  1
;persistent =

;===============;===============;===============      归零
 [State -2,  被击时间统计ATM起身归零]
type = Varset
;trigger1 = gametime % 1 = 0
;trigger1 = Movetype != H
trigger1 = stateno = 5120
trigger1 = var(46) != 0
v = 46
value = 0
ignorehitpause =  1
;persistent =







;===============;===============;===============
;===============【被击时间统计】===========     47
;===============;===============;===============
[State -2, 被击时间统计ATM平时衰减]
type = Varadd
;trigger1 = gametime % 1 = 0
trigger1 = EnemyNear(var(55)),  Movetype != H
;trigger1 = stateno = [120,159]
trigger1 = var(47) > 0
var(47) = -5  -  ceil(0.8*var(47))
ignorehitpause =  1
;persistent =

 [State -2, 被击时间统计ATM被击累加]
type = Varadd
;trigger1 = gametime % 1 = 0
trigger1 = EnemyNear(var(55)), Movetype = H
trigger1 = EnemyNear(var(55)), stateno = [120,159]
;trigger1 = var(47) > 0
var(47) = 1       + 10*(var(47)<0)                      ;防御
ignorehitpause =  1
;persistent =

;===============;===============;===============
 [State -2,  被击时间统计ATM被打的瞬间]
type = Varset
trigger1 = 0
trigger1 = EnemyNear(var(55)), Movetype = H
trigger1 = EnemyNear(var(55)), stateno != [120,159]
trigger1 = var(47) > 0
var(47) = 0
ignorehitpause =  1
;persistent =

;===============;===============;===============
[State -2, 被击时间统计ATM平时衰减]
type = Varadd
;trigger1 = gametime % 1 = 0
trigger1 = EnemyNear(var(55)), Movetype != H
;trigger1 = stateno = [120,159]
trigger1 = var(47) < 0
var(47) = 5  -  ceil(0.8*var(47))
ignorehitpause =  1
;persistent =

[State -2, 被击时间统计ATM被击累加]
type = Varadd
;trigger1 = gametime % 1 = 0
trigger1 = EnemyNear(var(55)), Movetype = H
trigger1 = EnemyNear(var(55)),  stateno != [120,159]
;trigger1 = var(47) < 0
var(47) = -1   -10*(var(47)>0)  -1*(var(47) > -600)  -2*((helper(32000),var(56)=[900,1800])&&(var(59)>0))
;persistent =                                                                 ; 挨打则-1
ignorehitpause =  1                                                           ; 如果开为 -3，则【重力保护加速】为3倍


;===============;===============;===============  归零
 [State -2,  被击时间统计ATM起身归零]
type = Varset
;trigger1 = gametime % 1 = 0
;trigger1 = Movetype != H
triggerall = var(47) != 0
trigger1 = EnemyNear(var(55)), stateno = 5120
trigger2 = EnemyNear(var(55)), stateno = 5110
var(47) = 0
ignorehitpause =  1
;persistent =


;===============;===============;=============== duanwei
;===============【 段位显示】===========
;===============;===============;===============



[State -2, Explod]            ;凶上         left
type = Explod
trigger1 = var(1)>0
;trigger1 = var(57)=0
trigger1 = var(59)>0         ;  ai - on
trigger1 = fvar(22) <= 1
trigger1 = NumExplod(7333) = 0
trigger1 = TeamSide = 1
anim = 7333       +10*(palno=[2,3])
ID = 7333
pos = 50+ var(52) ,28  + var(51)
postype = Left   ;back;
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -13
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.33
ignorehitpause = 1


[State -2, Explod]            ;凶上       right
type = Explod
trigger1 = var(1)>0
;trigger1 = var(57)=0
trigger1 = var(59)>0         ;  ai - on
trigger1 = fvar(22) <= 1
trigger1 = NumExplod(7333) = 0
trigger1 = TeamSide != 1
anim = 7333       +10*(palno=[2,3])
ID = 7333
pos = -50 - var(52) ,28  + var(51)
postype =  right
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -13
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.33
ignorehitpause = 1



[State -2, Explod]            ;狂下          left
type = Explod
trigger1 = var(1)>0
;trigger1 = var(57)=0
trigger1 = var(59)>0         ;  ai - on
trigger1 = fvar(22) = [3,4]
trigger1 = NumExplod(7334) = 0
trigger1 = TeamSide = 1
anim = 7334        +10*(palno=[5,6])
ID = 7334
pos = 50+ var(52) ,28  + var(51)
postype = Left   ;back;
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -53
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.33
ignorehitpause = 1


[State -2, Explod]            ;狂下       right
type = Explod
trigger1 = var(1)>0
;trigger1 = var(57)=0
trigger1 = var(59)>0         ;  ai - on
trigger1 = fvar(22) = [3,4]
trigger1 = NumExplod(7334) = 0
trigger1 = TeamSide != 1
anim = 7334        +10*(palno=[5,6])
ID = 7334
pos = -50 - var(52) ,28  + var(51)
postype =  right
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -53
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.33
ignorehitpause = 1



[State -2, Explod]            ;狂中       left
type = Explod
trigger1 = var(1)>0
;trigger1 = var(57)=0
trigger1 = var(59)>0         ;  ai - on
trigger1 = fvar(22) >= 5
trigger1 = NumExplod(7335) = 0
trigger1 = TeamSide = 1
anim = 7335            +10*(palno=[10,12])
ID = 7335
pos = 50+ var(52) ,28  + var(51)
postype = Left   ;back;
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -53
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.33
ignorehitpause = 1



[State -2, Explod]            ;狂中    right
type = Explod
trigger1 = var(1)>0
;trigger1 = var(57)=0
trigger1 = var(59)>0         ;  ai - on
trigger1 = fvar(22) >= 5
trigger1 = NumExplod(7335) = 0
trigger1 = TeamSide != 1
anim = 7335            +10*(palno=[10,12])
ID = 7335
pos = -50 - var(52) ,28  + var(51)
postype =  right
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -53
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.33
ignorehitpause = 1


[State -2, Explod]            ;关闭     left
type = Explod
trigger1 = var(1)>0
trigger1 = var(59)=0         ;  ai - off
;trigger1 = fvar(22) <= 1
trigger1 = NumExplod(7336) = 0
trigger1 = TeamSide = 1
anim = 7336
ID = 7336
pos = 50+ var(52) ,28  + var(51)
postype = Left   ;back;
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -53
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.33
ignorehitpause = 1


[State -2, Explod]            ;关闭    right
type = Explod
trigger1 = var(1)>0
trigger1 = var(59)=0         ;  ai - off
;trigger1 = fvar(22) <= 1
trigger1 = NumExplod(7336) = 0
trigger1 = TeamSide != 1
anim = 7336
ID = 7336
pos = -50- var(52) ,28  + var(51)
postype = right
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -53
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.33
ignorehitpause = 1


[State 0, RemoveExplod]
type = RemoveExplod
trigger1 =  var(59)>0         ;  ai - on
trigger2 = 0;var(1)=0
id = 7336
ignorehitpause = 1
;persistent =

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 0;var(1)=0
id = 7337
ignorehitpause = 1
;persistent =







[State -2, Explod]            ;底板  Left
type = Explod
trigger1 = var(1)>0
;trigger1 = var(59)=0
;trigger1 = fvar(22) <= 1
trigger1 = NumExplod(7337) = 0
trigger1 = TeamSide = 1
anim = 7337
ID = 7337
pos = 50+ var(52) ,28  + var(51)
postype = Left
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -55
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.3
ignorehitpause = 1



[State -2, Explod]            ;底板  right
type = Explod
trigger1 = var(1)>0
;trigger1 = var(59)=0
;trigger1 = fvar(22) <= 1
trigger1 = NumExplod(7337) = 0
trigger1 = TeamSide != 1
anim = 7337
ID = 7337
pos = -50 - var(52) ,28  + var(51)
postype = right
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -55
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.3
ignorehitpause = 1



[State -2, Explod]            ;底板绿灯  Left
type = Explod
trigger1 = var(1)>0
;trigger1 = var(59)=0
;trigger1 = fvar(22) <= 1
trigger1 = Numhelper(2350)=0 && Numhelper(2150)=0
trigger1 = NumExplod(7237) = 0
trigger1 = TeamSide = 1
anim = 7237    ;400;
ID = 7237
pos = 50 + var(52) ,28  + var(51)
postype = Left
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -54
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.3
ignorehitpause = 1


[State -2, Explod]            ;底板绿灯     right
type = Explod
trigger1 = var(1)>0
;trigger1 = var(59)=0
;trigger1 = fvar(22) <= 1
trigger1 = Numhelper(2350)=0 && Numhelper(2150)=0
trigger1 = NumExplod(7237) = 0
trigger1 = TeamSide != 1
anim = 7237    ;400;
ID = 7237
pos = -50 - var(52) ,28  + var(51)
postype =  right
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -54
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.3
ignorehitpause = 1


[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
trigger1 = Numhelper(2350)>0 || Numhelper(2150)>0
id = 7237
ignorehitpause = 1
;persistent =



[State -2, Explod]            ;底板绿灯  790    Left
type = Explod
trigger1 = var(1)>0
;trigger1 = var(59)=0
;trigger1 = fvar(22) <= 1
trigger1 = helper(32000),var(19)=0   ;cooldown
trigger1 = NumExplod(7790) = 0
trigger1 = TeamSide = 1
anim = 7790    ;400;
ID = 7790
pos = 50 + var(52) ,28  + var(51)
postype = Left
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -54
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.3
ignorehitpause = 1


[State -2, Explod]            ;底板绿灯  790   right
type = Explod
trigger1 = var(1)>0
;trigger1 = var(59)=0
;trigger1 = fvar(22) <= 1
trigger1 = helper(32000),var(19)=0   ;cooldown
trigger1 = NumExplod(7790) = 0
trigger1 = TeamSide != 1
anim = 7790    ;400;
ID = 7790
pos = -50 - var(52) ,28  + var(51)
postype = right
bindtime = -1
removetime = -1;24
ownpal = 1;1
ontop = 0
sprpriority = -54
;facing = ifelse(TeamSide = 1,1,-1)
pausemovetime = 999999999
supermovetime = 999999999
scale = 0.3,0.3
ignorehitpause = 1



[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
trigger1 = helper(32000),var(19) > 0
id = 7790
ignorehitpause = 1
;persistent =



;===============;===============;===============
;===============【正在出招判断】===========
;===============;===============;===============


[State -2, 4];                var(49)为所有攻击属性
type = varset
trigger1 = EnemyNear,time = 1
trigger2 = EnemyNear,stateno < 200
;trigger3 = EnemyNear(var(55)),Movetype = H
;trigger1 = EnemyNear(var(55)),Movetype != A
v = 49
value = 0
IgnoreHitPause = 1


[State -2, 4];         正在出招了就是+1
type = varadd
;trigger1 = EnemyNear(var(55)),Movetype = A
trigger1 = EnemyNear,HitDefAttr = SCA, NA
trigger2 = EnemyNear,HitDefAttr = SCA, SA
trigger3 = EnemyNear,HitDefAttr = SCA, HA
trigger4 = EnemyNear,HitDefAttr = SCA, NP
trigger5 = EnemyNear,HitDefAttr = SCA, SP
trigger6 = EnemyNear,HitDefAttr = SCA, HP
trigger7 = EnemyNear,HitDefAttr = SCA, NT
trigger8 = EnemyNear,HitDefAttr = SCA, ST
trigger9 = EnemyNear,HitDefAttr = SCA, HT
v = 49
value = 1
IgnoreHitPause = 1

;------------------------------------------------
[State -2, 4];               归0          var(48)为投技攻击属性
type = varset
trigger1 = EnemyNear,time = 0
v = 48
value = 0
IgnoreHitPause = 1


[State -2, 4];            累加
type = varadd
;triggerall = EnemyNear,time = [0,15]
triggerall = EnemyNear,Movetype != H ; &&   !Enemy,NumProj
trigger1 = EnemyNear,HitDefAttr = S, NT
trigger2 = EnemyNear,HitDefAttr = S, ST
trigger3 = EnemyNear,HitDefAttr = S, HT
;trigger4 = Enemy,HitDefAttr = SAC, AA,AP,AT
v = 48
value = 1
IgnoreHitPause = 1

[State -2, 4];     ;               归0
type = varset
;triggerall = random < -1
;triggerall = gametime % 2 = 0
triggerall = EnemyNear,Movetype != H ;&&   !Enemy,NumProj
trigger1 = !(EnemyNear,HitDefAttr = SCA, NT)
trigger1 = !(EnemyNear,HitDefAttr = SCA, ST)
trigger1 = !(EnemyNear,HitDefAttr = SCA, HT)
v = 48
value = 0
IgnoreHitPause = 1

;[State -2, 4];                proj
;type = varset

;trigger1 = Enemy,NumProj
;v = 48
;value = 1
;IgnoreHitPause = 1



;----------------------------------------------------------------------
;----------------------------------  var(51)= 对方高度--------------------------------
[State -2, 4];     ;
type = varset
trigger1 = 1
v = 51
value = ceil(enemynear, pos Y)
IgnoreHitPause = 1




;----------------------------------------------------------------------
;---------------------------------  声音重复判定     累加---------------------------
[State -2, 4];
type = varadd
trigger1 = var(31)>0
v = 31
value = -1
IgnoreHitPause = 1

;----------------------------------------------------------------------
;---------------------------------自身状态号记录--------------------var 39------------
[State 0, VarAdd]
type = Varset
triggerall = 1     ;------------------------【开关】 on/off ------------------------
triggerALL = Roundstate = 2  && alive && (!ishelper)
triggerALL = EnemyNear(var(55)),stateno >= 200
triggerALL = EnemyNear(var(55)),stateno != [5000,5300]
trigger1 = movetype != H
trigger2 = 1
trigger2 = stateno=[120,159]
trigger2 = EnemyNear(var(55)),stateno >= 200
trigger2 = EnemyNear(var(55)),time <=1
var(39) = stateno
;ignorehitpause = 1
;persistent =


;----------------------------------------------------------------------
;---------------------------------对方状态号记录--------------------var 38------------
[State 0, VarAdd]
type = Varset
triggerall = 1     ;------------------------【开关】 on/off ------------------------
triggerALL = Roundstate = 2  && alive && (!ishelper)
triggerALL = EnemyNear(var(55)),stateno >= 200
triggerALL = EnemyNear(var(55)),stateno != [5000,5300]
trigger1 = movetype != H
trigger2 = 1
trigger2 = stateno=[120,159]
trigger2 = EnemyNear(var(55)),stateno >= 200
trigger2 = EnemyNear(var(55)),time <=1
var(38) = EnemyNear(var(55)),stateno
;ignorehitpause = 1
;persistent =

;----------------------------------------------------------------------
;----------------------------------被挡身记录--------------------------------           jilu

 [State 0, VarAdd]                                           ;【测试用】
type = Varadd
triggerall = 0                ;------------------------【开关】 on/off ------------------------
trigger1 = palno = 3 || palno = 9                     ;将此P数 作为已经被当身2次
trigger1 = var(20) < 3
v =   20
value = 1
ignorehitpause = 1
;persistent =


[State 0, VarAdd]
type = VarAdd
triggerall = 1
triggerall = helper(32000),var(3)> 55
triggerall = var(20) = 1;[0,1]      ;var(20)的范围是 0-2
triggerall = helper(32000),var(2)>0
triggerall = movereversed
triggerall = var(53) := 60 || 1

trigger1 = prevstateno = 200  || prevstateno = 210 || prevstateno = 220   || prevstateno = 400 || prevstateno = 410
trigger2 = prevstateno = 600 || prevstateno = 610|| prevstateno = 1610|| prevstateno = 620|| prevstateno =1230
trigger3 = stateno = 200  || stateno = 210   || stateno = 220 || stateno = 400 || stateno = 410
trigger4 =  stateno = 600 || stateno = 610 || stateno = 1610|| stateno = 620  || stateno = 1230

v = 20
value = 1
ignorehitpause = 1
persistent = 0


[State 0, VarAdd]
type = VarAdd
triggerall = 1
triggerall = helper(32000),var(3)=0
triggerall = var(20) = 0;[0,1]      ;var(20)的范围是 0-2
triggerall = helper(32000),var(2)>0
triggerall = movereversed
triggerall = var(53) := 60 || 1

trigger1 = prevstateno = 200  || prevstateno = 210 || prevstateno = 220   || prevstateno = 400 || prevstateno = 410
trigger2 = prevstateno = 600 || prevstateno = 610|| prevstateno = 1610|| prevstateno = 620|| prevstateno =1230
trigger3 = stateno = 200  || stateno = 210   || stateno = 220 || stateno = 400 || stateno = 410
trigger4 =  stateno = 600 || stateno = 610 || stateno = 1610|| stateno = 620  || stateno = 1230

v = 20
value = 1
ignorehitpause = 1
persistent = 0





[State 0, VarAdd]
type = VarSet
triggerall = 1
;triggerall = helper(32000),var(3)=0
triggerall = var(20) !=3   ;= 0;[0,1]      ;var(20)的范围是 0-2
triggerall = helper(32000),var(2)>0
triggerall = movereversed
triggerall = var(53) := 60 || 1

trigger1 = prevstateno = 800
trigger2 = stateno = 800

trigger3 = prevstateno = 1800
trigger4 = stateno = 1800

v = 20
value = 3
ignorehitpause = 1
persistent = 0



;-----  var(53) = 被当身之后 高P数 立刻脱离-------------------
;----------------------------------------------


[State -3, ]
type = Varadd
triggerall = 1
trigger1 = var(53)>0            ;--------注意要改 3个地方
trigger1 = roundstate = 2
var(53) = -1
ignorehitpause = 1
;-----------------------------------------------




;===============;===============;===============
;===============【解除 卡住防御】===========
;===============;===============;===============
 ;
[State -3, Crouching Light Punch]
type = Selfstate
value = 5110
triggerall = !Alive
;triggerall = var(59) >= 1
;triggerall = Roundstate = 2  && alive && (!ishelper)
triggerall = statetype != A
triggerall = StateNo = [120,159]
;triggerall = var(36) = 0
;triggerall = (P2Movetype != H)
trigger1 = time >90



;===========================================================
;----【;开幕无敌，防止对方偷跑】--------
;===========================================================
[State -2]
type = Nothitby
TriggerAll = (!IsHelper)
Trigger1 = RoundState != 2
value = SCA


;===========================================================
;----【防止有些人物开场前就攻击，导致人物停留在高空】--------
;===========================================================

[State -2, 开场脱离被击在空中]
type = ChangeState
value = 5210
triggerall = statetype != A
triggerall = RoundState = 2
triggerall = ctrl || MoveType = A
trigger1 = MoveType != H   || Stateno =[120,169]
trigger1 = StateType = S  || StateType = C
trigger1 = Pos Y < -5      ;防止有些人物开场前就攻击，导致人物停留在高空


;=======================================
;------------【被击语音】-----------------
;=======================================
[State -2];
type = PlaySnd
triggerall = Roundstate = 2  && alive && (!ishelper)
triggerall = random < 66
triggerall = Time = 1
triggerall = stateno= [5000,5030]
trigger1 = GetHitVar(hitcount) = [5,10]
trigger2 = GetHitVar(hitcount) = [20,25]
trigger3 = GetHitVar(hitcount) = [35,40]
trigger4 = GetHitVar(hitcount) = [55,60]
value = s9100,0+(Random % 2)
channel = 10
voulme = 440
lowpriority = 1
IgnoreHitPause = 1


[State -2];
type = PlaySnd
triggerall = Roundstate = 2  && alive && (!ishelper)
triggerall = random < 444
triggerall = Time = 1
trigger1 = stateno= 5000
trigger2 = stateno= 5010
trigger3 = stateno= 5020
value = s5000,0+(Random % 4)
channel = 0
voulme = 440
lowpriority = 1
IgnoreHitPause = 1

[State -2];
type = PlaySnd
triggerall = Roundstate = 2  && alive && (!ishelper)
triggerall = random < 444
triggerall = Time = 1
trigger1 = stateno= 5001
trigger2 = stateno= 5011
trigger3 = stateno= 5021
value = s5000,1+(Random % 4)
channel = 0
voulme = 440
lowpriority = 1
IgnoreHitPause = 1

[State -2];
type = PlaySnd
triggerall = Roundstate = 2  && alive && (!ishelper)
triggerall = random < 444
triggerall = Time =1
trigger1 = stateno= 5002
trigger2 = stateno= 5012
trigger3 = stateno= 5022
trigger4 = stateno= 5030
value = s5000,2+(Random % 5)
channel = 0
voulme = 440
lowpriority = 1
IgnoreHitPause = 1

;==============================FATEL KO  BGM 开关  var(32)   ====================

[State -2, 4];清0    这个是FATEL KO的BGM用的
type = varset
trigger1 = Roundstate  = 1
var(32) = 0
IgnoreHitPause = 1


[State -2, 4];  -1 用来计算BGM的时间
type = varadd
trigger1 = var(32) > 0
var(32) =  -1
IgnoreHitPause = 1


[State 7777, BGM]
type     = assertspecial
trigger1 = var(32) >0
flag    = nomusic
;flag2     = timerfreeze        ; 把时间停止取消，不然2V2时，斩杀一个敌人，另一个敌人存在时，时间依然不走
supermovetime = 999999999
pausemovetime = 999999999
IgnoreHitPause = 1              ;这个是必须的，否则会在被击停顿时 ，听到背景音乐






;-----------------------------------------------------------------------------
;--------------------------------【对方弹地】---------------------------------tandi
;-----------------------------------------------------------------------------
[State 1027, ]
type = PlaySnd
Trigger1 = numexplod(2008)= 0
Trigger1 = enemynear,stateno = 3262
Trigger1 = enemynear,movetype = H
Trigger1 = enemynear,time = 1
value = s450,0
lowpriority = 1
channel = 8
;supermovetime = 9999
;pausemovetime = 9999
;ignorehitpause = 1
;persistent = 0


[State 0, Explod]
type = Explod
Trigger1 = numexplod(2008)= 0
Trigger1 = enemynear,stateno = 3262
Trigger1 = enemynear,movetype = H
Trigger1 = enemynear,time = 1
;Trigger2 = helper(1349),numexplod(1347) > 0
anim = 2008
ID =  2008
pos = -15,-15
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = 21;-2
supermovetime = 99999
pausemovetime = 99999
scale = 0.4,0.4
sprpriority = 2
ontop = 0
ownpal = 1
;shadow = 0,0,0
;removeongethit = 0
ignorehitpause = 1
;persistent = 0


;---------------------------------2000后 ----------------------------------------------------
[State 1027, ]
type = PlaySnd
Trigger1 = numexplod(2008)= 0
Trigger1 = enemynear,stateno = 3267
Trigger1 = enemynear,movetype = H
Trigger1 = enemynear,time = 1
value = s450,0
lowpriority = 1
channel = 8
;supermovetime = 9999
;pausemovetime = 9999
;ignorehitpause = 1
;persistent = 0


[State 0, Explod]
type = Explod
Trigger1 = numexplod(2008)= 0
Trigger1 = enemynear,stateno = 3267
Trigger1 = enemynear,movetype = H
Trigger1 = enemynear,time = 1
;Trigger2 = helper(1349),numexplod(1347) > 0
anim = 2008
ID =  2008
pos = -15,-15
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = 21;-2
supermovetime = 99999
pausemovetime = 99999
scale = 0.4,0.4
sprpriority = 2
ontop = 0
ownpal = 1
;shadow = 0,0,0
;removeongethit = 0
ignorehitpause = 1
;persistent = 0





;----------------------------------------------------------------------
;-------------------------------- Hitoverride覆盖（的准备工作）---------------------
;------------------------------------------------------------------------------------------     jilu
[State 0, VarAdd]                                ;【停时helper当身】,记录用变量
type = VarAdd
triggerall = 1
triggerall = movecontact || movereversed  ;招式接触
trigger1 =  fvar(17) <= 60   - 5*(palno=[4,6])  - 10*(palno=[1,3])      ;
fvar(17) = 5 + (55 - 5*(palno=[4,6]) - 10*(palno=[1,3]))*(fvar(17)= 0)
ignorehitpause =  1
;persistent =


[State 0, VarAdd]                                ;假当身, 记录用变量       ;显示的数据为 这两项相加 计算完毕后的Fvar(17)
type = VarAdd
triggerall = 1
trigger1 =  fvar(17) > 0
fvar(17) = -5 -5*(fvar(17)> 10)       ;这样算，Fvar(17)会在此动作结束前 停止在5， 如果>5说明是刚命中，立刻被暂停的话也会>5
ignorehitpause =  1                   ;由此可使 下一条 覆盖当前动作，避免被停时的假当所克制
;persistent =

;-------------------------------- Hitoverride覆盖---------------------------------------------------------
;------------------------------------------------------------------------------------------
[State 0, huanchong]    ;通过覆盖VS停时类型技能，如假当身或无相或精防 （简单有效，通过调节合理的变量控制,化解类似招式）
type = Hitoverride
triggerall = 1                                ;      on/off
triggerall =  var(59) >0  &&  RoundState = 2  && !ishelper && alive
;TriggerAll = var(57) = 0   ;  非【手加减】模式
TriggerAll = var(49) <=  ( 2   +  4*(fvar(22) >=5)   )       ;考虑对方出手时间，而并不是一直无敌
TriggerAll =  helper(33000),var(55) = 0   ||  (life < lifemax*0.65  &&  fvar(22)>= 5)   ;敌人防御时，给敌人反击的机会
triggerall = statetype != A
triggerall = life < 0.35*lifemax  || (fvar(22)>=3) &&  life < 0.55*lifemax  || (fvar(22)>=5) &&  life < 0.95*lifemax|| palno>=10
triggerall = movecontact || (  movereversed && var(20)>0 +1*(fvar(22) =1)   );招式接触
triggerall = fvar(17) >= 5  ; >5 说明 大概是 被停时的helper假当身了
triggerall = ( power > 2000 && numhelper(2350)= 0 && numhelper(2150)= 0 )   ||   helper(32000),var(37)=0

trigger1 = stateno = 200 || stateno = 210  || stateno = 220 || stateno = 400   ||  stateno = 410

;trigger2 = life < 0.65*lifemax   || (palno = [7,12])
;trigger2 = stateno =  1000

attr = SCA,AA,AP,AT
stateno = ifelse(power > 2000 && numhelper(2350)= 0 && numhelper(2150)= 0 ,2100,700)
;stateno = 1520
time = 1
ignorehitpause = 1
persistent = 1


[State 0, huanchong]    ;通过覆盖VS 攻击 不可防御         ;类似精防  01      通常可被投
type = Hitoverride
triggerall = 1             ;      on/off
triggerall =  var(59) >0  &&  RoundState = 2  && !ishelper && alive
triggerall = statetype != A
triggerall =  ((EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) < 50
triggerall = life < 0.45*lifemax  || (fvar(22)>=3) &&  life < 0.65*lifemax     || (fvar(22)>=5)
triggerall = (   inguarddist    || (helper(32000), inguarddist)    || (helper(33000), inguarddist)    )
triggerall = stateno = [120,149]

trigger1 = enemy,numproj  || Enemy,HitDefAttr = SCA,AP  ||  (var(49)= 0  && (EnemyNear(var(55)),pos x - pos x)*facing >125-5*fvar(22)  )
trigger2 = enemynear,movetype != A
trigger3 = enemynear,stateno >=200  &&  enemynear,time > 15  && var(49)= 0
trigger4 = EnemyNear(var(55)),time - var(19) > 5 && !Enemy,HitDefAttr = SCA,AT      ;相对时间差额 5
trigger5 = !inguarddist ;自身无需防御 vs某些招式
;trigger6 = 1       ;test

attr = SCA,AA,AP;,AT
stateno = 1701
time = 1
ignorehitpause = 1
persistent = 1


[State 0, huanchong]    ;通过覆盖VS 攻击 不可防御         ;类似精防  02     防止远距离投
type = Hitoverride
triggerall = 1             ;      on/off
triggerall =  var(59) >0  &&  RoundState = 2  && !ishelper && alive
triggerall = statetype != A
triggerall =  ((EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) >= 50
triggerall = life < 0.45*lifemax  || (fvar(22)>=3) &&  life < 0.65*lifemax     || (fvar(22)>=5)
triggerall = (   inguarddist    || (helper(32000), inguarddist)    || (helper(33000), inguarddist)    )
triggerall = stateno = [120,149]

trigger1 = enemy,numproj  || Enemy,HitDefAttr = SCA,AP  ||  (var(49)= 0  && (EnemyNear(var(55)),pos x - pos x)*facing >125-5*fvar(22)  )
trigger2 = enemynear,movetype != A
trigger3 = enemynear,stateno >=200    && var(49)= 0    &&   var(19) > 15  ;enemynear,time > 15    ;在我看来，他的时间是15
trigger4 = EnemyNear(var(55)),time - var(19) > 5 && !Enemy,HitDefAttr = SCA,AT  &&  fvar(22)>=5    ;相对时间差额 5
trigger5 = !inguarddist ;自身无需防御 vs某些招式

attr = SCA,AA,AP,AT
stateno = 1701
time = 1
ignorehitpause = 1
persistent = 1


[State 0, huanchong]    ;通过覆盖VS 重复1个投技        ;通过记录账号
type = Hitoverride
triggerall = 1             ;      on/off
triggerall =  var(59) >0  &&  RoundState = 2  && !ishelper && alive
triggerall = helper(32000),var(16)=0
triggerall = statetype != A
triggerall = life < 0.85*lifemax  || (fvar(22)>=3) &&  life < 0.95*lifemax     || (fvar(22)>=5)
triggerall = Ctrl ||(stateno = [10,12])||(stateno = 21)||(stateno = 100) ||(stateno = [120,159])
;triggerall =  EnemyNear(var(55)),stateno !=0

trigger1 = EnemyNear(var(55)),stateno = helper(33000),var(7)  &&  helper(33000),var(7) !=0      ;记录过的对方投技账号
trigger2 = EnemyNear(var(55)),stateno = helper(33000),var(8)  &&  helper(33000),var(8) !=0      ;记录过的对方投技账号
trigger3 = EnemyNear(var(55)),stateno = helper(33000),var(9)  &&  helper(33000),var(9) !=0      ;记录过的对方投技账号

trigger4 = (EnemyNear(var(55)),pos x - pos x)*facing  > 120
trigger4 = palno=11||(fvar(22)>= 5 && life < lifemax*0.85) || (fvar(22)>= 3 && life < lifemax*0.55)  || (fvar(22)>= 1 && life < lifemax*0.35)

attr = SCA,AT
stateno = 105
time = 1
ignorehitpause = 1
persistent = 1





;=======================================;=========================================================
;==============================【除BUG用脱离】      ===================
;=======================================;=========================================================
[State -2,脱离]                          ;除BUG用脱离，卡在投系状态，卡在高空中时， 超过2000F 时使用
Type = SelfState
Triggerall = (!IsHelper) && (Alive) ;&& (PalNo=[11,12])
Triggerall = Movetype = H
Trigger1 = var(46) < - 2000;2000

Value = 5210
Ctrl = 0

Supermovetime = 99999999
Pausemovetime = 99999999
IgnoreHitPause = 1


;=======================================;=========================================================
;==============================判断 当前动作 是否与对方【接触】       fvar(11) ===================
;=======================================;=========================================================
[State -2, 4];                                              ;散花 和 圆环
type = varset
trigger1 = movehit

trigger2 = stateno = 230              ;散花
trigger2 = ProjHit233 = 1

trigger3 = stateno = 1210           ;圆弧
trigger3 = ProjHit1213 = 1

trigger4 = stateno = 650          ;飞道
trigger4 = ProjHit8659 = 1  ||  ProjHit8669 = 1

trigger5 = stateno = 410          ;蹲砍
trigger5 = ProjHit434 = 1  ||  ProjHit434 = 1


fvar(11) = 1                        ;       接触    命中   为 1
IgnoreHitPause = 1

[State -2, 4];
type = varset
trigger1 = moveguarded

trigger2 = stateno = 230             ;散花
trigger2 = ProjGuarded233 = 1

trigger3 = stateno = 1210           ;圆弧
trigger3 = ProjGuarded1213 = 1

trigger4 = stateno = 650          ;飞道
trigger4 = ProjGuarded8659 = 1  ||  ProjGuarded8669 = 1

trigger5 = stateno = 410          ;蹲砍
trigger5 = ProjGuarded434 = 1  ||  ProjGuarded434 = 1

fvar(11) = 2                       ;       接触   被防御    为 2
IgnoreHitPause = 1



[State -2, 4];
type = varset
trigger1 = time = [0,1]
fvar(11) = 0                         ;       未接触      为 0
IgnoreHitPause = 1

;======================================= ===================
;==============【 projhitpause 】 ================
;==========================================================
;---------------------[火花]           proj 火花
;
[State 2001]
type = Explod
triggerall = numexplod(7777)=0  ;-----------------------------------防止重复出现的火花  记录
trigger1 = ProjHit653 = 1
trigger2 = ProjHit1653 = 1
trigger3 = ProjHit8659 = 1
trigger4 = ProjHit8669 = 1
anim = 7777         ;
pos = -20+(random%10),-50-(random%20)
scale = 0.5,0.5
postype = P2
ownpal = 1
id = 7777               ;
bindtime = 1
sprpriority = 5
;ontop = 1
;facing = ifelse(vel X < 0,-1,1)
;removeongethit = 1
pausemovetime = 99999
supermovetime = 99999
IgnoreHitPause = 1
;persistent = 0




[State -2, Pause]           ; 410
type = Pause
trigger1 =  ProjHit434 = 1
;trigger2 =  ProjGuarded233 = 1
time = 4
;movetime = 1
ignorehitpause = 1
;persistent =



[State -2, Pause]           ; 230
type = Pause
trigger1 =  ProjHit233 = 1
trigger2 =  ProjGuarded233 = 1
time = 4
;movetime = 1
ignorehitpause = 1
;persistent =


[State -2, Pause]            ; 650     ;增加打击感
type = Pause
;triggerall = var(57) = 0  ;【非手加减】
trigger1 =  ProjHit8659 = 1
trigger2 =  ProjGuarded8659 = 1
trigger3 =  ProjHit8669 = 1
trigger4 =  ProjGuarded8669 = 1
time =     1+1*(enemynear,statetype != A)         ;   ceil(0.5*fvar(22) )
movetime = 1+1*(enemynear,statetype != A)         ;   ceil(0.5*fvar(22) )
ignorehitpause = 1
;persistent =



 [State 0, VelSet]        ;反作用力
type = VelAdd
trigger1 =  ProjHit233 = 1
trigger2 =  ProjGuarded233 = 1
x = -1 -1*(enemynear,backedgedist < 5)
;ignorehitpause =
;persistent =



[State -2, Pause]           ; 1210
type = Pause
trigger1 =  ProjHit1213 = 1
trigger2 =  ProjGuarded1213 = 1
time = 2
;movetime = 1
ignorehitpause = 1
;persistent =


 [State 0, VelSet]        ;反作用力
type = VelAdd
trigger1 =  ProjHit1213 = 1
trigger2 =  ProjGuarded1213 = 1
x = -1  -2*(enemynear,backedgedist < 5)  -2*(enemynear,statetype != A)
;ignorehitpause =
;persistent =



[State -2, Pause]           ; 2100        落地
type = Pause
trigger1 =  ProjHit2152 = 1
trigger2 =  ProjGuarded2152 = 1
time = 4
;movetime = 1
ignorehitpause = 1
;persistent =

[State -2, Pause]           ; 2100        乱砍
type = Pause
trigger1 =  ProjHit2153 = 1
trigger2 =  ProjGuarded2153 = 1
trigger3 =  ProjHit2154 = 1
trigger4 =  ProjGuarded2154 = 1
trigger5 =  ProjHit2154 = 1
trigger6 =  ProjGuarded2154 = 1
time = 2
;movetime = 1
ignorehitpause = 1
;persistent =


[State -2, Pause]           ; 2300        砍
type = Pause
trigger1 =  ProjHit2353 = 1
trigger2 =  ProjGuarded2353 = 1
trigger3 =  ProjHit2354 = 1
trigger4 =  ProjGuarded2354 = 1
time = 4
movetime = 4
ignorehitpause = 1
;persistent =


[State -2, Pause]           ; 2600        上砍    下砍
type = Pause
triggerall = 1
trigger1 =  ProjHit2653 = 1
trigger2 =  ProjGuarded2653 = 1
trigger3 =  ProjHit2654 = 1
trigger4 =  ProjGuarded2654 = 1
time = 4
movetime = 4
ignorehitpause = 1
;persistent =


 ;===============;===============;===============
;===============【对方时间记录 排除停时】===========
;===============;===============;===============

 [State -2, 4];                 ,var(19)为对方动作的相对time
type = varadd
triggerall = movetype != H      ;+1 或 +2 可以看出对方第几F击中自己
trigger1 = var(19) < 500
var(19) = 1
IgnoreHitPause = 1


 [State -2, 4];
type = varset
;trigger1 = EnemyNear,animelemtime(1)=0
triggerall = movetype != H
trigger1 = EnemyNear(var(55)),time <= 0 +1 ; 写 0或1 从案板上来看是一样的结果 ，虽然有1F误差 但是勉强接受
trigger1 = EnemyNear(var(55)),stateno >= 200

trigger2 = EnemyNear(var(55)),stateno < 200

trigger3 = fvar(19)>0 ;对方挨打
var(19) = 0 ; -1
IgnoreHitPause = 1



 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;====================================== ;7-12P 幻影拖尾=====================   huanying
[State 2000, c]                      ;7-12P 幻影拖尾
type = AfterImage
trigger1 = RoundState = 2
;trigger1 = animelem = 1
trigger1 = time = 1
trigger1 = stateno = 50 || stateno = 100 || stateno = 110  || stateno = 115
trigger1 = palno >= 7
time = 60
trans = add
;framegap = 5
length = 12
palbright = 12,12,12
palcontrast = 50,50,50
palpostbright = 0,0,0
paladd = 40,10,60
palmul = 0.9,0.9,0.9
ignorehitpause = 1


 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;====================================== ;取消对方染色   防止BUG   =====================
[State 5210, 1] ;Blink white
type = PalFX
trigger1 = RoundState = 2
trigger1 = movetype = A
trigger1 = Time = 1

trigger2 = RoundState != 2
time = 1
add = 0,0,0 ;256,256,256



;=======================================
;------------【cooldown】-----------------                     jilu
;=======================================
[State -3, mFwp[]
Type = Helper
;triggerall = var(59) >0
trigger1 =!NumHelper(32000)
trigger1 =!ishelper
HelperType = Normal
Name = "cooldown_timer01"          ;前
StateNo = 32000
ID = 32000
Pos = 5,0
KeyCtrl = 0
persistent = 0
pausemovetime=2147483647
supermovetime=2147483647


[State -3, mFwp[]
Type = Helper
;triggerall = var(59) >0
trigger1 =!NumHelper(33000)
trigger1 =!ishelper
HelperType = Normal
Name = "cooldown_timer02"         ;  后
StateNo = 33000
ID = 33000
Pos = 5,0
KeyCtrl = 0
persistent = 0
pausemovetime=2147483647
supermovetime=2147483647


[State -3, mFwp[]           ;中
Type = Helper
;triggerall = var(59) >0
trigger1 =!NumHelper(34000)
trigger1 =!ishelper
HelperType = Normal
Name = "cooldown_timer03"
StateNo = 34000
ID = 34000
Pos = 0,-999
KeyCtrl = 0
persistent = 0
pausemovetime=2147483647
supermovetime=2147483647


[State -3, mFwp[]
Type = Helper
;triggerall = var(59) >0
trigger1 =!NumHelper(35000)
trigger1 =!ishelper
HelperType = Normal
Name = "cooldown_timer04"         ;  重合 杂货铺
StateNo = 35000
ID = 35000
Pos = -2,0
KeyCtrl = 0
persistent = 0
pausemovetime=2147483647
supermovetime=2147483647


;====================================================
;------------【飞行道具 的 状态拉入】----------------
;====================================================

[State -2]
type = targetState
triggerall = 1                           ;----------------------  [on / OFF] ???     琴里炮弹
;triggerall = root,NumTarget
triggerall = NumTarget
triggerall = movetype != H     || (stateno = [150,159])
trigger1 = ProjHit22656 = 1  ,<5
trigger1 = NumTarget(22656)

ID = 22656
value = 3221
ctrl = 0
;IgnoreHitPause = 1
;Persistent     = 0


[State -2]
type = targetState
triggerall = 1                           ;----------------------  [on / OFF] ???     琴里上挑
;triggerall = root,NumTarget
triggerall = NumTarget
triggerall = movetype != H     || (stateno = [150,159])
trigger1 = ProjHit2653 = 1  ,<5
trigger1 = NumTarget(2653)

ID = 2653
value = 3221
ctrl = 0
;IgnoreHitPause = 1
;Persistent     = 0



[State -2]
type = targetState
triggerall = 1                           ;----------------------  [on / OFF] ???     琴里下砍
;triggerall = root,NumTarget
triggerall = NumTarget
triggerall = movetype != H    || (stateno = [150,159])
trigger1 = ProjHit2654 = 1  ,<5
trigger1 = NumTarget(2654)

ID = 2654
value = 3261
ctrl = 0
;IgnoreHitPause = 1
;Persistent     = 0


;====================================================
;----------------------【End】-----------------------
;====================================================


;----------------------      检测 背向攻击         本身
[State -2]
type = Explod
trigger1 = 0
trigger1 = inguarddist
trigger1 = numExplod(32001) < 1
anim = 9998      ;
id = 32001
pos = 0,-150
scale = 0.25,0.25
postype = P1
ownpal = 1
bindtime = -1
removetime = 20
sprpriority = 5
;ontop = 1
;removeongethit = 1
supermovetime = 9999
pausemovetime = 9999
IgnoreHitPause = 1
;persistent = 0


;----------------------      检测 背向攻击            前
[State -2]
type = Explod
trigger1 = 0
trigger1 = helper(32000), inguarddist
trigger1 = numExplod(32002) < 1
anim =9998      ;
id = 32002
pos = 25,-150
scale = 0.25,0.25
postype = P1
ownpal = 1
bindtime = -1
removetime = 20
sprpriority = 5
;ontop = 1
;removeongethit = 1
supermovetime = 9999
pausemovetime = 9999
IgnoreHitPause = 1
;persistent = 0


;----------------------      检测 背向攻击         后
[State -2]
type = Explod
trigger1 = 0
trigger1 = helper(33000), inguarddist
trigger1 = numExplod(32003) < 1
anim = 9998      ;
id = 32003
pos = -25,-150
scale = 0.25,0.25
postype = P1
ownpal = 1
bindtime = -1
removetime = 20
sprpriority = 5
;ontop = 1
;removeongethit = 1
supermovetime = 9999
pausemovetime = 9999
IgnoreHitPause = 1
;persistent = 0


;----------------------      检测 背向攻击         前
[State -2]
type = Explod
trigger1 = 0
trigger1 = helper(34000), inguarddist
trigger1 = numExplod(32004) < 1
anim = 9998     ;
id = 32004
pos = -25,-150
scale = 0.25,0.25
postype = P1
ownpal = 1
bindtime = -1
removetime = 20
sprpriority = 5
;ontop = 1
;removeongethit = 1
supermovetime = 9999
pausemovetime = 9999
IgnoreHitPause = 1
;persistent = 0


;----------------------      检测   其他项目        以图片显示
[State -2]
type = Explod
triggerall = 0
trigger1 = enemy(1),life/ enemy(1),lifemax > 0.95
trigger1 = numExplod(32999) < 1
;trigger1 = helper(32000),var(13) >0
anim = 400      ;
id = 32999
pos = 0,25
scale = 0.25,0.25
postype = P1
ownpal = 1
bindtime = -1
removetime = 20
sprpriority = 5
;ontop = 1
;removeongethit = 1
supermovetime = 9999
pausemovetime = 9999
IgnoreHitPause = 1
;persistent = 0






;==========================================================================
;------------------以下是 【擦弹】系统移植------------------         cadan
;==========================================================================
;[State -2, LifeAdd]
;type = LifeAdd
;---------------------------------------------------------------------------
;                                 var(43)  是一个有关【【擦弹】时间的变量
;
;---------------------------------------------------------------------------


[State -2]                ;每个状态号 起始时  令var(43)归零
type = Varset
triggerall = var(43) > 0
;trigger1 = StateNo != [380,393]
;trigger1 = StateNo != 110 &&  StateNo != 111  && StateNo != 115 &&  StateNo != 116  &&  StateNo != 50 &&  StateNo != 120 ;&&    StateNo != 620  && (StateNo != [120,159])
trigger1 = time = [0,1]

trigger2 = Movetype = H      ;-------------------被击时 归零霸体有关变量--------------

trigger3 = (stateno != [700,711]) &&  stateno != 2300  &&  stateno != 2600   &&  stateno != 790   ;每个状态号记录

var(43) = 0
IgnoreHitPause = 1
persistent = 1



;====================================== 与【擦弹】有关 END ==========================================
;----------------------------------------------------------------------------------------------------------------------------------------------------
;
;===================== ;此句防止用于WIN版 ================================
;[State 0, Null]                                                        ;;
;type = Null                                                            ;;
;trigger1 = AILevel                                                     ;;
;===================== ;此句防止用于WIN版 ================================

;=======================================;====================================================
;---------------------------  【变量  使用表】   --------------------------------------------
;=======================================;====================================================
;　1 =  隐藏界面
;　2 = 倮ポ`ズ涓                 【胜利动作】
;　3 =   与防御有关？                【准备取缔】
;　4 = スロ`I理       ;慢镜头 处理        【作废】
;　5 = 弱ボタン判定                  轻拳重拳 按钮 判定
;　6 = 通常攻磨堀ぅ埂⒙沂指定
;　7 = ダイア、追加入力
;　8 = Counter Attack 攻击提升补正                  【作废】
;　9 = 特殊イントロ用涫（0.ノ`マル?1.）
; 10 = 记录方向  变量              向右是1 向左是2
; 11 = 暗用涫
; 12 = KOサウンド
; 13 = 倮判定            ；MOVETYPE = H 时   为 0
; 14 = 【作废】
; 15 = 【大跳】 判定用
; 16 = 【小跳】 判定用
; 17 = 特殊帧数记录的状态号

; 19 =  相对时间
; 20 =  挡身记录
; 21 =

; 30 = 判断对方受击时间【作废】
; 31 = 声音播放判定，以免重复语音
; 32 = FATEL KO  BGM 开关  var(32)
; 33 =  var(33) 防止 死亡语音 重复
; 34 =
; 35 = 空中双跳次数限定
; 36 = 空中冲刺次数限定
; 37 =
; 38 =   记录对方状态号
; 39 =   记录自身状态号

; 40 = 霸体时间 控制
; 41 = 相杀图号记录       ;暂时没用 但还是保留
; 42 = 霸体层数 控制
; 43 = 擦弹时间 控制
; 44 =
; 45 = 连击上限指示器
; 46 = 自身被击时间统计   防御  +1   受伤 -1   ; -2000F 脱离

; 48 = 记录 有攻击判定  （投技）
; 49 = 记录 有攻击判定  （累加）


; 51 =  UI位置
; 52 =  UI位置
; 54 =
; 55 =
; 57 =【手加减】的程度，发呆和失误的概率
; 59 = AI判定

; fvar(22) = 色表影响人物强度
; fvar(17)  = 对 停时helper挡身

; helper(34000),var(56) = 本局开始时长           ;同 helper(32000),var(56)
; helper(34000),var(57) =【手加减】调节 设置数值

; helper(33000),var(55)  =  解除敌人防御时 自身免疫攻击

;
;=======================================;====================================================
;------------【告示牌】---------------------------- jilu  -----------------------------------
;=======================================;====================================================

[State -2,DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1                                                                   ;(EnemyNear(var(55)),time-var(19)) 相对时间差   ;-----  helper(33000),var(55) = 敌人 防御 时  解除缓冲
;text = "p2bodydist x = %f    v46 = %d   helper_v7 = %d   v20 = %d    v57 = %d  "       ;显示距离                                                   ;(EnemyNear(var(55)),time-var(19))
;params =(  (EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front)  ) ,var(46),(helper(33000),var(7)),var(20),var(57)

text = "h_v56 = %d  h_v7 = %d  h_v9 = %d   h_v13 = %d  fv16 = %f  "
params =(helper(32000),var(56)),(helper(33000),var(7)),(helper(33000),var(9)),(helper(32000),var(13)),fvar(16)


;-------------------------------------------------------------------------------------------------------------                                                                                                                     ; var(19)  = 相对时间              ;var(57) = 手加减程度
;text = "v19 = %d    v11 = %d  v21 = %d  v20 = %d   v46 = %d"   ;v21 = %d         ；显示综合
;params = var(19) ,  helper(33000),var(11) ,helper(33000),var(21)  ,var(20) ,var(46);   , helper(33000),var(21) , var(38)

;text = "fv11 = %f  v19 = %d  v11 = %d  v38 = %d  v20 = %d"
;params = fvar(11),var(19),  helper(33000),var(11) ,var(38) ,var(20);             ；显示综合

;text = "v11 = %d      v21 = %d   v22 = %d    v39 = %d    v38 = %d"       ;显示状态号
;params = helper(33000),var(11) , helper(33000),var(21)  ,  helper(33000),var(22) ,var(39) , var(38);

ignorehitpause = 1
pausemovetime=2147483647
supermovetime=2147483647


;----------------------------------------------
;  ((EnemyNear(var(55)),pos x - pos x)*facing - const(size.ground.front)- EnemyNear(var(55)),const(size.ground.front) ) < 0
;   (EnemyNear(var(55)),pos x - pos x)*facing  < 50
;   (EnemyNear(var(55)),pos x - pos x)*facing  = [-5,50]

